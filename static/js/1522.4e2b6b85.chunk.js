"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1522],{78084:function(e,t,r){r.d(t,{Z:function(){return c}});var a,i,n=r(15671),s=r(43144),l=r(93169),o=r(13005);(i=a||(a={}))[i.varint=0]="varint",i[i.fixed64=1]="fixed64",i[i.delimited=2]="delimited",i[i.fixed32=5]="fixed32",i[i.unknown=99]="unknown";var h=4294967296,u=new TextDecoder("utf-8"),f=(0,l.Z)("safari")||(0,l.Z)("ios")?6:(0,l.Z)("ff")?12:32,c=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t?t.byteLength:0;(0,n.Z)(this,e),this._tag=0,this._dataType=a.unknown,this._init(t,r,i,s)}return(0,s.Z)(e,[{key:"_init",value:function(e,t,r,a){this._data=e,this._dataView=t,this._pos=r,this._end=a}},{key:"clone",value:function(){return new e(this._data,this._dataView,this._pos,this._end)}},{key:"pos",value:function(){return this._pos}},{key:"move",value:function(e){this._pos=e}},{key:"nextTag",value:function(e){for(;;){if(this._pos===this._end)return!1;var t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0}},{key:"next",value:function(){if(this._pos===this._end)return!1;var e=this._decodeVarint();return this._tag=e>>3,this._dataType=7&e,!0}},{key:"empty",value:function(){return this._pos>=this._end}},{key:"tag",value:function(){return this._tag}},{key:"getInt32",value:function(){return this._decodeVarint()}},{key:"getInt64",value:function(){return this._decodeVarint()}},{key:"getUInt32",value:function(){var e=4294967295;return e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?e:(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?e:void 0))))}},{key:"getUInt64",value:function(){return this._decodeVarint()}},{key:"getSInt32",value:function(){var e=this.getUInt32();return e>>>1^-(1&e)|0}},{key:"getSInt64",value:function(){return this._decodeSVarint()}},{key:"getBool",value:function(){var e=0!==this._data[this._pos];return this._skip(1),e}},{key:"getEnum",value:function(){return this._decodeVarint()}},{key:"getFixed64",value:function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+e.getUint32(t+4,!0)*h;return this._skip(8),r}},{key:"getSFixed64",value:function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+e.getInt32(t+4,!0)*h;return this._skip(8),r}},{key:"getDouble",value:function(){var e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e}},{key:"getFixed32",value:function(){var e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e}},{key:"getSFixed32",value:function(){var e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e}},{key:"getFloat",value:function(){var e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e}},{key:"getString",value:function(){var e=this._getLength(),t=this._pos,r=this._toString(this._data,t,t+e);return this._skip(e),r}},{key:"getBytes",value:function(){var e=this._getLength(),t=this._pos,r=this._toBytes(this._data,t,t+e);return this._skip(e),r}},{key:"getLength",value:function(){return this._getLengthUnsafe()}},{key:"processMessageWithArgs",value:function(e,t,r,a){var i=this.getMessage(),n=e(i,t,r,a);return i.release(),n}},{key:"processMessage",value:function(e){var t=this.getMessage(),r=e(t);return t.release(),r}},{key:"getMessage",value:function(){var t=this._getLength(),r=e.pool.acquire();return r._init(this._data,this._dataView,this._pos,this._pos+t),this._skip(t),r}},{key:"release",value:function(){e.pool.release(this)}},{key:"dataType",value:function(){return this._dataType}},{key:"skip",value:function(){switch(this._dataType){case a.varint:this._decodeVarint();break;case a.fixed64:this._skip(8);break;case a.delimited:this._skip(this._getLength());break;case a.fixed32:this._skip(4);break;default:throw new Error("Invalid data type!")}}},{key:"skipLen",value:function(e){this._skip(e)}},{key:"_skip",value:function(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e}},{key:"_decodeVarint",value:function(){var e,t=this._data,r=this._pos,a=0;if(this._end-r>=10)do{if(a|=127&(e=t[r++]),0==(128&e))break;if(a|=(127&(e=t[r++]))<<7,0==(128&e))break;if(a|=(127&(e=t[r++]))<<14,0==(128&e))break;if(a|=(127&(e=t[r++]))<<21,0==(128&e))break;if(a+=268435456*(127&(e=t[r++])),0==(128&e))break;if(a+=34359738368*(127&(e=t[r++])),0==(128&e))break;if(a+=4398046511104*(127&(e=t[r++])),0==(128&e))break;if(a+=562949953421312*(127&(e=t[r++])),0==(128&e))break;if(a+=72057594037927940*(127&(e=t[r++])),0==(128&e))break;if(a+=0x8000000000000000*(127&(e=t[r++])),0==(128&e))break;throw new Error("Varint too long!")}while(0);else{for(var i=1;r!==this._end&&0!=(128&(e=t[r]));)++r,a+=(127&e)*i,i*=128;if(r===this._end)throw new Error("Varint overrun!");++r,a+=e*i}return this._pos=r,a}},{key:"_decodeSVarint",value:function(){var e=this._decodeVarint();return e%2?-(e+1)/2:e/2}},{key:"_getLength",value:function(){if(this._dataType!==a.delimited)throw new Error("Not a delimited data type!");return this._decodeVarint()}},{key:"_getLengthUnsafe",value:function(){return this.getUInt32()}},{key:"_toString",value:function(e,t,r){if((r=Math.min(this._end,r))-t>f){var a=e.subarray(t,r);return u.decode(a)}for(var i="",n="",s=t;s<r;++s){var l=e[s];128&l?n+="%"+l.toString(16):(i+=decodeURIComponent(n)+String.fromCharCode(l),n="")}return n.length&&(i+=decodeURIComponent(n)),i}},{key:"_toBytes",value:function(e,t,r){return r=Math.min(this._end,r),new Uint8Array(e.buffer,t,r-t)}}]),e}();c.pool=new o.Z(c,null,(function(e){e._data=null,e._dataView=null}))},71522:function(e,t,r){r.r(t),r.d(t,{default:function(){return oe}});var a=r(37762),i=r(15861),n=r(15671),s=r(43144),l=r(87757),o=r(75298),h=r(10106),u=r(42982),f=r(92026),c=r(99201);function y(e){return 746===e||747===e||!(e<4352)&&(e>=12704&&e<=12735||e>=12544&&e<=12591||e>=65072&&e<=65103&&!(e>=65097&&e<=65103)||e>=63744&&e<=64255||e>=13056&&e<=13311||e>=11904&&e<=12031||e>=12736&&e<=12783||e>=12288&&e<=12351&&!(e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||e>=13312&&e<=19903||e>=19968&&e<=40959||e>=12800&&e<=13055||e>=12592&&e<=12687||e>=43360&&e<=43391||e>=55216&&e<=55295||e>=4352&&e<=4607||e>=44032&&e<=55215||e>=12352&&e<=12447||e>=12272&&e<=12287||e>=12688&&e<=12703||e>=12032&&e<=12255||e>=12784&&e<=12799||e>=12448&&e<=12543&&12540!==e||e>=65280&&e<=65519&&!(65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||e>=65104&&e<=65135&&!(e>=65112&&e<=65118||e>=65123&&e<=65126)||e>=5120&&e<=5759||e>=6320&&e<=6399||e>=65040&&e<=65055||e>=19904&&e<=19967||e>=40960&&e<=42127||e>=42128&&e<=42191)}function d(e){return!(e<11904)&&(e>=12704&&e<=12735||e>=12544&&e<=12591||e>=65072&&e<=65103||e>=63744&&e<=64255||e>=13056&&e<=13311||e>=11904&&e<=12031||e>=12736&&e<=12783||e>=12288&&e<=12351||e>=13312&&e<=19903||e>=19968&&e<=40959||e>=12800&&e<=13055||e>=65280&&e<=65519||e>=12352&&e<=12447||e>=12272&&e<=12287||e>=12032&&e<=12255||e>=12784&&e<=12799||e>=12448&&e<=12543||e>=65040&&e<=65055||e>=42128&&e<=42191||e>=40960&&e<=42127)}function v(e){switch(e){case 10:case 32:case 38:case 40:case 41:case 43:case 45:case 47:case 173:case 183:case 8203:case 8208:case 8211:case 8231:return!0}return!1}function g(e){switch(e){case 9:case 10:case 11:case 12:case 13:case 32:return!0}return!1}var p,x=r(12233),_=24,m=function(){function e(t,r,a,i,s,l,o){(0,n.Z)(this,e),this._glyphItems=t,this._maxWidth=r,this._lineHeight=a,this._letterSpacing=i,this._hAnchor=s,this._vAnchor=l,this._justify=o}return(0,s.Z)(e,[{key:"getShaping",value:function(e,t,r){for(var i=this._letterSpacing,n=this._lineHeight,s=this._justify,l=this._maxWidth,o=[],h=0,u=0,f=e.length,c=0;c<f;c++){var p,x=e.charCodeAt(c),_=r&&y(x),m=void 0,I=(0,a.Z)(this._glyphItems);try{for(I.s();!(p=I.n()).done;){if(m=p.value[x])break}}catch(j){I.e(j)}finally{I.f()}o.push({codePoint:x,x:h,y:u,vertical:_,glyphMosaicItem:m}),m&&(h+=m.metrics.advance+i)}var k=h;l>0&&(k=h/Math.max(1,Math.ceil(h/l)));for(var w=e.indexOf("\u200b")>=0,b=[],M=0;M<f-1;M++){var T=o[M].codePoint,Z=d(T);if(v(T)||Z){var P=0;if(10===T)P-=1e4;else if(Z&&w)P+=150;else{40!==T&&65288!==T||(P+=50);var V=o[M+1].codePoint;41!==V&&65289!==V||(P+=50)}b.push(this._buildBreak(M+1,o[M].x,k,b,P,!1))}}for(var B=this._optimalBreaks(this._buildBreak(f,h,k,b,0,!0)),L=0,D=t?-n:n,E=0,A=0;A<B.length;A++){for(var R=B[A],S=E;S<R&&g(o[S].codePoint);)o[S].glyphMosaicItem=null,++S;for(var C=R-1;C>S&&g(o[C].codePoint);)o[C].glyphMosaicItem=null,--C;if(S<=C){for(var F=o[S].x,O=S;O<=C;O++)o[O].x-=F,o[O].y=u;var U=o[C].x;o[C].glyphMosaicItem&&(U+=o[C].glyphMosaicItem.metrics.advance),L=Math.max(U,L),s&&this._applyJustification(o,S,C)}E=R,u+=D}if(o.length>0){var z=B.length-1,N=(s-this._hAnchor)*L,G=(-this._vAnchor*(z+1)+.5)*n;t&&z&&(G+=z*n);var H,K=(0,a.Z)(o);try{for(K.s();!(H=K.n()).done;){var W=H.value;W.x+=N,W.y+=G}}catch(j){K.e(j)}finally{K.f()}}return o.filter((function(e){return e.glyphMosaicItem}))}},{key:"_breakScore",value:function(e,t,r,a){var i=(e-t)*(e-t);return a?e<t?i/2:2*i:i+Math.abs(r)*r}},{key:"_buildBreak",value:function(e,t,r,i,n,s){var l,o=null,h=this._breakScore(t,r,n,s),u=(0,a.Z)(i);try{for(u.s();!(l=u.n()).done;){var f=l.value,c=t-f.x,y=this._breakScore(c,r,n,s)+f.score;y<=h&&(o=f,h=y)}}catch(d){u.e(d)}finally{u.f()}return{index:e,x:t,score:h,previousBreak:o}}},{key:"_optimalBreaks",value:function(e){return e?this._optimalBreaks(e.previousBreak).concat(e.index):[]}},{key:"_applyJustification",value:function(e,t,r){for(var a=e[r],i=a.vertical?_:a.glyphMosaicItem?a.glyphMosaicItem.metrics.advance:0,n=(a.x+i)*this._justify,s=t;s<=r;s++)e[s].x-=n}}],[{key:"getTextBox",value:function(e,t){if(!e.length)return null;var r,i=1/0,n=1/0,s=0,l=0,o=(0,a.Z)(e);try{for(o.s();!(r=o.n()).done;){var h=r.value,u=h.glyphMosaicItem.metrics.advance,f=h.x,c=h.y-17,y=f+u,d=c+t;i=Math.min(i,f),s=Math.max(s,y),n=Math.min(n,c),l=Math.max(l,d)}}catch(v){o.e(v)}finally{o.f()}return{x:i,y:n,width:s-i,height:l-n}}},{key:"getBox",value:function(e){if(!e.length)return null;var t,r=1/0,i=1/0,n=0,s=0,l=(0,a.Z)(e);try{for(l.s();!(t=l.n()).done;){var o=t.value,h=o.glyphMosaicItem.metrics,u=h.height,f=h.left,c=h.top,y=h.width,d=o.x,v=o.y-(u-Math.abs(c)),g=d+y+f,p=v+u;r=Math.min(r,d),n=Math.max(n,g),i=Math.min(i,v),s=Math.max(s,p)}}catch(x){l.e(x)}finally{l.f()}return{x:r,y:i,width:n-r,height:s-i}}},{key:"addDecoration",value:function(e,t){var r=e.length;if(0!==r){for(var a=e[0].x+e[0].glyphMosaicItem.metrics.left,i=e[0].y,n=1;n<r;n++){var s=e[n];if(s.y!==i){var l=e[n-1].x+e[n-1].glyphMosaicItem.metrics.left+e[n-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:a,y:i+t-3,vertical:!1,glyphMosaicItem:{sdf:!0,rect:new x.Z(4,0,4,8),metrics:{width:l-a,height:8,left:0,top:0,advance:0},page:0,code:0}}),i=s.y,a=s.x+s.glyphMosaicItem.metrics.left}}var o=e[r-1].x+e[r-1].glyphMosaicItem.metrics.left+e[r-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:a,y:i+t-3,vertical:!1,glyphMosaicItem:{sdf:!0,rect:new x.Z(4,0,4,8),metrics:{width:o-a,height:8,left:0,top:0,advance:0},page:0,code:0}})}}}]),e}(),I=r(21391),k=r(60652),w=.5,b=(0,s.Z)((function e(t,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:w;(0,n.Z)(this,e),this.x=t,this.y=r,this.angle=a,this.segment=i,this.minzoom=s})),M=(0,s.Z)((function e(t,r,a,i,s){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:w,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:c.B1;(0,n.Z)(this,e),this.anchor=t,this.labelAngle=r,this.glyphAngle=a,this.page=i,this.alternateVerticalGlyph=s,this.minzoom=l,this.maxzoom=o})),T=(0,s.Z)((function e(t,r,a,i,s,l,o,h,u,f,c,y){(0,n.Z)(this,e),this.tl=t,this.tr=r,this.bl=a,this.br=i,this.mosaicRect=s,this.labelAngle=l,this.minAngle=o,this.maxAngle=h,this.anchor=u,this.minzoom=f,this.maxzoom=c,this.page=y})),Z=(0,s.Z)((function e(t){(0,n.Z)(this,e),this.shapes=t})),P=function(){function e(){(0,n.Z)(this,e)}return(0,s.Z)(e,[{key:"getIconPlacement",value:function(e,t,r){var a=new k.E(e.x,e.y),i=r.rotationAlignment===I.aF.MAP,n=r.keepUpright,s=r.rotate*c.DT;i&&(s+=e.angle);var l=new Z([]);return r.allowOverlap&&r.ignorePlacement||(l.iconColliders=[]),this._addIconPlacement(l,a,t,r,s),i&&n&&this._addIconPlacement(l,a,t,r,s+c.JJ),l}},{key:"_addIconPlacement",value:function(e,t,r,a,i){var n=r.pixelRatio,s=r.width/n,l=r.height/n,o=a.offset,h=o[0],u=o[1];switch(a.anchor){case I.nR.CENTER:h-=s/2,u-=l/2;break;case I.nR.LEFT:u-=l/2;break;case I.nR.RIGHT:h-=s,u-=l/2;break;case I.nR.TOP:h-=s/2;break;case I.nR.BOTTOM:h-=s/2,u-=l;break;case I.nR.TOP_LEFT:break;case I.nR.BOTTOM_LEFT:u-=l;break;case I.nR.TOP_RIGHT:h-=s;break;case I.nR.BOTTOM_RIGHT:h-=s,u-=l}var f=r.rect,y=2/n,d=h-y,v=u-y,g=d+f.width/n,p=v+f.height/n,x=new k.E(d,v),_=new k.E(g,p),m=new k.E(d,p),b=new k.E(g,v);if(0!==i){var M=Math.cos(i),Z=Math.sin(i);x.rotate(M,Z),_.rotate(M,Z),m.rotate(M,Z),b.rotate(M,Z)}var P=new T(x,b,m,_,f,i,0,256,t,w,c.B1,0);if(e.shapes.push(P),!a.allowOverlap||!a.ignorePlacement){var V=a.size,B=a.padding,L={xTile:t.x,yTile:t.y,dxPixels:h*V-B,dyPixels:u*V-B,hard:!a.optional,partIndex:0,width:s*V+2*B,height:l*V+2*B,angle:i,minLod:w,maxLod:c.B1};e.iconColliders.push(L)}}},{key:"getTextPlacement",value:function(e,t,r,i){var n,s=new k.E(e.x,e.y),l=i.rotate*c.DT,o=i.rotationAlignment===I.aF.MAP,h=i.keepUpright,u=i.padding,f=w,y=o?e.angle:0,d=e.segment>=0&&o,v=i.allowOverlap&&i.ignorePlacement?null:[],g=[],p=!d,x=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,P=x,V=b,B=(d||o)&&h,L=i.size/_,D=!1,E=(0,a.Z)(t);try{for(E.s();!(n=E.n()).done;){if(n.value.vertical){D=!0;break}}}catch(Re){E.e(Re)}finally{E.f()}var A,R=0,S=0;if(!d&&D){var C=m.getTextBox(t,i.lineHeight*_);switch(i.anchor){case I.nR.LEFT:R=C.height/2,S=-C.width/2;break;case I.nR.RIGHT:R=-C.height/2,S=C.width/2;break;case I.nR.TOP:R=C.height/2,S=C.width/2;break;case I.nR.BOTTOM:R=-C.height/2,S=-C.width/2;break;case I.nR.TOP_LEFT:R=C.height;break;case I.nR.BOTTOM_LEFT:S=-C.width;break;case I.nR.TOP_RIGHT:S=C.width;break;case I.nR.BOTTOM_RIGHT:R=-C.height}}R+=i.offset[0]*_,S+=i.offset[1]*_;var F,O=(0,a.Z)(t);try{for(O.s();!(F=O.n()).done;){var U=F.value,z=U.glyphMosaicItem;if(z&&!z.rect.isEmpty){var N=z.rect,G=z.metrics,H=z.page;if(v&&p){if(void 0!==A&&A!==U.y){var K=void 0,W=void 0,j=void 0,q=void 0;D?(K=-V+R,W=x+S,j=V-P,q=b-x):(K=x+R,W=P+S,j=b-x,q=V-P);var Y={xTile:e.x,yTile:e.y,dxPixels:K*L-u,dyPixels:W*L-u,hard:!i.optional,partIndex:1,width:j*L+2*u,height:q*L+2*u,angle:l,minLod:w,maxLod:c.B1};v.push(Y),x=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,P=x,V=b}A=U.y}var J=[];if(d){var X=.5*z.metrics.width,Q=(U.x+G.left-4+X)*L*8;if(f=this._placeGlyph(e,f,Q,r,e.segment,1,U.vertical,H,J),h&&(f=this._placeGlyph(e,f,Q,r,e.segment,-1,U.vertical,H,J)),f>=2)break}else J.push(new M(s,y,y,H,!1)),o&&h&&J.push(new M(s,y+c.JJ,y+c.JJ,H,!1));var $=U.x+G.left,ee=U.y-17-G.top,te=$+G.width,re=ee+G.height,ae=void 0,ie=void 0,ne=void 0,se=void 0,le=void 0,oe=void 0,he=void 0,ue=void 0;if(!d&&D)if(U.vertical){var fe=($+te)/2-G.height/2,ce=(ee+re)/2+G.width/2;ae=new k.E(-ce-4+R,fe-4+S),ie=new k.E(ae.x+N.width,ae.y+N.height),ne=new k.E(ae.x,ie.y),se=new k.E(ie.x,ae.y)}else ae=new k.E(4-ee+R,$-4+S),ie=new k.E(ae.x-N.height,ae.y+N.width),ne=new k.E(ie.x,ae.y),se=new k.E(ae.x,ie.y);else ae=new k.E($-4+R,ee-4+S),ie=new k.E(ae.x+N.width,ae.y+N.height),ne=new k.E(ae.x,ie.y),se=new k.E(ie.x,ae.y);for(var ye=0,de=J;ye<de.length;ye++){var ve=de[ye],ge=void 0,pe=void 0,xe=void 0,_e=void 0;if(ve.alternateVerticalGlyph){if(!le){var me=(ee+re)/2+S;le=new k.E(($+te)/2+R-G.height/2-4,me+G.width/2+4),oe=new k.E(le.x+N.height,le.y-N.width),he=new k.E(oe.x,le.y),ue=new k.E(le.x,oe.y)}ge=le,pe=he,xe=ue,_e=oe}else ge=ae,pe=ne,xe=se,_e=ie;var Ie=ee,ke=re,we=ve.glyphAngle+l;if(0!==we){var be=Math.cos(we),Me=Math.sin(we);ge=ge.clone(),pe=pe.clone(),xe=xe.clone(),_e=_e.clone(),ge.rotate(be,Me),_e.rotate(be,Me),pe.rotate(be,Me),xe.rotate(be,Me)}var Te=0,Ze=256;if(d&&D?U.vertical?ve.alternateVerticalGlyph?(Te=32,Ze=96):(Te=224,Ze=32):(Te=224,Ze=96):(Te=192,Ze=64),g.push(new T(ge,xe,pe,_e,N,ve.labelAngle,Te,Ze,ve.anchor,ve.minzoom,ve.maxzoom,ve.page)),v&&(!B||this._legible(ve.labelAngle)))if(p)$<x&&(x=$),Ie<P&&(P=Ie),te>b&&(b=te),ke>V&&(V=ke);else if(ve.minzoom<2){var Pe={xTile:e.x,yTile:e.y,dxPixels:($+R)*L-u,dyPixels:(Ie+R)*L-u,hard:!i.optional,partIndex:1,width:(te-$)*L+2*u,height:(ke-Ie)*L+2*u,angle:we,minLod:ve.minzoom,maxLod:ve.maxzoom};v.push(Pe)}}}}}catch(Re){O.e(Re)}finally{O.f()}if(f>=2)return null;if(v&&p){var Ve,Be,Le,De;D?(Ve=-V+R,Be=x+S,Le=V-P,De=b-x):(Ve=x+R,Be=P+S,Le=b-x,De=V-P);var Ee={xTile:e.x,yTile:e.y,dxPixels:Ve*L-u,dyPixels:Be*L-u,hard:!i.optional,partIndex:1,width:Le*L+2*u,height:De*L+2*u,angle:l,minLod:w,maxLod:c.B1};v.push(Ee)}var Ae=new Z(g);return v&&v.length>0&&(Ae.textColliders=v),Ae}},{key:"_legible",value:function(e){var t=(0,c.Or)(e);return t<65||t>=193}},{key:"_placeGlyph",value:function(e,t,r,a,i,n,s,l,o){var h=n,u=h<0?(0,c.DQ)(e.angle+c.JJ,c._U):e.angle,f=0;r<0&&(h*=-1,r*=-1,f=c.JJ),h>0&&++i;var y=new k.E(e.x,e.y),d=a[i],v=c.B1;if(a.length<=i)return v;for(;;){var g=d.x-y.x,p=d.y-y.y,x=Math.sqrt(g*g+p*p),_=Math.max(r/x,t),m=g/x,I=p/x,w=(0,c.DQ)(Math.atan2(I,m)+f,c._U);if(o.push(new M(y,u,w,l,!1,_,v)),s&&o.push(new M(y,u,w,l,!0,_,v)),_<=t)return _;y=d.clone();do{if(i+=h,a.length<=i||i<0)return _;d=a[i]}while(y.isEqual(d));var b=d.x-y.x,T=d.y-y.y,Z=Math.sqrt(b*b+T*T);b*=x/Z,T*=x/Z,y.x-=b,y.y-=T,v=_}}}]),e}(),V=r(70885),B=r(78084),L=r(48035);!function(e){e[e.moveTo=1]="moveTo",e[e.lineTo=2]="lineTo",e[e.close=7]="close"}(p||(p={}));var D=function(){function e(t,r){(0,n.Z)(this,e),this.values={};for(var a=r.keys,i=r.values;t.next();)switch(t.tag()){case 1:this.id=t.getUInt64();break;case 2:for(var s=t.getMessage(),l=this.values;!s.empty();){var o=s.getUInt32(),h=s.getUInt32();l[a[o]]=i[h]}s.release();break;case 3:this.type=t.getUInt32();break;case 4:this._pbfGeometry=t.getMessage();break;default:t.skip()}}return(0,s.Z)(e,[{key:"getGeometry",value:function(e){if(void 0!==this._geometry)return this._geometry;if(!this._pbfGeometry)return null;var t,r,a=this._pbfGeometry;this._pbfGeometry=null,e?e.reset(this.type):t=[];for(var i,n=p.moveTo,s=0,l=0,o=0;!a.empty();){if(0===s){var h=a.getUInt32();n=7&h,s=h>>3}switch(s--,n){case p.moveTo:l+=a.getSInt32(),o+=a.getSInt32(),e?e.moveTo(l,o):(r&&t.push(r),(r=[]).push(new k.E(l,o)));break;case p.lineTo:l+=a.getSInt32(),o+=a.getSInt32(),e?e.lineTo(l,o):r.push(new k.E(l,o));break;case p.close:e?e.close():r&&!r[0].equals(l,o)&&r.push(r[0].clone());break;default:throw a.release(),new Error("Invalid path operation")}}return e?i=e.result():(r&&t.push(r),i=t),a.release(),this._geometry=i,i}}]),e}(),E=r(60136),A=r(29388),R=r(3283),S=function(e){(0,E.Z)(r,e);var t=(0,A.Z)(r);function r(){return(0,n.Z)(this,r),t.call(this,12)}return(0,s.Z)(r,[{key:"add",value:function(e,t,r){var a=this.array;a.push(e),a.push(t),a.push(r)}}]),r}(R.Z),C=(R.Z,function(){function e(t){for((0,n.Z)(this,e),this.extent=4096,this.keys=[],this.values=[],this._pbfLayer=t.clone();t.next();)switch(t.tag()){case 1:this.name=t.getString();break;case 3:this.keys.push(t.getString());break;case 4:this.values.push(t.processMessage(e._parseValue));break;case 5:this.extent=t.getUInt32();break;default:t.skip()}}return(0,s.Z)(e,[{key:"getData",value:function(){return this._pbfLayer}}],[{key:"_parseValue",value:function(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getInt64();case 5:return e.getUInt64();case 6:return e.getSInt64();case 7:return e.getBool();default:e.skip()}return null}}]),e}()),F=function(e){(0,E.Z)(r,e);var t=(0,A.Z)(r);function r(e){return(0,n.Z)(this,r),t.call(this,e)}return(0,s.Z)(r,[{key:"add",value:function(e,t,r,a,i,n,s,l,o,h,f,c){var y=this.array,d=R.Z.i1616to32(e,t);y.push(d);var v=31;d=R.Z.i8888to32(Math.round(v*r),Math.round(v*a),Math.round(v*i),Math.round(v*n)),y.push(d),d=R.Z.i8888to32(Math.round(v*s),Math.round(v*l),Math.round(v*o),Math.round(v*h)),y.push(d),d=R.Z.i1616to32(f,0),y.push(d),c&&y.push.apply(y,(0,u.Z)(c))}}]),r}(R.Z),O=function(e){(0,E.Z)(r,e);var t=(0,A.Z)(r);function r(e){return(0,n.Z)(this,r),t.call(this,e)}return(0,s.Z)(r,[{key:"add",value:function(e,t,r){var a=this.array;a.push(R.Z.i1616to32(e,t)),r&&a.push.apply(a,(0,u.Z)(r))}}]),r}(R.Z),U=function(e){(0,E.Z)(r,e);var t=(0,A.Z)(r);function r(e){return(0,n.Z)(this,r),t.call(this,e)}return(0,s.Z)(r,[{key:"add",value:function(e,t,r,a,i,n,s){var l=this.array,o=this.index,h=R.Z.i1616to32(e,t);l.push(h);return h=R.Z.i8888to32(Math.round(15*r),Math.round(15*a),i,n),l.push(h),s&&l.push.apply(l,(0,u.Z)(s)),o}}]),r}(R.Z),z=function(e){(0,E.Z)(r,e);var t=(0,A.Z)(r);function r(e){return(0,n.Z)(this,r),t.call(this,e)}return(0,s.Z)(r,[{key:"add",value:function(e,t,r,a,i,n,s,l,o,h,f,y){var d=this.array,v=R.Z.i1616to32(e,t);d.push(v),v=R.Z.i1616to32(Math.round(8*r),Math.round(8*a)),d.push(v),v=R.Z.i8888to32(i/4,n/4,l,o),d.push(v),v=R.Z.i8888to32(0,(0,c.Or)(s),10*h,Math.min(10*f,255)),d.push(v),y&&d.push.apply(d,(0,u.Z)(y))}}]),r}(R.Z),N=function(e){(0,E.Z)(r,e);var t=(0,A.Z)(r);function r(e){return(0,n.Z)(this,r),t.call(this,e)}return(0,s.Z)(r,[{key:"add",value:function(e,t,r,a,i){var n=this.array,s=R.Z.i1616to32(2*e+r,2*t+a);n.push(s),i&&n.push.apply(n,(0,u.Z)(i))}}]),r}(R.Z),G=function(){function e(t,r,a){(0,n.Z)(this,e),this.layerExtent=4096,this._features=[],this.layer=t,this.zoom=r,this._spriteInfo=a,this._filter=t.getFeatureFilter()}return(0,s.Z)(e,[{key:"pushFeature",value:function(e){this._filter&&!this._filter.filter(e,this.zoom)||this._features.push(e)}},{key:"hasFeatures",value:function(){return this._features.length>0}},{key:"getResources",value:function(e,t,r){}}]),e}(),H=function(e){(0,E.Z)(r,e);var t=(0,A.Z)(r);function r(e,a,i,s,l){var o;return(0,n.Z)(this,r),(o=t.call(this,e,a,i)).type=h.al.CIRCLE,o._circleVertexBuffer=s,o._circleIndexBuffer=l,o}return(0,s.Z)(r,[{key:"circleIndexStart",get:function(){return this._circleIndexStart}},{key:"circleIndexCount",get:function(){return this._circleIndexCount}},{key:"processFeatures",value:function(e){var t=this._circleVertexBuffer,r=this._circleIndexBuffer;this._circleIndexStart=3*r.index,this._circleIndexCount=0;var i=this.layer,n=this.zoom;e&&e.setExtent(this.layerExtent);var s,l=(0,a.Z)(this._features);try{for(l.s();!(s=l.n()).done;){var o=s.value,h=o.getGeometry(e);if(h){var u,f=i.circleMaterial.encodeAttributes(o,n,i),c=(0,a.Z)(h);try{for(c.s();!(u=c.n()).done;){var y=u.value;if(y){var d,v=(0,a.Z)(y);try{for(v.s();!(d=v.n()).done;){var g=d.value,p=t.index;t.add(g.x,g.y,0,0,f),t.add(g.x,g.y,0,1,f),t.add(g.x,g.y,1,0,f),t.add(g.x,g.y,1,1,f),r.add(p+0,p+1,p+2),r.add(p+1,p+2,p+3),this._circleIndexCount+=6}}catch(x){v.e(x)}finally{v.f()}}}}catch(x){c.e(x)}finally{c.f()}}}}catch(x){l.e(x)}finally{l.f()}}},{key:"serialize",value:function(){var e=6;e+=this.layerUIDs.length,e+=this._circleVertexBuffer.array.length,e+=this._circleIndexBuffer.array.length;var t=new Uint32Array(e),r=new Int32Array(t.buffer),a=0;t[a++]=this.type,t[a++]=this.layerUIDs.length;for(var i=0;i<this.layerUIDs.length;i++)t[a++]=this.layerUIDs[i];t[a++]=this._circleIndexStart,t[a++]=this._circleIndexCount,t[a++]=this._circleVertexBuffer.array.length;for(var n=0;n<this._circleVertexBuffer.array.length;n++)r[a++]=this._circleVertexBuffer.array[n];t[a++]=this._circleIndexBuffer.array.length;for(var s=0;s<this._circleIndexBuffer.array.length;s++)t[a++]=this._circleIndexBuffer.array[s];return t.buffer}}]),r}(G),K=r(22213),W=r(79347),j=function(e){(0,E.Z)(r,e);var t=(0,A.Z)(r);function r(e,a,i,s,l,o,u){var f;return(0,n.Z)(this,r),(f=t.call(this,e,a,i)).type=h.al.FILL,f._patternMap=new Map,f._fillVertexBuffer=s,f._fillIndexBuffer=l,f._outlineVertexBuffer=o,f._outlineIndexBuffer=u,f}return(0,s.Z)(r,[{key:"fillIndexStart",get:function(){return this._fillIndexStart}},{key:"fillIndexCount",get:function(){return this._fillIndexCount}},{key:"outlineIndexStart",get:function(){return this._outlineIndexStart}},{key:"outlineIndexCount",get:function(){return this._outlineIndexCount}},{key:"getResources",value:function(e,t,r){var i=this.layer,n=this.zoom,s=i.getPaintProperty("fill-pattern");if(s)if(s.isDataDriven){var l,o=(0,a.Z)(this._features);try{for(o.s();!(l=o.n()).done;){var h=l.value;t(s.getValue(n,h),!0)}}catch(u){o.e(u)}finally{o.f()}}else t(s.getValue(n),!0)}},{key:"processFeatures",value:function(e){this._fillIndexStart=3*this._fillIndexBuffer.index,this._fillIndexCount=0,this._outlineIndexStart=3*this._outlineIndexBuffer.index,this._outlineIndexCount=0;var t=this.layer,r=this.zoom,i=t.fillMaterial,n=t.outlineMaterial,s=t.hasDataDrivenFill,l=t.hasDataDrivenOutline;e&&e.setExtent(this.layerExtent);var o=t.getPaintProperty("fill-pattern"),h=null==o?void 0:o.isDataDriven,u=!o&&t.getPaintValue("fill-antialias",r);if(t.outlineUsesFillColor){if(u&&!t.hasDataDrivenOpacity){var f=t.getPaintValue("fill-opacity",r),c=t.getPaintValue("fill-opacity",r+1);f<1&&c<1&&(u=!1)}if(u&&!t.hasDataDrivenColor){var y=t.getPaintValue("fill-color",r),d=t.getPaintValue("fill-color",r+1);y[3]<1&&d[3]<1&&(u=!1)}}var v=this._features,g=null==e?void 0:e.validateTessellation;if(h){var p,x=[],_=(0,a.Z)(v);try{for(_.s();!(p=_.n()).done;){var m=p.value,I=o.getValue(r,m),k=this._spriteInfo[I];if(k&&k.rect){var w=i.encodeAttributes(m,r,t,k),b=u&&l?n.encodeAttributes(m,r,t):[],M=m.getGeometry(e);x.push({ddFillAttributes:w,ddOutlineAttributes:b,page:k.page,geometry:M}),x.sort((function(e,t){return e.page-t.page}));var T,Z=(0,a.Z)(x);try{for(Z.s();!(T=Z.n()).done;){var P=T.value,V=P.ddFillAttributes,B=P.ddOutlineAttributes,L=P.page,D=P.geometry;this._processFeature(D,u,t.outlineUsesFillColor,V,B,g,L)}}catch(O){Z.e(O)}finally{Z.f()}}}}catch(O){_.e(O)}finally{_.f()}}else{var E,A=(0,a.Z)(v);try{for(A.s();!(E=A.n()).done;){var R=E.value,S=s?i.encodeAttributes(R,r,t):null,C=u&&l?n.encodeAttributes(R,r,t):null,F=R.getGeometry(e);this._processFeature(F,u,t.outlineUsesFillColor,S,C,g)}}catch(O){A.e(O)}finally{A.f()}}}},{key:"serialize",value:function(){var e=10;e+=this.layerUIDs.length,e+=this._fillVertexBuffer.array.length,e+=this._fillIndexBuffer.array.length,e+=this._outlineVertexBuffer.array.length,e+=this._outlineIndexBuffer.array.length,e+=3*this._patternMap.size+1;var t=new Uint32Array(e),r=new Int32Array(t.buffer),i=0;t[i++]=this.type,t[i++]=this.layerUIDs.length;for(var n=0;n<this.layerUIDs.length;n++)t[i++]=this.layerUIDs[n];t[i++]=this._fillIndexStart,t[i++]=this._fillIndexCount,t[i++]=this._outlineIndexStart,t[i++]=this._outlineIndexCount;var s=this._patternMap,l=s.size;if(t[i++]=l,l>0){var o,h=(0,a.Z)(s);try{for(h.s();!(o=h.n()).done;){var u=(0,V.Z)(o.value,2),f=u[0],c=(0,V.Z)(u[1],2),y=c[0],d=c[1];t[i++]=f,t[i++]=y,t[i++]=d}}catch(_){h.e(_)}finally{h.f()}}t[i++]=this._fillVertexBuffer.array.length;for(var v=0;v<this._fillVertexBuffer.array.length;v++)r[i++]=this._fillVertexBuffer.array[v];t[i++]=this._fillIndexBuffer.array.length;for(var g=0;g<this._fillIndexBuffer.array.length;g++)t[i++]=this._fillIndexBuffer.array[g];t[i++]=this._outlineVertexBuffer.array.length;for(var p=0;p<this._outlineVertexBuffer.array.length;p++)r[i++]=this._outlineVertexBuffer.array[p];t[i++]=this._outlineIndexBuffer.array.length;for(var x=0;x<this._outlineIndexBuffer.array.length;x++)t[i++]=this._outlineIndexBuffer.array[x];return t.buffer}},{key:"_processFeature",value:function(e,t,a,i,n,s,l){if(e){var o=e.length,h=!n||0===n.length;if(t&&(!a||h))for(var u=0;u<o;u++)this._processOutline(e[u],n);for(var f,c=0;c<o;c++){var y=r._area(e[c]);y>32?(void 0!==f&&this._processFill(e,f,i,s,l),f=[c]):y<-32&&void 0!==f&&f.push(c)}void 0!==f&&this._processFill(e,f,i,s,l)}}},{key:"_processOutline",value:function(e,t){var r,a,i,n=this._outlineVertexBuffer,s=this._outlineIndexBuffer,l=s.index,o=new k.E(0,0),h=new k.E(0,0),u=new k.E(0,0),f=-1,c=-1,y=-1,d=-1,v=-1,g=!1,p=e.length;if(!(p<2)){for(var x=e[0],_=e[p-1];p&&_.isEqual(x);)_=e[--p-1];if(!(p-0<2)){for(var m=0;m<p;++m){0===m?(r=e[p-1],a=e[0],i=e[1],o.assignSub(a,r),o.normalize(),o.rightPerpendicular()):(r=a,a=i,i=m!==p-1?e[m+1]:e[0],o.assign(h));var I=this._isClipEdge(r,a);-1===d&&(g=I),h.assignSub(i,a),h.normalize(),h.rightPerpendicular();var w=o.x*h.y-o.y*h.x;u.assignAdd(o,h),u.normalize();var b=-u.x*-o.x+-u.y*-o.y,M=Math.abs(0!==b?1/b:1);M>8&&(M=8),w>=0?(y=n.add(a.x,a.y,o.x,o.y,0,1,t),-1===d&&(d=y),f>=0&&c>=0&&y>=0&&!I&&s.add(f,c,y),c=n.add(a.x,a.y,M*-u.x,M*-u.y,0,-1,t),-1===v&&(v=c),f>=0&&c>=0&&y>=0&&!I&&s.add(f,c,y),f=c,c=y,y=n.add(a.x,a.y,u.x,u.y,0,1,t),f>=0&&c>=0&&y>=0&&!I&&s.add(f,c,y),c=n.add(a.x,a.y,h.x,h.y,0,1,t),f>=0&&c>=0&&y>=0&&!I&&s.add(f,c,y)):(y=n.add(a.x,a.y,M*u.x,M*u.y,0,1,t),-1===d&&(d=y),f>=0&&c>=0&&y>=0&&!I&&s.add(f,c,y),c=n.add(a.x,a.y,-o.x,-o.y,0,-1,t),-1===v&&(v=c),f>=0&&c>=0&&y>=0&&!I&&s.add(f,c,y),f=c,c=y,y=n.add(a.x,a.y,-u.x,-u.y,0,-1,t),f>=0&&c>=0&&y>=0&&!I&&s.add(f,c,y),(f=n.add(a.x,a.y,-h.x,-h.y,0,-1,t))>=0&&c>=0&&y>=0&&!I&&s.add(f,c,y))}f>=0&&c>=0&&d>=0&&!g&&s.add(f,c,d),f>=0&&d>=0&&v>=0&&!g&&s.add(f,v,d),this._outlineIndexCount+=3*(s.index-l)}}}},{key:"_processFill",value:function(e,t,r,i,n){var s;t.length>1&&(s=[]);var l,o=0,h=(0,a.Z)(t);try{for(h.s();!(l=h.n()).done;){var u=l.value;0!==o&&s.push(o),o+=e[u].length}}catch(C){h.e(C)}finally{h.f()}var f,c=2*o,y=K.Z.acquire(),d=(0,a.Z)(t);try{for(d.s();!(f=d.n()).done;)for(var v=f.value,g=e[v],p=g.length,x=0;x<p;++x)y.push(g[x].x,g[x].y)}catch(C){d.e(C)}finally{d.f()}var _=(0,W.e)(y,s,2);if(W.e.deviation(y,s,2,_)>0){var m=t.map((function(t){return e[t].length})),I=(0,L.b)(y,m),k=I.buffer,w=I.vertexCount;if(w>0){for(var b=this._fillVertexBuffer.index,M=0;M<w;M++)this._fillVertexBuffer.add(k[2*M],k[2*M+1],r);for(var T=0;T<w;T+=3){var Z=b+T;this._fillIndexBuffer.add(Z,Z+1,Z+2)}if(void 0!==n){var P=this._patternMap,V=P.get(n);V?V[1]+=w:P.set(n,[this._fillIndexStart+this._fillIndexCount,w])}this._fillIndexCount+=w}}else{var B=_.length;if(B>0){for(var D=this._fillVertexBuffer.index,E=0;E<c;)this._fillVertexBuffer.add(y[E++],y[E++],r);for(var A=0;A<B;)this._fillIndexBuffer.add(D+_[A++],D+_[A++],D+_[A++]);if(void 0!==n){var R=this._patternMap,S=R.get(n);S?S[1]+=B:R.set(n,[this._fillIndexStart+this._fillIndexCount,B])}this._fillIndexCount+=B}}K.Z.release(y)}},{key:"_isClipEdge",value:function(e,t){return e.x===t.x?e.x<=-64||e.x>=4160:e.y===t.y&&(e.y<=-64||e.y>=4160)}}],[{key:"_area",value:function(e){for(var t=0,r=e.length-1,a=0;a<r;a++)t+=(e[a].x-e[a+1].x)*(e[a].y+e[a+1].y);return.5*(t+=(e[r].x-e[0].x)*(e[r].y+e[0].y))}}]),r}(G),q=r(82010),Y=function(e){(0,E.Z)(r,e);var t=(0,A.Z)(r);function r(e,a,i,s,l){var o;return(0,n.Z)(this,r),(o=t.call(this,e,a,i)).type=h.al.LINE,o._tessellationOptions={pixelCoordRatio:8,halfWidth:0,offset:0},o._patternMap=new Map,o.tessellationProperties={_lineVertexBuffer:null,_lineIndexBuffer:null,_ddValues:null},o.tessellationProperties._lineVertexBuffer=s,o.tessellationProperties._lineIndexBuffer=l,o._lineTessellator=new q.z(J(o.tessellationProperties),X(o.tessellationProperties),e.canUseThinTessellation),o}return(0,s.Z)(r,[{key:"lineIndexStart",get:function(){return this._lineIndexStart}},{key:"lineIndexCount",get:function(){return this._lineIndexCount}},{key:"getResources",value:function(e,t,r){var i=this.layer,n=this.zoom,s=i.hasDataDrivenLine,l=i.getPaintProperty("line-pattern"),o=i.getPaintProperty("line-dasharray"),h=i.getLayoutProperty("line-cap");if(l||o){var u=(null==h?void 0:h.getValue(n))||0,f=null==h?void 0:h.isDataDriven;if(s){var c=null==l?void 0:l.isDataDriven,y=null==o?void 0:o.isDataDriven;if(!c&&!y)return;var d,v=(0,a.Z)(this._features);try{for(v.s();!(d=v.n()).done;){var g=d.value;t(c?l.getValue(n,g):this._getDashArrayKey(g,n,i,o,f,h,u))}}catch(x){v.e(x)}finally{v.f()}}else if(l)t(l.getValue(n));else if(o){var p=o.getValue(n);t(i.getDashKey(p,u))}}}},{key:"processFeatures",value:function(e){var t,r,i,n,s,l;this._lineIndexStart=3*this.tessellationProperties._lineIndexBuffer.index,this._lineIndexCount=0;var o=this.layer,h=this.zoom,u=this._features,f=this._tessellationOptions,c=o.hasDataDrivenLine,y=o.lineMaterial;e&&e.setExtent(this.layerExtent);var d,v=o.getPaintProperty("line-pattern"),g=o.getPaintProperty("line-dasharray"),p=null==v?void 0:v.isDataDriven,x=null==g?void 0:g.isDataDriven,_=null!=(t=d=o.getLayoutProperty("line-cap"))&&t.isDataDriven?d:null,m=_?null:o.getLayoutValue("line-cap",h),I=m||0,k=!!_,w=null!=(r=d=o.getLayoutProperty("line-join"))&&r.isDataDriven?d:null,b=w?null:o.getLayoutValue("line-join",h),M=null!=(i=d=o.getLayoutProperty("line-miter-limit"))&&i.isDataDriven?d:null,T=M?null:o.getLayoutValue("line-miter-limit",h),Z=null!=(n=d=o.getLayoutProperty("line-round-limit"))&&n.isDataDriven?d:null,P=Z?null:o.getLayoutValue("line-round-limit",h),V=null!=(s=d=o.getPaintProperty("line-width"))&&s.isDataDriven?d:null,B=V?null:o.getPaintValue("line-width",h),L=null!=(l=d=o.getPaintProperty("line-offset"))&&l.isDataDriven?d:null,D=L?null:o.getPaintValue("line-offset",h);if(p||x){var E,A=[],R=(0,a.Z)(u);try{for(R.s();!(E=R.n()).done;){var S=E.value,C=p?v.getValue(h,S):this._getDashArrayKey(S,h,o,g,k,_,I),F=this._spriteInfo[C];if(F&&F.rect){var O=y.encodeAttributes(S,h,o,F),U=S.getGeometry(e);A.push({ddAttributes:O,page:F.page,cap:_?_.getValue(h,S):m,join:w?w.getValue(h,S):b,miterLimit:M?M.getValue(h,S):T,roundLimit:Z?Z.getValue(h,S):P,halfWidth:.5*(V?V.getValue(h,S):B),offset:L?L.getValue(h,S):D,geometry:U})}}}catch(ie){R.e(ie)}finally{R.f()}A.sort((function(e,t){return e.page-t.page})),f.textured=!0;for(var z=0,N=A;z<N.length;z++){var G=N[z],H=G.ddAttributes,K=G.page,W=G.cap,j=G.join,q=G.miterLimit,Y=G.roundLimit,J=G.halfWidth,X=G.offset,Q=G.geometry;f.capType=W,f.joinType=j,f.miterLimit=q,f.roundLimit=Y,f.halfWidth=J,f.offset=X,this._processFeature(Q,H,K)}}else{f.textured=!(!v&&!g),f.capType=m,f.joinType=b,f.miterLimit=T,f.roundLimit=P,f.halfWidth=.5*B,f.offset=D;var $,ee=(0,a.Z)(u);try{for(ee.s();!($=ee.n()).done;){var te=$.value,re=c?y.encodeAttributes(te,h,o):null;_&&(f.capType=_.getValue(h,te)),w&&(f.joinType=w.getValue(h,te)),M&&(f.miterLimit=M.getValue(h,te)),Z&&(f.roundLimit=Z.getValue(h,te)),V&&(f.halfWidth=.5*V.getValue(h,te)),L&&(f.offset=L.getValue(h,te));var ae=te.getGeometry(e);this._processFeature(ae,re)}}catch(ie){ee.e(ie)}finally{ee.f()}}}},{key:"serialize",value:function(){var e=6;e+=this.layerUIDs.length,e+=this.tessellationProperties._lineVertexBuffer.array.length,e+=this.tessellationProperties._lineIndexBuffer.array.length,e+=3*this._patternMap.size+1;var t=new Uint32Array(e),r=new Int32Array(t.buffer),i=0;t[i++]=this.type,t[i++]=this.layerUIDs.length;for(var n=0;n<this.layerUIDs.length;n++)t[i++]=this.layerUIDs[n];t[i++]=this._lineIndexStart,t[i++]=this._lineIndexCount;var s=this._patternMap,l=s.size;if(t[i++]=l,l>0){var o,h=(0,a.Z)(s);try{for(h.s();!(o=h.n()).done;){var u=(0,V.Z)(o.value,2),f=u[0],c=(0,V.Z)(u[1],2),y=c[0],d=c[1];t[i++]=f,t[i++]=y,t[i++]=d}}catch(p){h.e(p)}finally{h.f()}}t[i++]=this.tessellationProperties._lineVertexBuffer.array.length;for(var v=0;v<this.tessellationProperties._lineVertexBuffer.array.length;v++)r[i++]=this.tessellationProperties._lineVertexBuffer.array[v];t[i++]=this.tessellationProperties._lineIndexBuffer.array.length;for(var g=0;g<this.tessellationProperties._lineIndexBuffer.array.length;g++)t[i++]=this.tessellationProperties._lineIndexBuffer.array[g];return t.buffer}},{key:"_processFeature",value:function(e,t,r){if(e)for(var a=e.length,i=0;i<a;i++)this._processGeometry(e[i],t,r)}},{key:"_processGeometry",value:function(e,t,r){if(!(e.length<2)){for(var a,i,n=e[0],s=1;s<e.length;)(a=e[s].x-n.x)*a+(i=e[s].y-n.y)*i<1e-6?e.splice(s,1):(n=e[s],++s);if(!(e.length<2)){var l=this.tessellationProperties._lineIndexBuffer,o=3*l.index;this._tessellationOptions.initialDistance=0,this._tessellationOptions.wrapDistance=65535,this.tessellationProperties._ddValues=t,this._lineTessellator.tessellate(e,this._tessellationOptions);var h=3*l.index-o;if(void 0!==r){var u=this._patternMap,f=u.get(r);f?f[1]+=h:u.set(r,[o+this._lineIndexCount,h])}this._lineIndexCount+=h}}}},{key:"_getDashArrayKey",value:function(e,t,r,a,i,n,s){var l=i?n.getValue(t,e):s,o=a.getValue(t,e);return r.getDashKey(o,l)}}]),r}(G),J=function(e){return function(t,r,a,i,n,s,l,o,h,u,f){return e._lineVertexBuffer.add(t,r,l,o,a,i,n,s,h,u,f,e._ddValues),e._lineVertexBuffer.index-1}},X=function(e){return function(t,r,a){e._lineIndexBuffer.add(t,r,a)}},Q=r(8961),$=r(643),ee=r(39488);function te(e,t){return e.iconMosaicItem&&t.iconMosaicItem?e.iconMosaicItem.page===t.iconMosaicItem.page?0:e.iconMosaicItem.page-t.iconMosaicItem.page:e.iconMosaicItem&&!t.iconMosaicItem?1:!e.iconMosaicItem&&t.iconMosaicItem?-1:0}var re=function(e){(0,E.Z)(r,e);var t=(0,A.Z)(r);function r(e,a,i,s,l,o,u,f){var c;return(0,n.Z)(this,r),(c=t.call(this,e,a,f.getSpriteItems())).type=h.al.SYMBOL,c._markerMap=new Map,c._glyphMap=new Map,c._glyphBufferDataStorage=new Map,c._isIconSDF=!1,c._iconVertexBuffer=i,c._iconIndexBuffer=s,c._textVertexBuffer=l,c._textIndexBuffer=o,c._placementEngine=u,c._workerTileHandler=f,c}return(0,s.Z)(r,[{key:"markerPageMap",get:function(){return this._markerMap}},{key:"glyphsPageMap",get:function(){return this._glyphMap}},{key:"symbolInstances",get:function(){return this._symbolInstances}},{key:"getResources",value:function(e,t,i){var n=this.layer,s=this.zoom;e&&e.setExtent(this.layerExtent);var l,o,h,u,f=n.getLayoutProperty("icon-image"),c=n.getLayoutProperty("text-field"),y=n.getLayoutProperty("text-transform"),d=n.getLayoutProperty("text-font"),v=[];f&&!f.isDataDriven&&(l=f.getValue(s)),c&&!c.isDataDriven&&(o=c.getValue(s)),y&&y.isDataDriven||(h=n.getLayoutValue("text-transform",s),y=null),d&&d.isDataDriven||(u=n.getLayoutValue("text-font",s),d=null);var g,p=(0,a.Z)(this._features);try{for(p.s();!(g=p.n()).done;){var x=g.value,_=x.getGeometry(e);if(_&&0!==_.length){var m=void 0,k=void 0;f&&((m=f.isDataDriven?f.getValue(s,x):this._replaceKeys(l,x.values))&&t(m));var w=!1;if(c&&(k=c.isDataDriven?c.getValue(s,x):this._replaceKeys(o,x.values))){switch(k=k.replace(/\\n/g,"\n"),y&&(h=y.getValue(s,x)),h){case I._5.LOWERCASE:k=k.toLowerCase();break;case I._5.UPPERCASE:k=k.toUpperCase()}if(r._bidiEngine.hasBidiChar(k)){var b;b="rtl"===r._bidiEngine.checkContextual(k)?"IDNNN":"ICNNN",k=r._bidiEngine.bidiTransform(k,b,"VLYSN"),w=!0}var M=k.length;if(M>0){d&&(u=d.getValue(s,x));var T,Z=(0,a.Z)(u);try{for(Z.s();!(T=Z.n()).done;){var P=T.value,V=i[P];V||(V=i[P]=new Set);for(var B=0;B<M;B++){var L=k.charCodeAt(B);V.add(L)}}}catch(A){Z.e(A)}finally{Z.f()}}}if(m||k){var D=n.getLayoutValue("symbol-sort-key",s,x),E={feature:x,sprite:m,label:k,rtl:w,geometry:_,hash:(k?(0,$.hP)(k):0)^(m?(0,$.hP)(m):0),priority:D,textFont:u};v.push(E)}}}}catch(A){p.e(A)}finally{p.f()}this._symbolFeatures=v}},{key:"processFeatures",value:function(e){e&&e.setExtent(this.layerExtent);var t,i=this.layer,n=this.zoom,s=i.getLayoutValue("symbol-placement",n),l=s!==I.R.POINT,o=8*i.getLayoutValue("symbol-spacing",n),h=i.getLayoutProperty("icon-image"),u=i.getLayoutProperty("text-field"),f=h?new ee._L(i,n,l):null,y=u?new ee.nj(i,n,l):null,d=this._workerTileHandler;h&&(t=d.getSpriteItems()),this._iconIndexStart=3*this._iconIndexBuffer.index,this._textIndexStart=3*this._textIndexBuffer.index,this._iconIndexCount=0,this._textIndexCount=0,this._markerMap.clear(),this._glyphMap.clear();var v=[],g=1;y&&y.size&&(g=y.size/_);var p,x=y?y.maxAngle*c.DT:0,w=y?8*y.size:0,M=(0,a.Z)(this._symbolFeatures);try{for(M.s();!(p=M.n()).done;){var T=p.value,Z=void 0;f&&t&&T.sprite&&((Z=t[T.sprite])&&Z.sdf&&(this._isIconSDF=!0));var P=void 0;Z&&f.update(n,T.feature);var V=0,B=T.label;if(B){y.update(n,T.feature);var L=l?y.keepUpright:y.writingMode&&y.writingMode.indexOf(I.r1.VERTICAL)>=0,D=.5;switch(y.anchor){case I.nR.TOP_LEFT:case I.nR.LEFT:case I.nR.BOTTOM_LEFT:D=0;break;case I.nR.TOP_RIGHT:case I.nR.RIGHT:case I.nR.BOTTOM_RIGHT:D=1}var E=.5;switch(y.anchor){case I.nR.TOP_LEFT:case I.nR.TOP:case I.nR.TOP_RIGHT:E=0;break;case I.nR.BOTTOM_LEFT:case I.nR.BOTTOM:case I.nR.BOTTOM_RIGHT:E=1}var A=.5;switch(y.justify){case I.vL.AUTO:A=D;break;case I.vL.LEFT:A=0;break;case I.vL.RIGHT:A=1}var R=y.letterSpacing*_,S=l?0:y.maxWidth*_,C=y.lineHeight*_,F=T.textFont.map((function(e){return d.getGlyphItems(e)}));if((P=new m(F,S,C,R,D,E,A).getShaping(B,T.rtl,L))&&P.length>0){var O,U=1e30,z=-1e30,N=(0,a.Z)(P);try{for(N.s();!(O=N.n()).done;){var G=O.value;U=Math.min(U,G.x),z=Math.max(z,G.x)}}catch($){N.e($)}finally{N.f()}V=(z-U+48)*g*8}}var H,K=(0,a.Z)(T.geometry);try{for(K.s();!(H=K.n()).done;){var W=H.value,j=[];if(s===I.R.LINE){if(P&&P.length>0&&y&&y.size){var q=8*y.size*(2+Math.min(2,4*Math.abs(y.offset[1])));W=r._smoothVertices(W,q)}r._pushAnchors(j,W,o,V)}else s===I.R.LINE_CENTER?r._pushCenterAnchor(j,W):T.feature.type===k.V.Polygon?r._pushCentroid(j,W):j.push(new b(W[0].x,W[0].y));for(var Y=0,J=j;Y<J.length;Y++){var X=J[Y];if(!(X.x<0||X.x>4096||X.y<0||X.y>4096)&&(!(l&&V>0&&y.rotationAlignment===I.aF.MAP)||r._honorsTextMaxAngle(W,X,V,x,w))){var Q={shaping:P,line:W,iconMosaicItem:Z,anchor:X,symbolFeature:T,textColliders:[],iconColliders:[],textVertexRanges:[],iconVertexRanges:[]};v.push(Q),this._processFeature(Q,f,y)}}}}catch($){K.e($)}finally{K.f()}}}catch($){M.e($)}finally{M.f()}v.sort(te),this._addPlacedGlyphs(),this._symbolInstances=v}},{key:"serialize",value:function(){var e=11;e+=this.layerUIDs.length,e+=3*this.markerPageMap.size,e+=3*this.glyphsPageMap.size,e+=r._symbolsSerializationLength(this._symbolInstances),e+=this._iconVertexBuffer.array.length,e+=this._iconIndexBuffer.array.length,e+=this._textVertexBuffer.array.length,e+=this._textIndexBuffer.array.length;var t=new Uint32Array(e),i=new Int32Array(t.buffer),n=new Float32Array(t.buffer),s=0;t[s++]=this.type,t[s++]=this.layerUIDs.length;for(var l=0;l<this.layerUIDs.length;l++)t[s++]=this.layerUIDs[l];t[s++]=this._isIconSDF?1:0,t[s++]=this.markerPageMap.size;var o,h=(0,a.Z)(this.markerPageMap);try{for(h.s();!(o=h.n()).done;){var u=(0,V.Z)(o.value,2),f=u[0],c=(0,V.Z)(u[1],2),y=c[0],d=c[1];t[s++]=f,t[s++]=y,t[s++]=d}}catch(T){h.e(T)}finally{h.f()}t[s++]=this.glyphsPageMap.size;var v,g=(0,a.Z)(this.glyphsPageMap);try{for(g.s();!(v=g.n()).done;){var p=(0,V.Z)(v.value,2),x=p[0],_=(0,V.Z)(p[1],2),m=_[0],I=_[1];t[s++]=x,t[s++]=m,t[s++]=I}}catch(T){g.e(T)}finally{g.f()}t[s++]=this._iconVertexBuffer.index/4,t[s++]=this._textVertexBuffer.index/4,s=r.serializeSymbols(t,i,n,s,this._symbolInstances),t[s++]=this._iconVertexBuffer.array.length;for(var k=0;k<this._iconVertexBuffer.array.length;k++)i[s++]=this._iconVertexBuffer.array[k];t[s++]=this._iconIndexBuffer.array.length;for(var w=0;w<this._iconIndexBuffer.array.length;w++)t[s++]=this._iconIndexBuffer.array[w];t[s++]=this._textVertexBuffer.array.length;for(var b=0;b<this._textVertexBuffer.array.length;b++)i[s++]=this._textVertexBuffer.array[b];t[s++]=this._textIndexBuffer.array.length;for(var M=0;M<this._textIndexBuffer.array.length;M++)t[s++]=this._textIndexBuffer.array[M];return t.buffer}},{key:"_replaceKeys",value:function(e,t){return e.replace(/{([^{}]+)}/g,(function(e,r){return r in t?t[r]:""}))}},{key:"_processFeature",value:function(e,t,r){var i=e.line,n=e.iconMosaicItem,s=e.shaping,l=e.anchor,o=this.zoom,h=this.layer,u=!!n,f=!0;u&&(f=t.optional||!n);var y,d,v=s&&s.length>0,g=!0;if(v&&(g=r.optional),u&&(y=this._placementEngine.getIconPlacement(l,n,t)),(y||f)&&(v&&(d=this._placementEngine.getTextPlacement(l,s,i,r)),d||g)){if(y&&d||(g||f?g||d?f||y||(d=null):y=null:(y=null,d=null)),d){var p=h.hasDataDrivenText?h.textMaterial.encodeAttributes(e.symbolFeature.feature,o,h):null;if(this._storePlacedGlyphs(e,d.shapes,o,r.rotationAlignment,p),d.textColliders){e.textColliders=d.textColliders;var x,_=(0,a.Z)(d.textColliders);try{for(_.s();!(x=_.n()).done;){var m=x.value;m.minLod=Math.max(o+(0,c.k3)(m.minLod),0),m.maxLod=Math.min(o+(0,c.k3)(m.maxLod),25);var k=m.angle;if(k){var w=Math.cos(k),b=Math.sin(k),M=m.dxPixels*w-m.dyPixels*b,T=m.dxPixels*b+m.dyPixels*w,Z=(m.dxPixels+m.width)*w-m.dyPixels*b,P=(m.dxPixels+m.width)*b+m.dyPixels*w,V=m.dxPixels*w-(m.dyPixels+m.height)*b,B=m.dxPixels*b+(m.dyPixels+m.height)*w,L=(m.dxPixels+m.width)*w-(m.dyPixels+m.height)*b,D=(m.dxPixels+m.width)*b+(m.dyPixels+m.height)*w,E=Math.min(M,Z,V,L),A=Math.max(M,Z,V,L),R=Math.min(T,P,B,D),S=Math.max(T,P,B,D);m.dxPixels=E,m.dyPixels=R,m.width=A-E,m.height=S-R}}}catch(re){_.e(re)}finally{_.f()}}}if(y){var C=h.hasDataDrivenIcon?h.iconMaterial.encodeAttributes(e.symbolFeature.feature,o,h):null;if(this._addPlacedIcons(e,y.shapes,o,n.page,t.rotationAlignment===I.aF.VIEWPORT,C),y.iconColliders){e.iconColliders=y.iconColliders;var F,O=(0,a.Z)(y.iconColliders);try{for(O.s();!(F=O.n()).done;){var U=F.value;U.minLod=Math.max(o+(0,c.k3)(U.minLod),0),U.maxLod=Math.min(o+(0,c.k3)(U.maxLod),25);var z=U.angle;if(z){var N=Math.cos(z),G=Math.sin(z),H=U.dxPixels*N-U.dyPixels*G,K=U.dxPixels*G+U.dyPixels*N,W=(U.dxPixels+U.width)*N-U.dyPixels*G,j=(U.dxPixels+U.width)*G+U.dyPixels*N,q=U.dxPixels*N-(U.dyPixels+U.height)*G,Y=U.dxPixels*G+(U.dyPixels+U.height)*N,J=(U.dxPixels+U.width)*N-(U.dyPixels+U.height)*G,X=(U.dxPixels+U.width)*G+(U.dyPixels+U.height)*N,Q=Math.min(H,W,q,J),$=Math.max(H,W,q,J),ee=Math.min(K,j,Y,X),te=Math.max(K,j,Y,X);U.dxPixels=Q,U.dyPixels=ee,U.width=$-Q,U.height=te-ee}}}catch(re){O.e(re)}finally{O.f()}}}}}},{key:"_addPlacedIcons",value:function(e,t,r,i,n,s){var l,o=Math.max(r-1,0),h=this._iconVertexBuffer,u=this._iconIndexBuffer,f=this._markerMap,y=(0,a.Z)(t);try{for(y.s();!(l=y.n()).done;){var d=l.value,v=n?0:Math.max(r+(0,c.k3)(d.minzoom),o),g=n?25:Math.min(r+(0,c.k3)(d.maxzoom),25);if(!(g<=v)){var p=d.tl,x=d.tr,_=d.bl,m=d.br,I=d.mosaicRect,k=d.labelAngle,w=d.minAngle,b=d.maxAngle,M=d.anchor,T=h.index,Z=I.x,P=I.y,V=Z+I.width,B=P+I.height,L=h.index;h.add(M.x,M.y,p.x,p.y,Z,P,k,w,b,v,g,s),h.add(M.x,M.y,x.x,x.y,V,P,k,w,b,v,g,s),h.add(M.x,M.y,_.x,_.y,Z,B,k,w,b,v,g,s),h.add(M.x,M.y,m.x,m.y,V,B,k,w,b,v,g,s),e.iconVertexRanges.length>0&&e.iconVertexRanges[0][0]+e.iconVertexRanges[0][1]===L?e.iconVertexRanges[0][1]+=4:e.iconVertexRanges.push([L,4]),u.add(T+0,T+1,T+2),u.add(T+1,T+2,T+3),f.has(i)?f.get(i)[1]+=6:f.set(i,[this._iconIndexStart+this._iconIndexCount,6]),this._iconIndexCount+=6}}}catch(D){y.e(D)}finally{y.f()}}},{key:"_addPlacedGlyphs",value:function(){var e,t=this._textVertexBuffer,r=this._textIndexBuffer,i=this._glyphMap,n=(0,a.Z)(this._glyphBufferDataStorage);try{for(n.s();!(e=n.n()).done;){var s,l=(0,V.Z)(e.value,2),o=l[0],h=l[1],u=(0,a.Z)(h);try{for(u.s();!(s=u.n()).done;){var f=s.value,c=t.index,y=f.symbolInstance,d=f.ddAttributes,v=t.index;t.add(f.glyphAnchor[0],f.glyphAnchor[1],f.tl[0],f.tl[1],f.xmin,f.ymin,f.labelAngle,f.minAngle,f.maxAngle,f.minLod,f.maxLod,d),t.add(f.glyphAnchor[0],f.glyphAnchor[1],f.tr[0],f.tr[1],f.xmax,f.ymin,f.labelAngle,f.minAngle,f.maxAngle,f.minLod,f.maxLod,d),t.add(f.glyphAnchor[0],f.glyphAnchor[1],f.bl[0],f.bl[1],f.xmin,f.ymax,f.labelAngle,f.minAngle,f.maxAngle,f.minLod,f.maxLod,d),t.add(f.glyphAnchor[0],f.glyphAnchor[1],f.br[0],f.br[1],f.xmax,f.ymax,f.labelAngle,f.minAngle,f.maxAngle,f.minLod,f.maxLod,d),y.textVertexRanges.length>0&&y.textVertexRanges[0][0]+y.textVertexRanges[0][1]===v?y.textVertexRanges[0][1]+=4:y.textVertexRanges.push([v,4]),r.add(c+0,c+1,c+2),r.add(c+1,c+2,c+3),i.has(o)?i.get(o)[1]+=6:i.set(o,[this._textIndexStart+this._textIndexCount,6]),this._textIndexCount+=6}}catch(g){u.e(g)}finally{u.f()}}}catch(g){n.e(g)}finally{n.f()}this._glyphBufferDataStorage.clear()}},{key:"_storePlacedGlyphs",value:function(e,t,r,i,n){var s,l,o,h,u,f,y,d,v,g,p,x,_=Math.max(r-1,0),m=i===I.aF.VIEWPORT,k=(0,a.Z)(t);try{for(k.s();!(x=k.n()).done;){var w=x.value;(s=m?0:Math.max(r+(0,c.k3)(w.minzoom),_),(l=m?25:Math.min(r+(0,c.k3)(w.maxzoom),25))<=s)||(o=w.tl,h=w.tr,u=w.bl,f=w.br,y=w.labelAngle,d=w.minAngle,v=w.maxAngle,g=w.anchor,p=w.mosaicRect,this._glyphBufferDataStorage.has(w.page)||this._glyphBufferDataStorage.set(w.page,[]),this._glyphBufferDataStorage.get(w.page).push({glyphAnchor:[g.x,g.y],tl:[o.x,o.y],tr:[h.x,h.y],bl:[u.x,u.y],br:[f.x,f.y],xmin:p.x,ymin:p.y,xmax:p.x+p.width,ymax:p.y+p.height,labelAngle:y,minAngle:d,maxAngle:v,minLod:s,maxLod:l,placementLod:_,symbolInstance:e,ddAttributes:n}))}}catch(b){k.e(b)}finally{k.f()}}}],[{key:"_symbolsSerializationLength",value:function(e){var t=0;t+=1;var r,i=(0,a.Z)(e||[]);try{for(i.s();!(r=i.n()).done;){var n=r.value;t+=4,t+=1;var s,l=(0,a.Z)(n.textColliders);try{for(l.s();!(s=l.n()).done;){s.value;t+=10}}catch(u){l.e(u)}finally{l.f()}var o,h=(0,a.Z)(n.iconColliders);try{for(h.s();!(o=h.n()).done;){o.value;t+=10}}catch(u){h.e(u)}finally{h.f()}t+=1,t+=2*n.textVertexRanges.length,t+=1,t+=2*n.iconVertexRanges.length}}catch(u){i.e(u)}finally{i.f()}return t}},{key:"serializeSymbols",value:function(e,t,r,i,n){n=n||[],t[i++]=n.length;var s,l=(0,a.Z)(n);try{for(l.s();!(s=l.n()).done;){var o=s.value;t[i++]=o.anchor.x,t[i++]=o.anchor.y,t[i++]=o.symbolFeature.hash,t[i++]=o.symbolFeature.priority,t[i++]=o.textColliders.length+o.iconColliders.length;var h,u=(0,a.Z)(o.textColliders);try{for(u.s();!(h=u.n()).done;){var f=h.value;t[i++]=f.xTile,t[i++]=f.yTile,t[i++]=f.dxPixels,t[i++]=f.dyPixels,t[i++]=f.hard?1:0,t[i++]=f.partIndex,r[i++]=f.minLod,r[i++]=f.maxLod,t[i++]=f.width,t[i++]=f.height}}catch(M){u.e(M)}finally{u.f()}var c,y=(0,a.Z)(o.iconColliders);try{for(y.s();!(c=y.n()).done;){var d=c.value;t[i++]=d.xTile,t[i++]=d.yTile,t[i++]=d.dxPixels,t[i++]=d.dyPixels,t[i++]=d.hard?1:0,t[i++]=d.partIndex,r[i++]=d.minLod,r[i++]=d.maxLod,t[i++]=d.width,t[i++]=d.height}}catch(M){y.e(M)}finally{y.f()}t[i++]=o.textVertexRanges.length;var v,g=(0,a.Z)(o.textVertexRanges);try{for(g.s();!(v=g.n()).done;){var p=(0,V.Z)(v.value,2),x=p[0],_=p[1];t[i++]=x,t[i++]=_}}catch(M){g.e(M)}finally{g.f()}t[i++]=o.iconVertexRanges.length;var m,I=(0,a.Z)(o.iconVertexRanges);try{for(I.s();!(m=I.n()).done;){var k=(0,V.Z)(m.value,2),w=k[0],b=k[1];t[i++]=w,t[i++]=b}}catch(M){I.e(M)}finally{I.f()}}}catch(M){l.e(M)}finally{l.f()}return i}},{key:"_pushAnchors",value:function(e,t,r,a){r+=a;for(var i=0,n=t.length-1,s=0;s<n;s++)i+=k.E.distance(t[s],t[s+1]);var l=a||r;if(!(i<=(l*=.5)))for(var o=l/i,h=0,u=-(r=i/Math.max(Math.round(i/r),1))/2,f=t.length-1,y=0;y<f;y++){for(var d=t[y],v=t[y+1],g=v.x-d.x,p=v.y-d.y,x=Math.sqrt(g*g+p*p),_=void 0;u+r<h+x;){var m=((u+=r)-h)/x,I=(0,c.sX)(d.x,v.x,m),w=(0,c.sX)(d.y,v.y,m);void 0===_&&(_=Math.atan2(p,g)),e.push(new b(I,w,_,y,o))}h+=x}}},{key:"_pushCenterAnchor",value:function(e,t){for(var r=0,a=t.length-1,i=0;i<a;i++)r+=k.E.distance(t[i],t[i+1]);for(var n=r/2,s=0,l=t.length-1,o=0;o<l;o++){var h=t[o],u=t[o+1],f=u.x-h.x,y=u.y-h.y,d=Math.sqrt(f*f+y*y);if(n<s+d){var v=(n-s)/d,g=(0,c.sX)(h.x,u.x,v),p=(0,c.sX)(h.y,u.y,v),x=Math.atan2(y,f);return void e.push(new b(g,p,x,o,0))}s+=d}}},{key:"_deviation",value:function(e,t,r){var a=(t.x-e.x)*(r.x-t.x)+(t.y-e.y)*(r.y-t.y),i=(t.x-e.x)*(r.y-t.y)-(t.y-e.y)*(r.x-t.x);return Math.atan2(i,a)}},{key:"_honorsTextMaxAngle",value:function(e,t,r,a,i){for(var n=0,s=r/2,l=new k.E(t.x,t.y),o=t.segment+1;n>-s;){if(--o<0)return!1;n-=k.E.distance(e[o],l),l=e[o]}n+=k.E.distance(e[o],e[o+1]);for(var h=[],u=0,f=e.length;n<s;){var c=e[o],y=void 0,d=o;do{if(++d===f)return!1;y=e[d]}while(y.isEqual(c));var v=void 0,g=d;do{if(++g===f)return!1;v=e[g]}while(v.isEqual(y));var p=this._deviation(c,y,v);for(h.push({deviation:p,distToAnchor:n}),u+=p;n-h[0].distToAnchor>i;)u-=h.shift().deviation;if(Math.abs(u)>a)return!1;n+=k.E.distance(y,v),o=d}return!0}},{key:"_smoothVertices",value:function(e,t){if(t<=0)return e;var r=e.length;if(r<3)return e;var a=[],i=0,n=0;a.push(0);for(var s=1;s<r;s++){var l=k.E.distance(e[s],e[s-1]);l>0&&(i+=l,a.push(i),++n!==s&&(e[n]=e[s]))}if((r=n+1)<3)return e;t=Math.min(t,.2*i);var o=e[0].x,h=e[0].y,u=e[r-1].x,f=e[r-1].y,c=k.E.sub(e[0],e[1]);c.normalize(),e[0].x+=t*c.x,e[0].y+=t*c.y,c.assignSub(e[r-1],e[r-2]),c.normalize(),e[r-1].x+=t*c.x,e[r-1].y+=t*c.y,a[0]-=t,a[r-1]+=t;var y=[];y.push(new k.E(o,h));for(var d=1e-6,v=.5*t,g=1;g<r-1;g++){for(var p=0,x=0,_=0,m=g-1;m>=0;m--){var I=v+a[m+1]-a[g];if(I<0)break;var w=a[m+1]-a[m],b=a[g]-a[m]<v?1:I/w;if(b<d)break;var M=b*b,T=b*I-.5*M*w,Z=b*w/t,P=e[m+1],V=e[m].x-P.x,B=e[m].y-P.y;p+=Z/T*(P.x*b*I+.5*M*(I*V-w*P.x)-M*b*w*V/3),x+=Z/T*(P.y*b*I+.5*M*(I*B-w*P.y)-M*b*w*B/3),_+=Z}for(var L=g+1;L<r;L++){var D=v-a[L-1]+a[g];if(D<0)break;var E=a[L]-a[L-1],A=a[L]-a[g]<v?1:D/E;if(A<d)break;var R=A*A,S=A*D-.5*R*E,C=A*E/t,F=e[L-1],O=e[L].x-F.x,U=e[L].y-F.y;p+=C/S*(F.x*A*D+.5*R*(D*O-E*F.x)-R*A*E*O/3),x+=C/S*(F.y*A*D+.5*R*(D*U-E*F.y)-R*A*E*U/3),_+=C}y.push(new k.E(p/_,x/_))}return y.push(new k.E(u,f)),e[0].x=o,e[0].y=h,e[r-1].x=u,e[r-1].y=f,y}},{key:"_pushCentroid",value:function(e,t){var r=4096,a=4096,i=t.length-1,n=0,s=0,l=0,o=t[0].x,h=t[0].y;o>r&&(o=r),o<0&&(o=0),h>a&&(h=a),h<0&&(h=0);for(var u=1;u<i;u++){var f=t[u].x,c=t[u].y,y=t[u+1].x,d=t[u+1].y;f>r&&(f=r),f<0&&(f=0),c>a&&(c=a),c<0&&(c=0),y>r&&(y=r),y<0&&(y=0),d>a&&(d=a),d<0&&(d=0);var v=(f-o)*(d-h)-(y-o)*(c-h);n+=v*(o+f+y),s+=v*(h+c+d),l+=v}n/=3*l,s/=3*l,isNaN(n)||isNaN(s)||e.push(new b(n,s))}}]),r}(G);re._bidiEngine=new Q.Z;var ae,ie=r(91623);!function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.NO_DATA=1]="NO_DATA",e[e.READY=2]="READY",e[e.MODIFIED=3]="MODIFIED",e[e.INVALID=4]="INVALID"}(ae||(ae={}));var ne=function(){function e(t,r,i,s,l){if((0,n.Z)(this,e),this._pbfTiles={},this._tileClippers={},this._client=i,this._tile=r,l){this._styleLayerUIDs=new Set;var o,h=(0,a.Z)(l);try{for(h.s();!(o=h.n()).done;){var u=o.value;this._styleLayerUIDs.add(u)}}catch(T){h.e(T)}finally{h.f()}}this._styleRepository=s,this._layers=this._styleRepository.layers;var f=r.tileKey.split("/").map(parseFloat),c=(0,V.Z)(f,3),y=c[0],d=c[1],v=c[2];this._level=y;for(var g=8+Math.max(5*(this._level-14),0),p=0,x=Object.keys(t);p<x.length;p++){var _=x[p],m=t[_];if(this._pbfTiles[_]=new B.Z(new Uint8Array(m.protobuff),new DataView(m.protobuff)),m.refKey){var I=m.refKey.split("/").map(parseFloat),k=y-(0,V.Z)(I,1)[0];if(k>0){var w=(1<<k)-1,b=d&w,M=v&w;this._tileClippers[_]=new ie.b(k,b,M,8,g)}}this._tileClippers[_]||(this._tileClippers[_]=new ie.I)}}return(0,s.Z)(e,[{key:"_canParseStyleLayer",value:function(e){return!this._styleLayerUIDs||this._styleLayerUIDs.has(e)}},{key:"parse",value:function(){var e=(0,i.Z)(l.mark((function e(t){var r,i,n,s,o,h,f,c,y,d,v,g=this;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=(0,L.j)(),i=this._initialize(t),n=i.returnedBuckets,this._processLayers(i),this._linkReferences(i),this._filterFeatures(i),s=[],o=new Set,h=function(e,t){o.has(e)||(s.push({name:e,repeat:t}),o.add(e))},f={},c=(0,a.Z)(n);try{for(c.s();!(y=c.n()).done;)(d=y.value).getResources(d.tileClipper,h,f)}catch(l){c.e(l)}finally{c.f()}if(this._tile.status!==ae.INVALID){e.next=7;break}return e.abrupt("return",Promise.resolve([]));case 7:return v=this._fetchResources(s,f,t),e.abrupt("return",Promise.all([].concat((0,u.Z)(v),[r])).then((function(){return g._processFeatures(i.returnedBuckets)})));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_initialize",value:function(e){return{signal:e&&e.signal,sourceNameToTileData:this._parseTileData(this._pbfTiles),layers:this._layers,zoom:this._level,sourceNameToTileClipper:this._tileClippers,sourceNameToUniqueSourceLayerBuckets:{},sourceNameToUniqueSourceLayers:{},returnedBuckets:[],layerIdToBucket:{},referencerUIDToReferencedId:new Map}}},{key:"_processLayers",value:function(e){for(var t=e.sourceNameToTileData,r=e.layers,a=e.zoom,i=e.sourceNameToTileClipper,n=e.sourceNameToUniqueSourceLayerBuckets,s=e.sourceNameToUniqueSourceLayers,l=e.returnedBuckets,o=e.layerIdToBucket,h=e.referencerUIDToReferencedId,u=r.length-1;u>=0;u--){var f=r[u];if(!(!this._canParseStyleLayer(f.uid)||f.minzoom&&a<Math.floor(f.minzoom)||f.maxzoom&&a>=f.maxzoom||f.type===I.fR.BACKGROUND)&&(t[f.source]&&i[f.source])){var c=t[f.source],y=i[f.source],d=f.sourceLayer,v=c[d];if(v){var g=s[f.source];if(g||(g=s[f.source]=new Set),g.add(f.sourceLayer),f.refLayerId)h.set(f.uid,f.refLayerId);else{var p=this._createBucket(f);if(p){p.layerUIDs=[f.uid],p.layerExtent=v.extent,p.tileClipper=y;var x=n[f.source];x||(x=n[f.source]={});var _=x[d];_||(_=x[d]=[]),_.push(p),l.push(p),o[f.id]=p}}}}}}},{key:"_linkReferences",value:function(e){var t=e.layerIdToBucket;e.referencerUIDToReferencedId.forEach((function(e,r){t[e=e]&&t[e].layerUIDs.push(r)}))}},{key:"_filterFeatures",value:function(e){for(var t=e.signal,r=e.sourceNameToTileData,i=e.sourceNameToUniqueSourceLayerBuckets,n=e.sourceNameToUniqueSourceLayers,s=10*this._level,l=10*(this._level+1),h=[],u=[],f=function(){var e=y[c];n[e].forEach((function(t){h.push(t),u.push(e)}))},c=0,y=Object.keys(n);c<y.length;c++)f();for(var d=0;d<h.length;d++){var v=u[d],g=h[d];if(r[v]&&i[v]){var p=r[v][g],x=i[v][g];if(x&&0!==x.length){if((0,o.Hc)(t))return;for(var _=p.getData();_.nextTag(2);){var m=_.getMessage(),I=new D(m,p);m.release();var k=I.values;if(k){var w=k._minzoom;if(w&&w>=l)continue;var b=k._maxzoom;if(b&&b<=s)continue}var M,T=(0,a.Z)(x);try{for(T.s();!(M=T.n()).done;){M.value.pushFeature(I)}}catch(Z){T.e(Z)}finally{T.f()}}}}}}},{key:"_fetchResources",value:function(e,t,r){var a,i,n=[],s=this._tile.getWorkerTileHandler();for(var l in e.length>0&&(a=s.fetchSprites(e,this._client,r),n.push(a)),t){var o=t[l];o.size>0&&(i=s.fetchGlyphs(this._tile.tileKey,l,o,this._client,r),n.push(i))}return n}},{key:"_processFeatures",value:function(e){var t,r=this,i=e.filter((function(e){return e.hasFeatures()||r._canParseStyleLayer(e.layer.uid)})),n=(0,a.Z)(i);try{for(n.s();!(t=n.n()).done;){var s=t.value;s.processFeatures(s.tileClipper)}}catch(l){n.e(l)}finally{n.f()}return i}},{key:"_parseTileData",value:function(e){for(var t={},r=0,a=Object.keys(e);r<a.length;r++){for(var i=a[r],n=e[i],s={};n.next();)if(3===n.tag()){var l=n.getMessage(),o=new C(l);l.release(),s[o.name]=o}else n.skip();t[i]=s}return t}},{key:"_createBucket",value:function(e){switch(e.type){case I.fR.BACKGROUND:return null;case I.fR.FILL:return this._createFillBucket(e);case I.fR.LINE:return this._createLineBucket(e);case I.fR.CIRCLE:return this._createCircleBucket(e);case I.fR.SYMBOL:return this._createSymbolBucket(e)}}},{key:"_createFillBucket",value:function(e){return new j(e,this._level,this._tile.getWorkerTileHandler().getSpriteItems(),new O(e.fillMaterial.getStride()),new S,new U(e.outlineMaterial.getStride()),new S)}},{key:"_createLineBucket",value:function(e){return new Y(e,this._level,this._tile.getWorkerTileHandler().getSpriteItems(),new F(e.lineMaterial.getStride()),new S)}},{key:"_createCircleBucket",value:function(e){return new H(e,this._level,this._tile.getWorkerTileHandler().getSpriteItems(),new N(e.circleMaterial.getStride()),new S)}},{key:"_createSymbolBucket",value:function(e){var t=this._tile;return new re(e,this._level,new z(e.iconMaterial.getStride()),new S,new z(e.textMaterial.getStride()),new S,t.placementEngine,t.getWorkerTileHandler())}}]),e}(),se=function(){function e(t,r,a,i){(0,n.Z)(this,e),this.status=ae.INITIALIZED,this.placementEngine=new P,this.tileKey=t,this.refKeys=r,this._workerTileHandler=a,this._styleRepository=i}return(0,s.Z)(e,[{key:"release",value:function(){this.tileKey="",this.refKeys=null,this.status=ae.INITIALIZED,this._workerTileHandler=null}},{key:"parse",value:function(){var e=(0,i.Z)(l.mark((function e(t,r){var i,n,s,h,c,y,d,v,g,p,x,_,m=this;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r&&r.signal,(0,f.pC)(i)&&(n=function e(){i.removeEventListener("abort",e),m.status=ae.INVALID},i.addEventListener("abort",n)),h={bucketsWithData:[],emptyBuckets:null},e.prev=3,e.next=6,this._parse(t,r);case 6:s=e.sent,e.next=14;break;case 9:if(e.prev=9,e.t0=e.catch(3),!(0,o.D_)(e.t0)){e.next=13;break}throw e.t0;case 13:return e.abrupt("return",{result:h,transferList:[]});case 14:this.status=ae.READY,c=h.bucketsWithData,y=[],d=(0,a.Z)(s);try{for(d.s();!(v=d.n()).done;)(g=v.value).hasFeatures()?(p=g.serialize(),c.push(p)):y.push(g.layer.uid)}catch(l){d.e(l)}finally{d.f()}return x=(0,u.Z)(c),_=null,e.abrupt("return",(y.length>0&&(_=Uint32Array.from(y),x.push(_.buffer)),h.emptyBuckets=_,{result:h,transferList:x}));case 21:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setObsolete",value:function(){this.status=ae.INVALID}},{key:"getLayers",value:function(){return this._workerTileHandler.getLayers()}},{key:"getWorkerTileHandler",value:function(){return this._workerTileHandler}},{key:"_parse",value:function(){var e=(0,i.Z)(l.mark((function e(t,r){var a;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.sourceName2DataAndRefKey,0!==Object.keys(a).length){e.next=3;break}return e.abrupt("return",[]);case 3:return this.status=ae.MODIFIED,e.abrupt("return",new ne(a,this,r.client,this._styleRepository,t.styleLayerUIDs).parse(r));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),le=r(30969),oe=function(){function e(){(0,n.Z)(this,e),this._spriteInfo={},this._glyphInfo={}}return(0,s.Z)(e,[{key:"reset",value:function(){return this._spriteInfo={},this._glyphInfo={},Promise.resolve()}},{key:"getLayers",value:function(){var e;return null==(e=this._styleRepository)?void 0:e.layers}},{key:"createTileAndParse",value:function(){var e=(0,i.Z)(l.mark((function e(t,r){var a,i,n,s,h,u,f;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=t.key,i={},n=0,s=Object.keys(t.sourceName2DataAndRefKey);n<s.length;n++)h=s[n],u=t.sourceName2DataAndRefKey[h],i[h]=u.refKey;return f=new se(a,i,this,this._styleRepository),e.prev=3,e.next=6,f.parse(t,r);case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),f.setObsolete(),f.release(),(0,o.D_)(e.t0)){e.next=13;break}throw e.t0;case 13:return e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateStyle",value:function(e){if(e&&0!==e.length&&this._styleRepository){var t,r=this._styleRepository,i=(0,a.Z)(e);try{for(i.s();!(t=i.n()).done;){var n=t.value,s=n.type,l=n.data;switch(s){case h.Fr.PAINTER_CHANGED:r.setPaintProperties(l.layer,l.paint);break;case h.Fr.LAYOUT_CHANGED:r.setLayoutProperties(l.layer,l.layout);break;case h.Fr.LAYER_REMOVED:r.deleteStyleLayer(l.layer);break;case h.Fr.LAYER_CHANGED:r.setStyleLayer(l.layer,l.index);break;case h.Fr.SPRITES_CHANGED:this._spriteInfo={}}}}catch(o){i.e(o)}finally{i.f()}}}},{key:"setStyle",value:function(e){this._styleRepository=new le.Z(e),this._spriteInfo={},this._glyphInfo={}}},{key:"fetchSprites",value:function(e,t,r){var i,n=[],s=this._spriteInfo,l=(0,a.Z)(e);try{for(l.s();!(i=l.n()).done;){var o=i.value;void 0===s[o.name]&&n.push(o)}}catch(h){l.e(h)}finally{l.f()}return 0===n.length?Promise.resolve():t.invoke("getSprites",n,{signal:r&&r.signal}).then((function(e){for(var t in e){var r=e[t];s[t]=r}}))}},{key:"getSpriteItems",value:function(){return this._spriteInfo}},{key:"fetchGlyphs",value:function(e,t,r,a,i){var n=[],s=this._glyphInfo[t];return s?r.forEach((function(e){s[e]||n.push(e)})):(s=this._glyphInfo[t]=[],r.forEach((function(e){return n.push(e)}))),0===n.length?Promise.resolve():a.invoke("getGlyphs",{tileID:e,font:t,codePoints:n},i).then((function(e){for(var t=0;t<e.length;t++)e[t]&&(s[t]=e[t])}))}},{key:"getGlyphItems",value:function(e){return this._glyphInfo[e]}}]),e}()}}]);
//# sourceMappingURL=1522.4e2b6b85.chunk.js.map