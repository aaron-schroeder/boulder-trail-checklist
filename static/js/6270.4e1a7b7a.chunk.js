"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[6270],{36231:function(e,t,r){r.d(t,{q:function(){return u}});var n,i,a,s={exports:{}};n=s,i=function(){function e(r,n,i,a,s){for(;a>i;){if(a-i>600){var u=a-i+1,o=n-i+1,l=Math.log(u),c=.5*Math.exp(2*l/3),f=.5*Math.sqrt(l*c*(u-c)/u)*(o-u/2<0?-1:1);e(r,n,Math.max(i,Math.floor(n-o*c/u+f)),Math.min(a,Math.floor(n+(u-o)*c/u+f)),s)}var h=r[n],d=i,p=a;for(t(r,i,n),s(r[a],h)>0&&t(r,i,a);d<p;){for(t(r,d,p),d++,p--;s(r[d],h)<0;)d++;for(;s(r[p],h)>0;)p--}0===s(r[i],h)?t(r,i,p):t(r,++p,a),p<=n&&(i=p+1),n<=p&&(a=p-1)}}function t(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function r(e,t){return e<t?-1:e>t?1:0}return function(t,n,i,a,s){e(t,n,i||0,a||t.length-1,s||r)}},void 0!==(a=i())&&(n.exports=a);var u=s.exports},40237:function(e,t,r){r.d(t,{N:function(){return a}});var n=r(43144),i=r(15671),a={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,r){var n=new s(e.getPointX(t),e.getPointY(t),r),i=e.hasZ(t),a=e.hasM(t);return i&&(n.z=e.getPointZ(t)),a&&(n.m=e.getPointM(t)),n},exportPolygon:function(e,t,r){return new u(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,r){return new o(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,r){return new l(e.exportPoints(t),r,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,r){var n=e.hasZ(t),i=e.hasM(t),a=new c(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),r);if(n){var s=e.getZExtent(t);a.zmin=s.vmin,a.zmax=s.vmax}if(i){var u=e.getMExtent(t);a.mmin=u.vmin,a.mmax=u.vmax}return a}};var s=(0,n.Z)((function e(t,r,n){(0,i.Z)(this,e),this.x=t,this.y=r,this.spatialReference=n,this.z=void 0,this.m=void 0}));var u=(0,n.Z)((function e(t,r,n,a){(0,i.Z)(this,e),this.rings=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),a&&(this.hasM=a)}));var o=(0,n.Z)((function e(t,r,n,a){(0,i.Z)(this,e),this.paths=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),a&&(this.hasM=a)}));var l=(0,n.Z)((function e(t,r,n,a){(0,i.Z)(this,e),this.points=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),a&&(this.hasM=a)}));var c=(0,n.Z)((function e(t,r,n,a,s){(0,i.Z)(this,e),this.xmin=t,this.ymin=r,this.xmax=n,this.ymax=a,this.spatialReference=s,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}))},58971:function(e,t,r){r.d(t,{G6:function(){return v},Ie:function(){return m},J9:function(){return d},U1:function(){return p},vY:function(){return o}});var n=r(70885),i=r(92026);r(77981);var a=function(e,t,r){return[t,r]},s=function(e,t,r){return[t,r,e[2]]},u=function(e,t,r){return[t,r,e[2],e[3]]};function o(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:(0,i.pC)(e.extent)?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function l(e,t){var r=e.scale,n=e.translate;return t*r[0]+n[0]}function c(e,t){var r=e.scale;return e.translate[1]-t*r[1]}function f(e,t,r){var i=new Array(r.length);if(!r.length)return i;var a=(0,n.Z)(e.scale,2),s=a[0],u=a[1],o=l(e,r[0][0]),f=c(e,r[0][1]);i[0]=t(r[0],o,f);for(var h=1;h<r.length;h++){var d=r[h];o+=d[0]*s,f-=d[1]*u,i[h]=t(d,o,f)}return i}function h(e,t,r){for(var n=new Array(r.length),i=0;i<r.length;i++)n[i]=f(e,t,r[i]);return n}function d(e,t,r,n,o){return(0,i.pC)(r)&&(t.points=function(e,t,r,n){return f(e,r?n?u:s:n?s:a,t)}(e,r.points,n,o)),t}function p(e,t,r,n,a){return(0,i.Wi)(r)||(t.x=l(e,r.x),t.y=c(e,r.y),t!==r&&(n&&(t.z=r.z),a&&(t.m=r.m))),t}function m(e,t,r,n,o){return(0,i.pC)(r)&&(t.rings=function(e,t,r,n){return h(e,r?n?u:s:n?s:a,t)}(e,r.rings,n,o)),t}function v(e,t,r,n,o){return(0,i.pC)(r)&&(t.paths=function(e,t,r,n){return h(e,r?n?u:s:n?s:a,t)}(e,r.paths,n,o)),t}},85403:function(e,t,r){r.d(t,{Y:function(){return s}});var n=r(37762),i=r(92026);function a(e,t){return e?t?4:3:t?3:2}function s(e,t,r,s,l){if((0,i.Wi)(t)||!t.lengths.length)return null;var c="upperLeft"===(null==l?void 0:l.originPosition)?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);var f,h=e.coords,d=[],p=r?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],m=t.lengths,v=t.coords,y=a(r,s),g=0,x=(0,n.Z)(m);try{for(x.s();!(f=x.n()).done;){var _=f.value,b=u(p,v,g,_,r,s,c);b&&d.push(b),g+=_*y}}catch(T){x.e(T)}finally{x.f()}if(d.sort((function(e,t){var n=c*e[2]-c*t[2];return 0===n&&r&&(n=e[4]-t[4]),n})),d.length){var k=6*d[0][2];h[0]=d[0][0]/k,h[1]=d[0][1]/k,r&&(k=6*d[0][4],h[2]=0!==k?d[0][3]/k:0),(h[0]<p[0]||h[0]>p[1]||h[1]<p[2]||h[1]>p[3]||r&&(h[2]<p[4]||h[2]>p[5]))&&(h.length=0)}if(!h.length){var I=t.lengths[0]?o(v,0,m[0],r,s):null;if(!I)return null;h[0]=I[0],h[1]=I[1],r&&I.length>2&&(h[2]=I[2])}return e}function u(e,t,r,n,i,s){for(var u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,o=a(i,s),l=r,c=r+o,f=0,h=0,d=0,p=0,m=0,v=0,y=n-1;v<y;v++,l+=o,c+=o){var g=t[l],x=t[l+1],_=t[l+2],b=t[c],k=t[c+1],I=t[c+2],T=g*k-b*x;p+=T,f+=(g+b)*T,h+=(x+k)*T,i&&(d+=(_+I)*(T=g*I-b*_),m+=T),g<e[0]&&(e[0]=g),g>e[1]&&(e[1]=g),x<e[2]&&(e[2]=x),x>e[3]&&(e[3]=x),i&&(_<e[4]&&(e[4]=_),_>e[5]&&(e[5]=_))}if(p*u>0&&(p*=-1),m*u>0&&(m*=-1),!p)return null;var S=[f,h,.5*p];return i&&(S[3]=d,S[4]=.5*m),S}function o(e,t,r,n,i){for(var s=a(n,i),u=t,o=t+s,d=0,p=0,m=0,v=0,y=0,g=r-1;y<g;y++,u+=s,o+=s){var x=e[u],_=e[u+1],b=e[u+2],k=e[o],I=e[o+1],T=e[o+2],S=n?c(x,_,b,k,I,T):l(x,_,k,I);if(S)if(d+=S,n){var E=h(x,_,b,k,I,T);p+=S*E[0],m+=S*E[1],v+=S*E[2]}else{var R=f(x,_,k,I);p+=S*R[0],m+=S*R[1]}}return d>0?n?[p/d,m/d,v/d]:[p/d,m/d]:r>0?n?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function l(e,t,r,n){var i=r-e,a=n-t;return Math.sqrt(i*i+a*a)}function c(e,t,r,n,i,a){var s=n-e,u=i-t,o=a-r;return Math.sqrt(s*s+u*u+o*o)}function f(e,t,r,n){return[e+.5*(r-e),t+.5*(n-t)]}function h(e,t,r,n,i,a){return[e+.5*(n-e),t+.5*(i-t),r+.5*(a-r)]}},33382:function(e,t,r){r.d(t,{Z:function(){return Oe}});var n=r(1413),i=r(37762),a=r(15861),s=r(43144),u=r(15671),o=r(87757),l=r(10064),c=r(84652),f=r(92026),h=r(18759),d=r(68860),p=r(41414),m=r(65156),v=r(376),y=r(77981),g=r(41862),x=r(92975),_=r(42982),b=r(59026),k=r(48562),I=function(){function e(t,r){(0,u.Z)(this,e),this._cache=new b.Z(t),this._invalidCache=new b.Z(r)}return(0,s.Z)(e,[{key:"get",value:function(e,t){var r="".concat(t.uid,":").concat(e),n=this._cache.get(r);if(n)return n;if(void 0!==this._invalidCache.get(r))return null;try{var i=k.WhereClause.create(e,t);return this._cache.put(r,i),i}catch(a){return this._invalidCache.put(r,null),null}}}]),e}(),T=new I(50,500),S="feature-store:unsupported-query",E=" as ",R=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function F(e,t){if(!t)return!0;var r=T.get(t,e);if(!r)throw new l.Z(S,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new l.Z(S,"where clause is not standard",{where:t});return Z(e,r.fieldNames,"where clause contains missing fields"),!0}function w(e,t,r){if(!t)return!0;var n=T.get(t,e);if(!n)throw new l.Z(S,"invalid SQL expression",{having:t});if(!n.isAggregate)throw new l.Z(S,"having does not contain a valid aggregate function",{having:t});var i=n.fieldNames;if(Z(e,i,"having contains missing fields"),!n.getExpressions().every((function(t){var n=t.aggregateType,i=t.field,a=e.has(i)&&e.get(i).name;return r.some((function(t){var r=t.onStatisticField,i=t.statisticType;return(e.has(r)&&e.get(r).name)===a&&i.toLowerCase().trim()===n}))})))throw new l.Z(S,"expressions in having should also exist in outStatistics",{having:t});return!0}function A(e,t){return e?T.get(e,t):null}function Z(e,t,r){var n,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=[],u=(0,i.Z)(t);try{for(u.s();!(n=u.n()).done;){var o=n.value;if("*"!==o&&!e.has(o))if(a){var c=N(o);try{var f=A(c,e);if(!f)throw new l.Z(S,"invalid SQL expression",{where:c});if(!f.isStandardized)throw new l.Z(S,"expression is not standard",{clause:f});Z(e,f.fieldNames,"expression contains missing fields")}catch(de){var h=de&&de.details;if(h&&(h.clause||h.where))throw de;h&&h.missingFields?s.push.apply(s,(0,_.Z)(h.missingFields)):s.push(o)}}else s.push(o)}}catch(d){u.e(d)}finally{u.f()}if(s.length)throw new l.Z(S,r,{missingFields:s})}function N(e){return e.split(E)[0]}function V(e){return e.split(E)[1]}function C(e,t){var r=t.get(e);return!!r&&!R.has(r.type)}var P,M=r(19995),O=r(60480),G=r(4954),Q=r(94446),z=r(58971),D=r(83406),L=r(15903),U=function(){function e(t,r,n){(0,u.Z)(this,e),this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=t.returnDistinctValues,this.fieldsIndex=n,this.featureAdapter=r;var a=t.outFields;if(a&&-1===a.indexOf("*")){this.outFields=a;var s,o=0,l=(0,i.Z)(a);try{for(l.s();!(s=l.n()).done;){var c=s.value,f=N(c),h=this.fieldsIndex.get(f),d=h?null:A(f,n),p=h?h.name:V(c)||"FIELD_EXP_"+o++;this._fieldDataCache.set(c,{alias:p,clause:d})}}catch(m){l.e(m)}finally{l.f()}}}return(0,s.Z)(e,[{key:"countDistinctValues",value:function(e){var t=this;return this.returnDistinctValues?(e.forEach((function(e){return t.getAttributes(e)})),this._returnDistinctMap.size):e.length}},{key:"getAttributes",value:function(e){var t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}},{key:"getFieldValue",value:function(e,t,r){var n=r?r.name:t,i=null;return this._fieldDataCache.has(n)?i=this._fieldDataCache.get(n).clause:r||(i=A(t,this.fieldsIndex),this._fieldDataCache.set(n,{alias:n,clause:i})),r?this.featureAdapter.getAttribute(e,n):i.calculateValue(e,this.featureAdapter)}},{key:"getNormalizedValue",value:function(e,t){var r=t.normalizationType,n=t.normalizationTotal,i=this.getFieldValue(e,t.field,t.fieldInfo);if(r&&Number.isFinite(i)){var a=this.getFieldValue(e,t.normalizationField,t.normalizationFieldInfo);i=(0,L.fk)(i,r,a,n)}return i}},{key:"getExpressionValue",value:function(e,t,r){var n={attributes:this.featureAdapter.getAttributes(e)},i=r.createExecContext(n,t.viewInfo);return r.executeFunction(t.compiledFunc,i)}},{key:"validateItem",value:function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:A(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)}},{key:"validateItems",value:function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:A(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)}},{key:"_processAttributesForOutFields",value:function(e){var t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);var r,n={},a=(0,i.Z)(t);try{for(a.s();!(r=a.n()).done;){var s=r.value,u=this._fieldDataCache.get(s),o=u.alias,l=u.clause;n[o]=l?l.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,o)}}catch(c){a.e(c)}finally{a.f()}return n}},{key:"_processAttributesForDistinctValues",value:function(e){if((0,f.Wi)(e)||!this.returnDistinctValues)return e;var t=this.outFields,r=[];if(t){var n,a=(0,i.Z)(t);try{for(a.s();!(n=a.n()).done;){var s=n.value,u=this._fieldDataCache.get(s).alias;r.push(e[u])}}catch(h){a.e(h)}finally{a.f()}}else for(var o in e)r.push(e[o]);var l="".concat((t||["*"]).join(","),"=").concat(r.join(",")),c=this._returnDistinctMap.get(l)||0;return this._returnDistinctMap.set(l,++c),c>1?null:e}}]),e}(),q=r(20311),j=r(31904),B=r(80031),Y=r(819),H=function(){function e(t,r,n){(0,u.Z)(this,e),this.items=t,this.queryGeometry=r,this.definitionExpression=n.definitionExpression,this.geometryType=n.geometryType,this.hasM=n.hasM,this.hasZ=n.hasZ,this.objectIdField=n.objectIdField,this.spatialReference=n.spatialReference,this.fieldsIndex=n.fieldsIndex,this.timeInfo=n.timeInfo,this.featureAdapter=n.featureAdapter,this.aggregateAdapter=n.aggregateAdapter}return(0,s.Z)(e,[{key:"size",get:function(){return this.items.length}},{key:"createQueryResponseForCount",value:function(e){var t=new U(e,this.featureAdapter,this.fieldsIndex);if(!e.outStatistics)return t.countDistinctValues(this.items);var r=e.groupByFieldsForStatistics,n=e.having;if(!(null==r?void 0:r.length))return 1;var a,s=new Map,u=new Map,o=new Set,l=e.outStatistics,c=(0,i.Z)(l);try{for(c.s();!(a=c.n()).done;){var f=a.value,h="exceedslimit"!==f.statisticType?f.onStatisticField:void 0;if(!u.has(h)){var d,p=[],m=(0,i.Z)(r);try{for(m.s();!(d=m.n()).done;){var v=d.value,y=this._getAttributeValues(t,v,s);p.push(y)}}catch(T){m.e(T)}finally{m.f()}u.set(h,this._calculateUniqueValues(p,t.returnDistinctValues))}var g=u.get(h);for(var x in g){var _=g[x],b=_.data,k=_.items,I=b.join(",");n&&!t.validateItems(k,n)||o.add(I)}}}catch(T){c.e(T)}finally{c.f()}return o.size}},{key:"createQueryResponse",value:function(){var e=(0,a.Z)(o.mark((function e(t){var r;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.outStatistics){e.next=11;break}if(!t.outStatistics.some((function(e){return"exceedslimit"===e.statisticType}))){e.next=5;break}e.t0=this._createExceedsLimitQueryResponse(t),e.next=8;break;case 5:return e.next=7,this._createStatisticsQueryResponse(t);case 7:e.t0=e.sent;case 8:r=e.t0,e.next=12;break;case 11:r=this._createFeatureQueryResponse(t);case 12:return e.abrupt("return",(t.returnQueryGeometry&&((0,x.JY)(t.outSR)&&!(0,x.fS)(this.queryGeometry.spatialReference,t.outSR)?r.queryGeometry=(0,j.S2)((0,n.Z)({spatialReference:t.outSR},(0,M.iV)(this.queryGeometry,this.queryGeometry.spatialReference,t.outSR))):r.queryGeometry=(0,j.S2)((0,n.Z)({spatialReference:t.outSR},this.queryGeometry))),r));case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createSnappingResponse",value:function(e,t){var r,n=this.featureAdapter,a=function(e,t){return e?t?4:3:t?3:2}(this.hasZ,this.hasM),s=e.point,u=s.x,o=s.y,l="number"==typeof e.distance?e.distance:e.distance.x,c="number"==typeof e.distance?e.distance:e.distance.y,h={candidates:[]},d="esriGeometryPolygon"===this.geometryType,p=this._getPointCreator(e.point,this.spatialReference,t),m=(0,i.Z)(this.items);try{for(m.s();!(r=m.n()).done;){var v=r.value,y=n.getGeometry(v);if(!(0,f.Wi)(y)){var g=y.coords,x=y.lengths;if(e.types&P.EDGE)for(var _=0,b=0;b<x.length;b++)for(var k=x[b],I=0;I<k;I++,_+=a){var T=g[_],S=g[_+1];if(I!==k-1){var E=g[_+a],R=g[_+a+1],F=W(u,o,T,S,E,R),w=F.x,A=F.y,Z=(u-w)/l,N=(o-A)/c,V=Z*Z+N*N;V<=1&&h.candidates.push({type:"edge",objectId:n.getObjectId(v),distance:Math.sqrt(V),target:p(w,A),start:p(T,S),end:p(E,R)})}}if(e.types&P.VERTEX)for(var C=d?g.length-a:g.length,M=0;M<C;M+=a){var O=g[M],G=g[M+1],Q=(u-O)/l,z=(o-G)/c,D=Q*Q+z*z;D<=1&&h.candidates.push({type:"vertex",objectId:n.getObjectId(v),distance:Math.sqrt(D),target:p(O,G)})}}}}catch(L){m.e(L)}finally{m.f()}return h.candidates.sort((function(e,t){return e.distance-t.distance})),h}},{key:"_getPointCreator",value:function(e,t,r){var n=(0,f.pC)(r)&&!(0,x.fS)(t,r)?function(e){return(0,M.iV)(e,t,r)}:function(e){return e};return null!=e.z&&null!=e.m?function(t,r){return n({x:t,y:r,z:e.z,m:e.m})}:null!=e.z?function(t,r){return n({x:t,y:r,z:e.z})}:null!=e.m?function(t,r){return n({x:t,y:r,m:e.m})}:function(e,t){return n({x:e,y:t})}}},{key:"executeAttributesQuery",value:function(t){var r=A(t.where,this.fieldsIndex);if(!r)return Promise.resolve(this);if(r.isStandardized){var n,a=0,s=[],u=(0,i.Z)(this.items);try{for(u.s();!(n=u.n()).done;){var o=n.value;r.testFeature(o,this.featureAdapter)&&(s[a++]=o)}}catch(c){u.e(c)}finally{u.f()}var l=new e(s,this.queryGeometry,this);return l.definitionExpression=t.where,Promise.resolve(l)}return Promise.reject(new TypeError("Where clause is not standardized"))}},{key:"executeAggregateIdsQuery",value:function(t){if(!t.aggregateIds||!t.aggregateIds.length||(0,f.Wi)(this.aggregateAdapter))return Promise.resolve(this);var r,n=new Set,a=(0,i.Z)(t.aggregateIds);try{for(a.s();!(r=a.n()).done;){var s=r.value;this.aggregateAdapter.getFeatureObjectIds(s).forEach((function(e){return n.add(e)}))}}catch(o){a.e(o)}finally{a.f()}var u=this.featureAdapter.getObjectId;return Promise.resolve(new e(this.items.filter((function(e){return n.has(u(e))})),this.queryGeometry,this))}},{key:"executeObjectIdsQuery",value:function(t){if(!t.objectIds||!t.objectIds.length)return Promise.resolve(this);var r=new Set(t.objectIds),n=this.featureAdapter.getObjectId;return Promise.resolve(new e(this.items.filter((function(e){return r.has(n(e))})),this.queryGeometry,this))}},{key:"executeTimeQuery",value:function(t){var r=(0,q.y)(this.timeInfo,t.timeExtent,this.featureAdapter);if(!(0,f.pC)(r))return Promise.resolve(this);var n=this.items.filter(r);return Promise.resolve(new e(n,this.queryGeometry,this))}},{key:"filterLatest",value:function(){var t,r=this.timeInfo,n=r.trackIdField,a=r.startTimeField,s=r.endTimeField||a,u=new Map,o=this.featureAdapter.getAttribute,l=(0,i.Z)(this.items);try{for(l.s();!(t=l.n()).done;){var c=t.value,f=o(c,n),h=o(c,s),d=u.get(f);(!d||h>o(d,s))&&u.set(f,c)}}catch(m){l.e(m)}finally{l.f()}var p=Array.from(u.values());return Promise.resolve(new e(p,this.queryGeometry,this))}},{key:"project",value:function(){var t=(0,a.Z)(o.mark((function t(r){var n,i,a=this;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r&&!(0,x.fS)(this.spatialReference,r)){t.next=2;break}return t.abrupt("return",this);case 2:return n=this.featureAdapter,t.next=5,(0,M.oj)(this.items.map((function(e){return(0,j.Op)(a.geometryType,a.hasZ,a.hasM,n.getGeometry(e))})),this.spatialReference,r);case 5:return i=t.sent.map((function(e,t){return n.cloneWithGeometry(a.items[t],(0,D.GH)(e,a.hasZ,a.hasM))})),t.abrupt("return",new e(i,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:r,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter}));case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"createSummaryStatisticsResponse",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){var n,i,a,s,u,l,c,f,h,d,p,m,v,y;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.field,i=r.valueExpression,a=r.normalizationField,s=r.normalizationType,u=r.normalizationTotal,l=r.minValue,c=r.maxValue,f=r.scale,h=this.fieldsIndex.isDateField(n),e.next=11,this._getDataValues(t,{field:n,valueExpression:i,normalizationField:a,normalizationType:s,normalizationTotal:u,scale:f});case 11:return d=e.sent,p=(0,L.S5)({normalizationType:s,normalizationField:a,minValue:l,maxValue:c}),m=this.fieldsIndex.get(n),v={value:.5,fieldType:null==m?void 0:m.type},y=(0,B.qN)(m)?(0,L.H0)({values:d,supportsNullCount:p,percentileParams:v}):(0,L.i5)({values:d,minValue:l,maxValue:c,useSampleStdDev:!s,supportsNullCount:p,percentileParams:v}),e.abrupt("return",(0,L.F_)(y,h));case 17:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createUniqueValuesResponse",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){var n,i,a,s,u,l,c;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.field,i=r.valueExpression,a=r.domain,s=r.returnAllCodedValues,u=r.scale,e.next=7,this._getDataValues(t,{field:n,valueExpression:i,scale:u});case 7:return l=e.sent,c=(0,L.eT)(l),e.abrupt("return",(0,L.Qm)(c,a,s));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createClassBreaksResponse",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){var n,i,a,s,u,l,c,f,h,d,p,m,v;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.field,i=r.valueExpression,a=r.normalizationField,s=r.normalizationType,u=r.normalizationTotal,l=r.classificationMethod,c=r.standardDeviationInterval,f=r.minValue,h=r.maxValue,d=r.numClasses,p=r.scale,e.next=13,this._getDataValues(t,{field:n,valueExpression:i,normalizationField:a,normalizationType:s,normalizationTotal:u,scale:p});case 13:return m=e.sent,v=(0,L.G2)(m,{field:n,normalizationField:a,normalizationType:s,normalizationTotal:u,classificationMethod:l,standardDeviationInterval:c,minValue:f,maxValue:h,numClasses:d}),e.abrupt("return",(0,L.DL)(v,l));case 16:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createHistogramResponse",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){var n,i,a,s,u,l,c,f,h,d,p,m;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.field,i=r.valueExpression,a=r.normalizationField,s=r.normalizationType,u=r.normalizationTotal,l=r.classificationMethod,c=r.standardDeviationInterval,f=r.minValue,h=r.maxValue,d=r.numBins,p=r.scale,e.next=13,this._getDataValues(t,{field:n,valueExpression:i,normalizationField:a,normalizationType:s,normalizationTotal:u,scale:p});case 13:return m=e.sent,e.abrupt("return",(0,L.oF)(m,{field:n,normalizationField:a,normalizationType:s,normalizationTotal:u,classificationMethod:l,standardDeviationInterval:c,minValue:f,maxValue:h,numBins:d}));case 15:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_sortFeatures",value:function(e,t,r){var n=this;if(e.length>1&&t&&t.length){var a,s=(0,i.Z)(t.reverse());try{var u=function(){var t=a.value.split(" "),i=t[0],s=n.fieldsIndex.get(i),u=t[1]&&"desc"===t[1].toLowerCase(),o=(0,L.Lq)(null==s?void 0:s.type,u);e.sort((function(e,t){var n=r(e,i,s),a=r(t,i,s);return o(n,a)}))};for(s.s();!(a=s.n()).done;)u()}catch(o){s.e(o)}finally{s.f()}}}},{key:"_createFeatureQueryResponse",value:function(e){var t=this,r=this.items,n=this.geometryType,i=this.hasM,a=this.hasZ,s=this.objectIdField,u=this.spatialReference,o=e.outFields,l=e.outSR,c=e.quantizationParameters,f=e.resultRecordCount,h=e.resultOffset,d=e.returnZ,p=e.returnM,m=null!=f&&r.length>(h||0)+f,v=o&&(o.includes("*")?(0,_.Z)(this.fieldsIndex.fields):o.map((function(e){return t.fieldsIndex.get(e)})));return{exceededTransferLimit:m,features:this._createFeatures(e,r),fields:v,geometryType:n,hasM:i&&p,hasZ:a&&d,objectIdFieldName:s,spatialReference:(0,j.S2)(l||u),transform:c&&(0,z.vY)(c)||null}}},{key:"_createFeatures",value:function(e,t){var r=new U(e,this.featureAdapter,this.fieldsIndex),n=this.hasM,a=this.hasZ,s=e.orderByFields,u=e.quantizationParameters,o=e.returnGeometry,l=e.returnCentroid,c=e.maxAllowableOffset,f=e.resultOffset,h=e.resultRecordCount,d=e.returnZ,p=void 0!==d&&d,m=e.returnM,v=a&&p,y=n&&(void 0!==m&&m),g=[],x=0,b=(0,_.Z)(t);if(this._sortFeatures(b,s,(function(e,t,n){return r.getFieldValue(e,t,n)})),o||l){var k=(0,z.vY)(u);if(o&&!l){var I,T=(0,i.Z)(b);try{for(T.s();!(I=T.n()).done;){var S=I.value;g[x++]={attributes:r.getAttributes(S),geometry:(0,j.Op)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(S),c,k,v,y)}}}catch(G){T.e(G)}finally{T.f()}}else if(!o&&l){var E,R=(0,i.Z)(b);try{for(R.s();!(E=R.n()).done;){var F=E.value;g[x++]={attributes:r.getAttributes(F),centroid:(0,j.EG)(this,this.featureAdapter.getCentroid(F,this),k)}}}catch(G){R.e(G)}finally{R.f()}}else{var w,A=(0,i.Z)(b);try{for(A.s();!(w=A.n()).done;){var Z=w.value;g[x++]={attributes:r.getAttributes(Z),centroid:(0,j.EG)(this,this.featureAdapter.getCentroid(Z,this),k),geometry:(0,j.Op)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(Z),c,k,v,y)}}}catch(G){A.e(G)}finally{A.f()}}}else{var N,V=(0,i.Z)(b);try{for(V.s();!(N=V.n()).done;){var C=N.value,P=r.getAttributes(C);P&&(g[x++]={attributes:P})}}catch(G){V.e(G)}finally{V.f()}}var M=f||0;if(null!=h){var O=M+h;g=g.slice(M,Math.min(g.length,O))}return g}},{key:"_createExceedsLimitQueryResponse",value:function(e){var t,r=!1,n=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,u=(0,i.Z)(e.outStatistics);try{for(u.s();!(t=u.n()).done;){var o=t.value;if("exceedslimit"===o.statisticType){n=null!=o.maxPointCount?o.maxPointCount:Number.POSITIVE_INFINITY,a=null!=o.maxRecordCount?o.maxRecordCount:Number.POSITIVE_INFINITY,s=null!=o.maxVertexCount?o.maxVertexCount:Number.POSITIVE_INFINITY;break}}}catch(f){u.e(f)}finally{u.f()}if("esriGeometryPoint"===this.geometryType)r=this.items.length>n;else if(this.items.length>a)r=!0;else{var l=this.hasZ?this.hasM?4:3:this.hasM?3:2,c=this.featureAdapter;r=this.items.reduce((function(e,t){var r=c.getGeometry(t);return e+(o(r)&&r.coords.length||0)}),0)/l>s}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(r)}}]}}},{key:"_createStatisticsQueryResponse",value:function(){var e=(0,a.Z)(o.mark((function e(t){var r,n,a,s,u,l,c,f,h,d,p,m,v,y,g,x,_,b,k,I,T,S,E,R,F,w,A,Z,N,V,C,P,M,O,G,Q,z,D,L=this;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={attributes:{}},n=[],a=new Map,s=new Map,u=new Map,l=new Map,c=new U(t,this.featureAdapter,this.fieldsIndex),f=t.outStatistics,h=t.groupByFieldsForStatistics,d=t.having,p=t.orderByFields,m=h&&h.length,y=(v=!!m)&&h[0],g=v&&!this.fieldsIndex.get(y),x=(0,i.Z)(f),e.prev=2,x.s();case 4:if((_=x.n()).done){e.next=34;break}if(b=_.value,k=b.outStatisticFieldName,I=b.statisticType,T=b,S="exceedslimit"!==I?b.onStatisticField:void 0,E="percentile_disc"===I||"percentile_cont"===I,R="EnvelopeAggregate"===I||"CentroidAggregate"===I||"ConvexHullAggregate"===I,F=v&&1===m&&(S===y||g)&&"count"===I,!v){e.next=19;break}if(!u.has(S)){w=[],A=(0,i.Z)(h);try{for(A.s();!(Z=A.n()).done;)N=Z.value,V=this._getAttributeValues(c,N,a),w.push(V)}catch(q){A.e(q)}finally{A.f()}u.set(S,this._calculateUniqueValues(w,c.returnDistinctValues))}C=u.get(S),P=o.mark((function e(t){var r,n,i,s,u,f,p,m,v,y,g,x,_;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=C[t],n=r.count,i=r.data,s=r.items,u=r.itemPositions,f=i.join(","),d&&!c.validateItems(s,d)){e.next=17;break}if(p=l.get(f)||{attributes:{}},!R){e.next=13;break}return p.aggregateGeometries||(p.aggregateGeometries={}),e.next=7,L._getAggregateGeometry(T,s);case 7:m=e.sent,v=m.aggregateGeometries,y=m.outStatisticFieldName,p.aggregateGeometries[y]=v,e.next=16;break;case 13:g=null,F?g=n:(x=L._getAttributeValues(c,S,a),_=u.map((function(e){return x[e]})),g=E&&"statisticParameters"in T?L._getPercentileValue(T,_):L._getStatisticValue(T,_,null,c.returnDistinctValues)),p.attributes[k]=g;case 16:h.forEach((function(e,t){return p.attributes[L.fieldsIndex.get(e)?e:"EXPR_".concat(t+1)]=i[t]})),l.set(f,p);case 17:case"end":return e.stop()}}),e)})),e.t0=o.keys(C);case 12:if((e.t1=e.t0()).done){e.next=17;break}return M=e.t1.value,e.delegateYield(P(M),"t2",15);case 15:e.next=12;break;case 17:e.next=31;break;case 19:if(!R){e.next=29;break}return r.aggregateGeometries||(r.aggregateGeometries={}),e.next=23,this._getAggregateGeometry(T,this.items);case 23:O=e.sent,G=O.aggregateGeometries,Q=O.outStatisticFieldName,r.aggregateGeometries[Q]=G,e.next=31;break;case 29:z=this._getAttributeValues(c,S,a),r.attributes[k]=E&&"statisticParameters"in T?this._getPercentileValue(T,z):this._getStatisticValue(T,z,s,c.returnDistinctValues);case 31:n.push({name:k,alias:k,type:"esriFieldTypeDouble"});case 32:e.next=4;break;case 34:e.next=39;break;case 36:e.prev=36,e.t3=e.catch(2),x.e(e.t3);case 39:return e.prev=39,x.f(),e.finish(39);case 42:return D=v?Array.from(l.values()):[r],e.abrupt("return",(this._sortFeatures(D,p,(function(e,t){return e.attributes[t]})),{fields:n,features:D}));case 44:case"end":return e.stop()}}),e,this,[[2,36,39,42]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_getAggregateGeometry",value:function(){var e=(0,a.Z)(o.mark((function e(t,i){var a,s,u,l,c,f,h,d,p,m,v,y,g;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9058),r.e(309)]).then(r.bind(r,50309));case 2:return a=e.sent,s=t.statisticType,u=t.outStatisticFieldName,l=this.featureAdapter,c=this.spatialReference,f=this.geometryType,h=this.hasZ,d=this.hasM,p=i.map((function(e){return(0,j.Op)(f,h,d,l.getGeometry(e))})),m=a.convexHull(c,p,!0)[0],v={aggregateGeometries:null,outStatisticFieldName:null},"EnvelopeAggregate"===s?(y=m?(0,Q._w)(m):(0,Q.aO)(a.union(c,p)),v.aggregateGeometries=(0,n.Z)((0,n.Z)({},y),{},{spatialReference:c}),v.outStatisticFieldName=u||"extent"):"CentroidAggregate"===s?(g=m?(0,G.tO)(m):(0,G.$G)((0,Q.aO)(a.union(c,p))),v.aggregateGeometries={x:g[0],y:g[1],spatialReference:c},v.outStatisticFieldName=u||"centroid"):"ConvexHullAggregate"===s&&(v.aggregateGeometries=m,v.outStatisticFieldName=u||"convexHull"),e.abrupt("return",v);case 15:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_getStatisticValue",value:function(e,t,r,n){var i,a=e.onStatisticField,s=e.statisticType;return i=null!=r&&r.has(a)?r.get(a):(0,B.qN)(this.fieldsIndex.get(a))?(0,L.H0)({values:t,returnDistinct:n}):(0,L.i5)({values:t,minValue:null,maxValue:null,useSampleStdDev:!0}),r&&r.set(a,i),i["var"===s?"variance":s]}},{key:"_getPercentileValue",value:function(e,t){var r=e.onStatisticField,n=e.statisticParameters,i=e.statisticType,a=n.value,s=n.orderBy,u=this.fieldsIndex.get(r),o={value:a,orderBy:s,fieldType:null==u?void 0:u.type,isDiscrete:"percentile_disc"===i};return(0,L.XL)(t,o)}},{key:"_getAttributeValues",value:function(e,t,r){if(r.has(t))return r.get(t);var n=this.fieldsIndex.get(t),i=this.items.map((function(r){return e.getFieldValue(r,t,n)}));return r.set(t,i),i}},{key:"_getAttributeNormalizedValues",value:function(e,t){var r=this;return this.items.map((function(n){return e.getNormalizedValue(n,{field:t.field,fieldInfo:r.fieldsIndex.get(t.field),normalizationField:t.normalizationField,normalizationFieldInfo:r.fieldsIndex.get(t.normalizationField),normalizationType:t.normalizationType,normalizationTotal:t.normalizationTotal})}))}},{key:"_getAttributeExpressionValues",value:function(){var e=(0,a.Z)(o.mark((function e(t,r,n){var i,a,s,u;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Y.LC)();case 2:return i=e.sent,a=i.arcadeUtils,s=a.createFunction(r),u=n&&a.getViewInfo(n),e.abrupt("return",this.items.map((function(e){return t.getExpressionValue(e,{compiledFunc:s,viewInfo:u},a)})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_calculateUniqueValues",value:function(e,t){for(var r={},n=this.items,a=n.length,s=0;s<a;s++){var u,o=n[s],l=[],c=(0,i.Z)(e);try{for(c.s();!(u=c.n()).done;){var f=u.value;l.push(f[s])}}catch(d){c.e(d)}finally{c.f()}var h=l.join(",");t?null==r[h]&&(r[h]={count:1,data:l,items:[o],itemPositions:[s]}):null==r[h]?r[h]={count:1,data:l,items:[o],itemPositions:[s]}:(r[h].count++,r[h].items.push(o),r[h].itemPositions.push(s))}return r}},{key:"_getDataValues",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){var n,i,a,s,u,l,c,f;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new U(t,this.featureAdapter,this.fieldsIndex),i=r.valueExpression,a=r.field,s=r.normalizationField,u=r.normalizationType,l=r.normalizationTotal,c=r.scale,f=i?{viewingMode:"map",scale:c,spatialReference:t.outSR||this.spatialReference}:null,e.abrupt("return",i?this._getAttributeExpressionValues(n,i,f):this._getAttributeNormalizedValues(n,{field:a,normalizationField:s,normalizationType:u,normalizationTotal:l}));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}();function W(e,t,r,n,i,a){var s=i-r,u=a-n,o=s*s+u*u,l=(e-r)*s+(t-n)*u,c=Math.min(1,Math.max(0,l/o));return{x:r+s*c,y:n+u*c}}!function(e){e[e.NONE=0]="NONE",e[e.EDGE=1]="EDGE",e[e.VERTEX=2]="VERTEX"}(P||(P={}));var X=r(77095),J=r(52410),$=r(97326),K=r(60136),ee=r(29388),te=r(27366),re=r(85015),ne=r(100),ie=r(32718),ae=r(90941),se=r(27546),ue=r(75298),oe=r(94172),le=r(38499),ce=r(49861),fe=(r(63780),r(93169),r(25243),r(69912)),he=function(e){(0,K.Z)(r,e);var t=(0,ee.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments))._tasks=new Array,e.running=!1,e}return(0,s.Z)(r,[{key:"length",get:function(){return this._tasks.length}},{key:"destroy",value:function(){this.cancelAll()}},{key:"runTask",value:function(e){for(;!e.done&&this._process(e);)e.madeProgress()}},{key:"push",value:function(e,t,r){var n=this;return this.running=!0,new Promise((function(i,a){return n._tasks.push(new de(i,a,e,t,r))}))}},{key:"unshift",value:function(e,t,r){var n=this;return this.running=!0,new Promise((function(i,a){return n._tasks.unshift(new de(i,a,e,t,r))}))}},{key:"_process",value:function(e){if(0===this._tasks.length)return!1;var t=this._tasks.shift();try{var r=(0,ue.Hc)(t.signal);if(r&&!t.abortCallback)t.reject((0,ue.zE)());else{var n=r?t.abortCallback((0,ue.zE)()):t.callback(e);(0,ue.y8)(n)?n.then(t.resolve,t.reject):t.resolve(n)}}catch(I){t.reject(I)}return this.running=this._tasks.length>0,!0}},{key:"cancelAll",value:function(){var e,t=(0,ue.zE)(),r=(0,i.Z)(this._tasks);try{for(r.s();!(e=r.n()).done;){var n=e.value;if(n.abortCallback){var a=n.abortCallback(t);n.resolve(a)}else n.reject(t)}}catch(s){r.e(s)}finally{r.f()}this._tasks.length=0,this.running=!1}}]),r}(re.Z);(0,te._)([(0,ce.Cb)()],he.prototype,"running",void 0),he=(0,te._)([(0,fe.j)("esri.layers.support.PromiseQueue")],he);var de=(0,s.Z)((function e(t,r,n,i,a){(0,u.Z)(this,e),this.resolve=t,this.reject=r,this.callback=n,this.signal=i,this.abortCallback=a})),pe=function(e){(0,K.Z)(r,e);var t=(0,ee.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments)).SCHEDULER_LOG_SLOW_TASKS=!1,e.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1,e}return(0,s.Z)(r)}(re.Z);(0,te._)([(0,ce.Cb)()],pe.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),(0,te._)([(0,ce.Cb)()],pe.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);var me,ve=new(pe=(0,te._)([(0,fe.j)("esri.views.support.DebugFlags")],pe)),ye=ie.Z.getLogger("esri.views.support.Scheduler");!function(e){e.RESOURCE_CONTROLLER="schedule",e.SLIDE="slide",e.STREAM_DATA_LOADER="stream loader",e.ELEVATION_QUERY="elevation query",e.TERRAIN_SURFACE="terrain",e.SURFACE_GEOMETRY_UPDATES="surface geometry updates",e.GRAPHICS_CORE="Graphics3D",e.I3S_CONTROLLER="I3S",e.POINT_CLOUD_LAYER="point cloud",e.FEATURE_TILE_FETCHER="feature fetcher",e.OVERLAY="overlay",e.STAGE="stage",e.GRAPHICS_DECONFLICTOR="graphics deconflictor",e.FILTER_VISIBILITY="Graphics3D filter visibility",e.SCALE_VISIBILITY="Graphics3D scale visibility",e.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",e.POINT_OF_INTEREST_FREQUENT="POI frequent",e.POINT_OF_INTEREST_INFREQUENT="POI infrequent",e.LABELER="labeler",e.FEATURE_QUERY_ENGINE="feature query",e.FEATURE_TILE_TREE="feature tile tree",e.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",e.ELEVATION_ALIGNMENT="elevation alignment",e.TEXT_TEXTURE_ATLAS="text texture atlas",e.TEXTURE_UNLOAD="texture unload",e.LINE_OF_SIGHT_TOOL="line of sight tool",e.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",e.ELEVATION_PROFILE="elevation profile",e.SNAPPING="snapping",e.SHADOW_ACCUMULATOR="shadow accumulator",e.CLOUDS_GENERATOR="cloud generator",e[e.TEST_PRIO=1]="TEST_PRIO"}(me||(me={}));var ge,xe=new Map([[me.RESOURCE_CONTROLLER,0],[me.SLIDE,0],[me.STREAM_DATA_LOADER,0],[me.ELEVATION_QUERY,0],[me.TERRAIN_SURFACE,1],[me.SURFACE_GEOMETRY_UPDATES,1],[me.GRAPHICS_CORE,2],[me.I3S_CONTROLLER,2],[me.POINT_CLOUD_LAYER,2],[me.FEATURE_TILE_FETCHER,2],[me.OVERLAY,4],[me.STAGE,4],[me.GRAPHICS_DECONFLICTOR,4],[me.FILTER_VISIBILITY,4],[me.SCALE_VISIBILITY,4],[me.FRUSTUM_VISIBILITY,4],[me.POINT_OF_INTEREST_FREQUENT,6],[me.POINT_OF_INTEREST_INFREQUENT,30],[me.LABELER,8],[me.FEATURE_QUERY_ENGINE,8],[me.FEATURE_TILE_TREE,16],[me.FEATURE_TILE_TREE_ACTIVE,0],[me.ELEVATION_ALIGNMENT,12],[me.TEXT_TEXTURE_ATLAS,12],[me.CLOUDS_GENERATOR,12],[me.TEXTURE_UNLOAD,12],[me.LINE_OF_SIGHT_TOOL,16],[me.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[me.SNAPPING,0],[me.SHADOW_ACCUMULATOR,30]]);function _e(e){return xe.has(e)?xe.get(e):"number"==typeof e?e:1}!function(e){e[e.ANIMATING=0]="ANIMATING",e[e.INTERACTING=1]="INTERACTING",e[e.IDLE=2]="IDLE"}(ge||(ge={}));var be,ke,Ie=(0,le.HA)(6.5),Te=(0,le.HA)(1),Se=(0,le.HA)(30),Ee=(0,le.HA)(1e3/30),Re=(0,le.HA)(100);!function(e){var t=function(e){(0,K.Z)(i,e);var t=(0,ee.Z)(i);function i(e){var r,a;(0,u.Z)(this,i),(r=t.call(this,e)).updating=!0,r._microTaskQueued=!1,r.performanceInfo={total:new ae.Z("total"),tasks:new Map},r._frameTaskTimes=new Map,r._budget=null,r._state=ge.INTERACTING,r._tasks=new se.Z,r._runQueue=new se.Z,r._load=0,r._idleStateCallbacks=new se.Z,r._idleUpdatesStartFired=!1,r._maxReschedule=Ze,r._forceTask=!1,r._debug=!1,r._debugHandle=(0,oe.YP)((function(){return ve.SCHEDULER_LOG_SLOW_TASKS}),(function(e){return r._debug=e}),oe.nn),r._budget=new n(e.nowFunc);for(var s=0,o=Object.keys(me);s<o.length;s++){var l=o[s];r.performanceInfo.tasks.set(me[l],new ae.Z(me[l]))}var c=(0,$.Z)(r);return r._test={get state(){return(0,f.Pt)(a,c._state)},set state(e){a=e},FRAME_SAFETY_BUDGET:Ie,INTERACTING_BUDGET:Ee,IDLE_BUDGET:Re,get budget(){return c._budget.budget},usedBudget:0,setBudget:function(e){return c._budget=e},updateTask:function(e){return r._updateTask(e)},getState:function(e){return r._getState(e)},getRuntime:function(e){return r._getRuntime(e)},frameTaskTimes:r._frameTaskTimes,resetRuntimes:function(){return r._resetRuntimes()},getRunning:function(){return r._getRunning()}},r}return(0,s.Z)(i,[{key:"destroy",value:function(){this._tasks.toArray().forEach((function(e){return e.remove()})),this._tasks.clear(),(0,f.hw)(this._debugHandle),this._microTaskQueued=!1,this.updating=!1}},{key:"activate",value:function(){var e=this;this._budget.done||this._microTaskQueued||(this._microTaskQueued=!0,queueMicrotask((function(){e._microTaskQueued&&(e._microTaskQueued=!1,e._budget.done||(e._maxReschedule=Ze,e._schedule(),e.frame()))})))}},{key:"registerTask",value:function(e,t){var n=_e(e),i=new r(this,e,t,n);return this._tasks.push(i),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new ae.Z(e)),i}},{key:"registerIdleStateCallbacks",value:function(e,t){var r=this,n={idleBegin:e,idleEnd:t};this._idleStateCallbacks.push(n),this.state===ge.IDLE&&this._idleUpdatesStartFired&&n.idleBegin();var i=this;return{remove:function(){return r._removeIdleStateCallbacks(n)},set idleBegin(e){i._idleUpdatesStartFired&&(n.idleEnd(),i._state===ge.IDLE&&e()),n.idleBegin=e},set idleEnd(e){n.idleEnd=e}}}},{key:"now",get:function(){return this.nowFunc()}},{key:"load",get:function(){return this._load}},{key:"state",get:function(){return(0,f.Wi)(this._test.state)?this._state:this._test.state},set:function(e){this._state!==e&&(this._state=e,this.state!==ge.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((function(e){return e.idleEnd()}))))}},{key:"updateBudget",value:function(e){this._test.usedBudget=0;var t=Ie,r=e.frameDuration,n=Te;switch(this.state){case ge.IDLE:t=(0,le.HA)(0),r=(0,le.HA)(Math.max(Re,e.frameDuration)),n=Se;break;case ge.INTERACTING:r=(0,le.HA)(Math.max(Ee,e.frameDuration));case ge.ANIMATING:}return r=(0,le.HA)(r-e.elapsedFrameTime-t),this.state!==ge.IDLE&&r<Te&&!this._forceTask?(this._forceTask=!0,!1):(r=(0,le.HA)(Math.max(r,n)),this._budget.reset(r,this.state),this._maxReschedule=Ze,this._updateLoad(),this._schedule())}},{key:"frame",value:function(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case ge.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((function(e){return e.idleBegin()}))),this._runIdle();break;case ge.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}},{key:"stopFrame",value:function(){this._budget.reset((0,le.HA)(0),this._state),this._budget.madeProgress()}},{key:"_removeIdleStateCallbacks",value:function(e){this._idleUpdatesStartFired&&e.idleEnd(),this._idleStateCallbacks.removeUnordered(e)}},{key:"removeTask",value:function(e){this._tasks.removeUnordered(e),this._runQueue.removeUnordered(e)}},{key:"_updateTask",value:function(e){this._tasks.forAll((function(t){t.name===e&&t.setPriority(e)}))}},{key:"_getState",value:function(e){if(this._runQueue.some((function(t){return t.name===e})))return ke.SCHEDULED;var t=ke.IDLE;return this._tasks.forAll((function(r){r.name===e&&r.needsUpdate&&(r.schedulePriority<=1?t=ke.READY:t!==ke.READY&&(t=ke.WAITING))})),t}},{key:"_getRuntime",value:function(e){var t=0;return this._tasks.forAll((function(r){r.name===e&&(t+=r.runtime)})),t}},{key:"_resetRuntimes",value:function(){this._tasks.forAll((function(e){return e.runtime=0}))}},{key:"_getRunning",value:function(){var e=new Map;if(this._tasks.forAll((function(t){t.needsUpdate&&e.set(t.name,(e.get(t.name)||0)+1)})),0===e.size)return null;var t="";return e.forEach((function(e,r){t+=e>1?" ".concat(e,"x ").concat(r):" ".concat(r)})),t}},{key:"_runIdle",value:function(){this._run()}},{key:"_runInteracting",value:function(){this._run()}},{key:"_runAnimating",value:function(){this._run()}},{key:"_updateLoad",value:function(){var e=this._tasks.reduce((function(e,t){return t.needsUpdate?++e:e}),0);this._load=.9*this._load+e*(1-.9)}},{key:"_schedule",value:function(){var e=this;if(this._maxReschedule<=0)return!1;var t=function(){var t=!1,r=0;if(e._tasks.forAll((function(n){n.needsUpdate&&0!==n.schedulePriority&&0!==n.basePriority&&(t=!0,r=Math.max(r,n.basePriority),1===n.schedulePriority?(n.schedulePriority=0,e._runQueue.push(n)):--n.schedulePriority)})),!t)return{v:(e.updating=!1,!1)};e._maxReschedule===Ze&&(e._maxReschedule=r),--e._maxReschedule};for(this._runQueue.filterInPlace((function(e){return!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1)})),this._tasks.forAll((function(t){0===t.basePriority&&t.needsUpdate&&!e._runQueue.some((function(e){return e===t}))&&e._runQueue.unshift(t)}));0===this._runQueue.length;){var r=t();if("object"===typeof r)return r.v}return this.updating=!0,!0}},{key:"_run",value:function(){var e=this._budget.now();this._startFrameTaskTimes();do{for(;this._runQueue.length>0;){var t=this._budget.now(),r=this._runQueue.pop();this._budget.resetProgress();try{r.task.runTask(this._budget)}catch(E){ye.error('Exception in task "'.concat(r.name,'"'),E)}r.schedulePriority=r.basePriority;var n=this._budget.now()-t;if(r.runtime+=n,this._frameTaskTimes.set(r.priority,this._frameTaskTimes.get(r.priority)+n),this._debug&&this._budget.elapsed>2*this._budget.budget&&console.log("Task",r.name,"used",this._budget.elapsed,"of max",this._budget.budget,"ms"),this._budget.remaining<=0)return this.updating=this._tasks.some((function(e){return e.needsUpdate})),void this._recordFrameTaskTimes(this._budget.now()-e)}}while(this._schedule());this.updating=this._tasks.some((function(e){return e.needsUpdate})),this._recordFrameTaskTimes(this._budget.now()-e)}},{key:"_startFrameTaskTimes",value:function(){for(var e=0,t=Object.keys(me);e<t.length;e++){var r=t[e];this._frameTaskTimes.set(me[r],0)}}},{key:"_recordFrameTaskTimes",value:function(e){var t=this;this._frameTaskTimes.forEach((function(e,r){return t.performanceInfo.tasks.get(r).record(e)})),this.performanceInfo.total.record(e)}},{key:"test",get:function(){return this._test}}]),i}(re.Z);(0,te._)([(0,ce.Cb)()],t.prototype,"updating",void 0),(0,te._)([(0,ce.Cb)()],t.prototype,"nowFunc",void 0),t=(0,te._)([(0,fe.j)("esri.views.support.Scheduler")],t),e.Scheduler=t;var r=function(e){(0,K.Z)(r,e);var t=(0,ee.Z)(r);function r(e,n,i,a){var s;return(0,u.Z)(this,r),(s=t.call(this,{}))._scheduler=e,s.name=n,s._basePriority=a,s.runtime=0,s._queue=new he,s._handles=new ne.Z,s.schedulePriority=s._basePriority,s.task=(0,f.pC)(i)?i:s._queue,s._handles.add((0,oe.gx)((function(){return s.task.running}),(function(){return e.activate()}))),s}return(0,s.Z)(r,[{key:"updating",get:function(){return this._queue.running}},{key:"normalizeCtorArgs",value:function(){return{}}},{key:"remove",value:function(){this.processQueue(Fe),this._scheduler.removeTask(this),this.schedule=Ae.schedule,this.reschedule=Ae.reschedule,this._handles.destroy()}},{key:"basePriority",get:function(){return this._basePriority}},{key:"setPriority",value:function(e){this.name=e;var t=_e(e);0!==this._basePriority&&0===this.schedulePriority||(this.schedulePriority=t),this._basePriority=t}},{key:"priority",get:function(){return this.name},set:function(e){this.setPriority(e)}},{key:"needsUpdate",get:function(){return this.updating||this.task.running}},{key:"schedule",value:function(e,t,r){return this._queue.push(e,t,r)}},{key:"reschedule",value:function(e,t,r){return this._queue.unshift(e,t,r)}},{key:"processQueue",value:function(e){this._queue.runTask(e)}}]),r}(re.Z);(0,te._)([(0,ce.Cb)({constructOnly:!0})],r.prototype,"task",void 0),(0,te._)([(0,ce.Cb)({readOnly:!0})],r.prototype,"updating",null),r=(0,te._)([(0,fe.j)("esri.views.support.SchedulerTask")],r);var n=function(){function e(t){(0,u.Z)(this,e),this.now=t,this._begin=0,this._budget=0,this._state=ge.IDLE,this._didWork=!1,this._enabled=!0}return(0,s.Z)(e,[{key:"run",value:function(e){return!this.done&&(!0===e()&&(this._didWork=!0),!0)}},{key:"done",get:function(){return this._didWork&&this.elapsed>=this._budget&&this._enabled}},{key:"budget",get:function(){return this._budget}},{key:"madeProgress",value:function(){this._didWork=!0}},{key:"state",get:function(){return this._state}},{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled=e}},{key:"reset",value:function(e,t){this._begin=this.now(),this._budget=e,this._state=t,this._didWork=!1}},{key:"remaining",get:function(){return Math.max(this._budget-this.elapsed,0)}},{key:"elapsed",get:function(){return this.now()-this._begin}},{key:"resetProgress",value:function(){this._didWork=!1}},{key:"hasProgressed",get:function(){return this._didWork}}]),e}();e.Budget=n}(be||(be={})),function(e){e.SCHEDULED="s",e.READY="r",e.WAITING="w",e.IDLE="i"}(ke||(ke={}));var Fe=function(){var e=new be.Budget((function(){return performance.now()}));return e.enabled=!1,e}(),we=function(){function e(){(0,u.Z)(this,e)}return(0,s.Z)(e,[{key:"remove",value:function(){}},{key:"processQueue",value:function(){}},{key:"schedule",value:function(e,t,r){try{if((0,ue.Hc)(t)){var n=(0,ue.zE)();return r?Promise.resolve(r(n)):Promise.reject(n)}return(0,ue.gx)(e(Fe))}catch(R){return Promise.reject(R)}}},{key:"reschedule",value:function(e,t,r){return this.schedule(e,t,r)}}]),e}(),Ae=new we,Ze=Number.MAX_SAFE_INTEGER;function Ne(e){return e.every((function(e){return"exceedslimit"!==e.statisticType}))}var Ve="feature-store:unsupported-query",Ce=new Set,Pe=new h.WJ(2e6),Me=0,Oe=function(){function e(t){var r=this;(0,u.Z)(this,e),this.capabilities={query:O.g},this.geometryType=t.geometryType,this.hasM=t.hasM,this.hasZ=t.hasZ,this.objectIdField=t.objectIdField,this.spatialReference=t.spatialReference,this.definitionExpression=t.definitionExpression,this.featureStore=t.featureStore,this.aggregateAdapter=t.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",(function(){return r.clearCache()})),this.timeInfo=t.timeInfo,t.cacheSpatialQueries&&(this._geometryQueryCache=new h.Xq(Me+++"$$",Pe)),this.fieldsIndex=new J.Z(t.fields),t.scheduler&&t.priority&&(this._frameTask=t.scheduler.registerTask(t.priority))}return(0,s.Z)(e,[{key:"destroy",value:function(){this._frameTask=(0,f.hw)(this._frameTask),this.clearCache(),(0,f.SC)(this._geometryQueryCache),this._changeHandle=(0,f.hw)(this._changeHandle),(0,f.SC)(this.fieldsIndex)}},{key:"featureAdapter",get:function(){return this.featureStore.featureAdapter}},{key:"fullExtent",get:function(){var e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:(0,j.S2)(this.spatialReference)}:null}},{key:"timeExtent",get:function(){return this.timeInfo?(this._timeExtent||(this._timeExtent=(0,q.R)(this.timeInfo,this.featureStore)),this._timeExtent):null}},{key:"clearCache",value:function(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}},{key:"executeQuery",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,i,a=this,s=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=s.length>1?s[1]:void 0,i=(0,c.d9)(t),e.prev=3,e.next=6,this._schedule((function(){return(0,j.Up)(i,a.definitionExpression,a.spatialReference)}),r);case 6:return i=e.sent,e.next=9,this._reschedule((function(){return a._checkQuerySupport(i)}),r);case 9:return i=e.sent,e.next=12,this._reschedule((function(){return a._executeGeometryQuery(i,r)}),r);case 12:return n=e.sent,e.next=15,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 15:return n=e.sent,e.next=18,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 18:return n=e.sent,e.next=21,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 21:return n=e.sent,e.next=24,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 24:n=e.sent,e.next=32;break;case 27:if(e.prev=27,e.t0=e.catch(3),e.t0===j.vF){e.next=31;break}throw e.t0;case 31:n=new H([],null,this);case 32:return e.abrupt("return",n.createQueryResponse(i));case 33:case"end":return e.stop()}}),e,this,[[3,27]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForCount",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,i,a=this,s=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=s.length>1?s[1]:void 0,(n=(0,c.d9)(t)).returnGeometry=!1,n.returnCentroid=!1,n.outSR=null,e.prev=4,e.next=7,this._schedule((function(){return(0,j.Up)(n,a.definitionExpression,a.spatialReference)}),r);case 7:return n=e.sent,e.next=10,this._reschedule((function(){return a._checkQuerySupport(n)}),r);case 10:return n=e.sent,e.next=13,this._reschedule((function(){return a._executeGeometryQuery(n,r)}),r);case 13:return i=e.sent,e.next=16,this._reschedule((function(){return i.executeAggregateIdsQuery(n)}),r);case 16:return i=e.sent,e.next=19,this._reschedule((function(){return i.executeObjectIdsQuery(n)}),r);case 19:return i=e.sent,e.next=22,this._reschedule((function(){return i.executeTimeQuery(n)}),r);case 22:return i=e.sent,e.next=25,this._reschedule((function(){return i.executeAttributesQuery(n)}),r);case 25:return i=e.sent,e.abrupt("return",i.createQueryResponseForCount(n));case 29:if(e.prev=29,e.t0=e.catch(4),e.t0===j.vF){e.next=33;break}throw e.t0;case 33:return e.abrupt("return",0);case 34:case"end":return e.stop()}}),e,this,[[4,29]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForExtent",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,i,a,s,u,l,f,h,m,v=this,y=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=y.length>0&&void 0!==y[0]?y[0]:{},r=y.length>1?y[1]:void 0,i=(0,c.d9)(t),a=i.outSR,e.prev=4,e.next=7,this._schedule((function(){return(0,j.Up)(i,v.definitionExpression,v.spatialReference)}),r);case 7:return i=e.sent,e.next=10,this._reschedule((function(){return v._checkQuerySupport(i)}),r);case 10:return(i=e.sent).returnGeometry=!0,i.returnCentroid=!1,i.outSR=null,e.next=16,this._reschedule((function(){return v._executeGeometryQuery(i,r)}),r);case 16:return n=e.sent,e.next=19,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 19:return n=e.sent,e.next=22,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 22:return n=e.sent,e.next=25,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 25:return n=e.sent,e.next=28,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 28:if(n=e.sent,s=n.size){e.next=32;break}return e.abrupt("return",{count:s,extent:null});case 32:return(0,p.t8)(Qe,p.Gv),this.featureStore.forEachBounds(n.items,(function(e){return(0,p.TC)(Qe,e)}),Ge),u={xmin:Qe[0],ymin:Qe[1],xmax:Qe[3],ymax:Qe[4],spatialReference:(0,j.S2)(this.spatialReference)},this.hasZ&&isFinite(Qe[2])&&isFinite(Qe[5])&&(u.zmin=Qe[2],u.zmax=Qe[5]),(l=(0,M.iV)(u,n.spatialReference,a)).spatialReference=(0,j.S2)(a||this.spatialReference),l.xmax-l.xmin==0&&(f=(0,d.c9)(l.spatialReference),l.xmin-=f,l.xmax+=f),l.ymax-l.ymin==0&&(h=(0,d.c9)(l.spatialReference),l.ymin-=h,l.ymax+=h),this.hasZ&&null!=l.zmin&&null!=l.zmax&&l.zmax-l.zmin==0&&(m=(0,d.c9)(l.spatialReference),l.zmin-=m,l.zmax+=m),e.abrupt("return",{count:s,extent:l});case 42:if(e.prev=42,e.t0=e.catch(4),e.t0!==j.vF){e.next=46;break}return e.abrupt("return",{count:0,extent:null});case 46:throw e.t0;case 47:case"end":return e.stop()}}),e,this,[[4,42]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForIds",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},r=n.length>1?n[1]:void 0,e.abrupt("return",this.executeQueryForIdSet(t,r).then((function(e){return Array.from(e)})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForIdSet",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,a,s,u,l=this,f=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.length>0&&void 0!==f[0]?f[0]:{},r=f.length>1?f[1]:void 0,(a=(0,c.d9)(t)).returnGeometry=!1,a.returnCentroid=!1,a.outSR=null,e.prev=4,e.next=7,this._schedule((function(){return(0,j.Up)(a,l.definitionExpression,l.spatialReference)}),r);case 7:return a=e.sent,e.next=10,this._reschedule((function(){return l._checkQuerySupport(a)}),r);case 10:return a=e.sent,e.next=13,this._reschedule((function(){return l._executeGeometryQuery(a,r)}),r);case 13:return n=e.sent,e.next=16,this._reschedule((function(){return n.executeAggregateIdsQuery(a)}),r);case 16:return n=e.sent,e.next=19,this._reschedule((function(){return n.executeObjectIdsQuery(a)}),r);case 19:return n=e.sent,e.next=22,this._reschedule((function(){return n.executeTimeQuery(a)}),r);case 22:return n=e.sent,e.next=25,this._reschedule((function(){return n.executeAttributesQuery(a)}),r);case 25:return n=e.sent,s=n.items,u=new Set,e.next=29,this._reschedule((function(){var e,t=(0,i.Z)(s);try{for(t.s();!(e=t.n()).done;){var r=e.value;u.add(n.featureAdapter.getObjectId(r))}}catch(a){t.e(a)}finally{t.f()}}),r);case 29:return e.abrupt("return",u);case 32:if(e.prev=32,e.t0=e.catch(4),e.t0!==j.vF){e.next=36;break}return e.abrupt("return",new Set);case 36:throw e.t0;case 37:case"end":return e.stop()}}),e,this,[[4,32]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForSnapping",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){var i,a,s,u,l,c,h,d,p,m,v,_,b,k,I=this;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.point,a=t.distance,t.types!==P.NONE){e.next=3;break}return e.abrupt("return",{candidates:[]});case 3:return e.next=5,this._reschedule((function(){return I._checkQuerySupport(t.query)}),r);case 5:if(s=e.sent,u=!(0,x.fS)(i.spatialReference,this.spatialReference),e.t0=u,!e.t0){e.next=11;break}return e.next=11,(0,M._W)(i.spatialReference,this.spatialReference);case 11:if(l="number"==typeof a?a:a.x,c="number"==typeof a?a:a.y,h={xmin:i.x-l,xmax:i.x+l,ymin:i.y-c,ymax:i.y+c,spatialReference:i.spatialReference},d=u?(0,M.iV)(h,this.spatialReference):h){e.next=14;break}return e.abrupt("return",{candidates:[]});case 14:return e.next=16,(0,g.aX)((0,y.im)(i),null,{signal:r});case 16:return p=e.sent[0],e.next=19,(0,g.aX)((0,y.im)(d),null,{signal:r});case 19:if(m=e.sent[0],!(0,f.Wi)(p)&&!(0,f.Wi)(m)){e.next=22;break}return e.abrupt("return",{candidates:[]});case 22:return v=new H(this._searchFeatures(this._getQueryBBoxes(m.toJSON())),null,this),e.next=25,this._reschedule((function(){return v.executeObjectIdsQuery(s)}),r);case 25:return v=e.sent,e.next=28,this._reschedule((function(){return v.executeTimeQuery(s)}),r);case 28:return v=e.sent,e.next=31,this._reschedule((function(){return v.executeAttributesQuery(s)}),r);case 31:return v=e.sent,_=p.toJSON(),b=u?(0,M.iV)(_,this.spatialReference):_,k=u?Math.max(d.xmax-d.xmin,d.ymax-d.ymin)/2:a,e.abrupt("return",v.createSnappingResponse((0,n.Z)((0,n.Z)({},t),{},{point:b,distance:k}),i.spatialReference));case 34:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeQueryForLatestObservations",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,i,a=this,s=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:{},r=s.length>1?s[1]:void 0,this.timeInfo&&this.timeInfo.trackIdField){e.next=4;break}throw new l.Z(Ve,"Missing timeInfo or timeInfo.trackIdField",{query:t,timeInfo:this.timeInfo});case 4:return i=(0,c.d9)(t),e.prev=5,e.next=8,this._schedule((function(){return(0,j.Up)(i,a.definitionExpression,a.spatialReference)}),r);case 8:return i=e.sent,e.next=11,this._reschedule((function(){return a._checkQuerySupport(i)}),r);case 11:return i=e.sent,e.next=14,this._reschedule((function(){return a._executeGeometryQuery(i,r)}),r);case 14:return n=e.sent,e.next=17,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 17:return n=e.sent,e.next=20,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 20:return n=e.sent,e.next=23,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 23:return n=e.sent,e.next=26,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 26:return n=e.sent,e.next=29,this._reschedule((function(){return n.filterLatest()}),r);case 29:n=e.sent,e.next=37;break;case 32:if(e.prev=32,e.t0=e.catch(5),e.t0===j.vF){e.next=36;break}throw e.t0;case 36:n=new H([],null,this);case 37:return e.abrupt("return",n.createQueryResponse(i));case 38:case"end":return e.stop()}}),e,this,[[5,32]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForSummaryStatistics",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,i,a,s,u=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1?u[1]:void 0,n=u.length>2?u[2]:void 0,i=r.field,a=r.normalizationField,s=r.valueExpression,e.next=6,this._getQueryEngineResultForStats(t,{field:i,normalizationField:a,valueExpression:s},n);case 6:return e.abrupt("return",e.sent.createSummaryStatisticsResponse(t,r));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForUniqueValues",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,i,a,s=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=s.length>1?s[1]:void 0,n=s.length>2?s[2]:void 0,i=r.field,a=r.valueExpression,e.next=6,this._getQueryEngineResultForStats(t,{field:i,valueExpression:a},n);case 6:return e.abrupt("return",e.sent.createUniqueValuesResponse(t,r));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForClassBreaks",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,i,a,s,u=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1?u[1]:void 0,n=u.length>2?u[2]:void 0,i=r.field,a=r.normalizationField,s=r.valueExpression,e.next=6,this._getQueryEngineResultForStats(t,{field:i,normalizationField:a,valueExpression:s},n);case 6:return e.abrupt("return",e.sent.createClassBreaksResponse(t,r));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForHistogram",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,i,a,s,u=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1?u[1]:void 0,n=u.length>2?u[2]:void 0,i=r.field,a=r.normalizationField,s=r.valueExpression,e.next=6,this._getQueryEngineResultForStats(t,{field:i,normalizationField:a,valueExpression:s},n);case 6:return e.abrupt("return",e.sent.createHistogramResponse(t,r));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_schedule",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.pC)(this._frameTask)?this._frameTask.schedule(t,r):t(Fe));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_reschedule",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.pC)(this._frameTask)?this._frameTask.reschedule(t,r):t(Fe));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_getAll",value:function(){if(!this._allItems){var e=[];this.featureStore.forEach((function(t){return e.push(t)})),this._allItems=new H(e,null,this)}return this._allItems}},{key:"_executeGeometryQuery",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){var n,s,u,l,c,h,d,p,m,v,y,g,_,b,k,I,T,S,E,R,F,w,A,Z,N,V=this;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.geometry,s=t.outSR,u=t.spatialRel,l=t.returnGeometry,c=t.returnCentroid,h=this.featureStore.featureSpatialReference,d=n&&h&&h!==n.spatialReference?(0,M.iV)(n,h):n,p=l||c,m=(0,x.JY)(s)&&!(0,x.fS)(this.spatialReference,s),!(v=this._geometryQueryCache?m&&p?JSON.stringify({originalFilterGeometry:n,spatialRelationship:u,outSpatialReference:s}):JSON.stringify({originalFilterGeometry:n,spatialRelationship:u}):null)){e.next=5;break}if(y=this._geometryQueryCache.get(v),(0,f.o8)(y)){e.next=5;break}return e.abrupt("return",y);case 5:if(g=function(){var e=(0,a.Z)(o.mark((function e(t){var r;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!m||!p){e.next=5;break}return e.next=3,t.project(s);case 3:return r=e.sent,e.abrupt("return",(v&&V._geometryQueryCache.put(v,r,r.size||1),r));case 5:return e.abrupt("return",(v&&V._geometryQueryCache.put(v,t,t.size||1),t));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d){e.next=8;break}return e.abrupt("return",g(this._getAll()));case 8:if(_=this.featureAdapter,"esriSpatialRelDisjoint"!==u){e.next=22;break}if((b=this._searchFeatures(this._getQueryBBoxes(n))).length){e.next=13;break}return e.abrupt("return",g(this._getAll()));case 13:T=new Set,S=(0,i.Z)(b);try{for(S.s();!(E=S.n()).done;)R=E.value,T.add(_.getObjectId(R))}catch(C){S.e(C)}finally{S.f()}return e.next=18,this._reschedule((function(){var e=0;k=new Array(T.size),V.featureStore.forEach((function(t){return k[e++]=t})),I=T}),r);case 18:return e.next=20,this._reschedule((0,a.Z)(o.mark((function e(){var t,i;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,X.cW)(u,d,V.geometryType,V.hasZ,V.hasM);case 2:return t=e.sent,i=function(e){return!I.has(_.getObjectId(e))||t(_.getGeometry(e))},e.t0=H,e.next=7,V._runSpatialFilter(k,i,r);case 7:return e.t1=e.sent,e.t2=n,e.t3=V,e.abrupt("return",new e.t0(e.t1,e.t2,e.t3));case 11:case"end":return e.stop()}}),e)}))),r);case 20:return F=e.sent,e.abrupt("return",g(F));case 22:if((w=this._searchFeatures(this._getQueryBBoxes(n))).length){e.next=26;break}return A=new H([],n,this),e.abrupt("return",(v&&this._geometryQueryCache.put(v,A,A.size||1),A));case 26:if(!this._canExecuteSoloPass(d,t)){e.next=28;break}return e.abrupt("return",g(new H(w,n,this)));case 28:return e.next=30,(0,X.cW)(u,d,this.geometryType,this.hasZ,this.hasM);case 30:return Z=e.sent,e.next=33,this._runSpatialFilter(w,(function(e){return Z(_.getGeometry(e))}),r);case 33:return N=e.sent,e.abrupt("return",g(new H(N,n,this)));case 35:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_runSpatialFilter",value:function(){var e=(0,a.Z)(o.mark((function e(t,r,n){var i,s,u,l=this;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",t);case 2:if(!(0,f.Wi)(this._frameTask)){e.next=4;break}return e.abrupt("return",t.filter((function(e){return r(e)})));case 4:return i=0,s=new Array,u=function(){var e=(0,a.Z)(o.mark((function e(a){var c;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i<t.length)){e.next=9;break}if(c=t[i++],r(c)&&(s.push(c),a.madeProgress()),e.t0=a.done,!e.t0){e.next=7;break}return e.next=7,l._reschedule((function(e){return u(e)}),n);case 7:e.next=0;break;case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.abrupt("return",this._reschedule((function(e){return u(e)}),n).then((function(){return s})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_canExecuteSoloPass",value:function(e,t){var r=this.geometryType,n=t.spatialRel;return(0,X.hN)(e)&&("esriSpatialRelEnvelopeIntersects"===n||"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===n||"esriSpatialRelContains"===n||"esriSpatialRelWithin"===n))}},{key:"_getQueryBBoxes",value:function(e){if((0,X.hN)(e)){if((0,y.YX)(e))return[(0,m.al)(e.xmin,e.ymin,e.xmax,e.ymax)];if((0,y.oU)(e))return e.rings.map((function(e){return(0,m.al)(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))}))}return[(0,v.$P)((0,m.Ue)(),e)]}},{key:"_searchFeatures",value:function(e){var t,r=(0,i.Z)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.featureStore.forEachInBounds(n,(function(e){Ce.add(e)}))}}catch(u){r.e(u)}finally{r.f()}var a=new Array(Ce.size),s=0;return Ce.forEach((function(e){return a[s++]=e})),Ce.clear(),a}},{key:"_checkStatisticsSupport",value:function(){var e=(0,a.Z)(o.mark((function e(t,r){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text||t.outStatistics||t.groupByFieldsForStatistics||t.having||t.orderByFields)){e.next=2;break}throw new l.Z(Ve,"Unsupported query options",{query:t});case 2:return e.abrupt("return",Promise.all([this._checkAttributesQuerySupport(t),this._checkStatisticsParamsSupport(r),(0,X.P0)(t,this.geometryType,this.spatialReference),(0,M._W)(this.spatialReference,t.outSR)]).then((function(){return t})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_checkStatisticsParamsSupport",value:function(){var e=(0,a.Z)(o.mark((function e(t){var r,n,i;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],!t.valueExpression){e.next=7;break}return e.next=4,(0,Y.LC)();case 4:n=e.sent,i=n.arcadeUtils,r=i.extractFieldNames(t.valueExpression);case 7:if(t.field&&r.push(t.field),t.normalizationField&&r.push(t.normalizationField),r.length){e.next=9;break}throw new l.Z(Ve,"params should have at least a field or valueExpression",{params:t});case 9:Z(this.fieldsIndex,r,"params contains missing fields");case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_checkQuerySupport",value:function(){var e=(0,a.Z)(o.mark((function e(t){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text)){e.next=2;break}throw new l.Z(Ve,"Unsupported query options",{query:t});case 2:return e.abrupt("return",Promise.all([this._checkAttributesQuerySupport(t),this._checkStatisticsQuerySupport(t),(0,X.P0)(t,this.geometryType,this.spatialReference),(0,M._W)(this.spatialReference,t.outSR)]).then((function(){return t})));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_checkAttributesQuerySupport",value:function(e){var t=e.outFields,r=e.orderByFields,n=e.returnDistinctValues,i=e.outStatistics,a=i?i.map((function(e){return e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase()})).filter(Boolean):[];if(r&&r.length>0){var s=" asc",u=" desc",o=r.map((function(e){var t=e.toLowerCase();return t.indexOf(s)>-1?t.split(s)[0]:t.indexOf(u)>-1?t.split(u)[0]:e})).filter((function(e){return-1===a.indexOf(e)}));Z(this.fieldsIndex,o,"orderByFields contains missing fields")}if(t&&t.length>0)Z(this.fieldsIndex,t,"outFields contains missing fields");else if(n)throw new l.Z(Ve,"outFields should be specified for returnDistinctValues",{query:e});F(this.fieldsIndex,e.where)}},{key:"_checkStatisticsQuerySupport",value:function(){var e=(0,a.Z)(o.mark((function e(t){var r,n,a,s,u,c,f,h,d,p,m;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.outStatistics,n=t.groupByFieldsForStatistics,a=t.having,s=n&&n.length,u=r&&r.length,!a){e.next=5;break}if(s&&u){e.next=4;break}throw new l.Z(Ve,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:t});case 4:w(this.fieldsIndex,a,r);case 5:if(!u){e.next=34;break}if(Ne(r)){e.next=8;break}return e.abrupt("return");case 8:c=r.map((function(e){return e.onStatisticField})).filter(Boolean),Z(this.fieldsIndex,c,"onStatisticFields contains missing fields"),s&&Z(this.fieldsIndex,n,"groupByFieldsForStatistics contains missing fields"),f=(0,i.Z)(r),e.prev=11,f.s();case 13:if((h=f.n()).done){e.next=26;break}if(d=h.value,p=d.onStatisticField,"percentile_disc"!==(m=d.statisticType)&&"percentile_cont"!==m||!("statisticParameters"in d)){e.next=22;break}if(d.statisticParameters){e.next=20;break}throw new l.Z(Ve,"statisticParamters should be set for percentile type",{definition:d,query:t});case 20:e.next=24;break;case 22:if("count"===m||!p||!C(p,this.fieldsIndex)){e.next=24;break}throw new l.Z(Ve,"outStatistics contains non-numeric fields",{definition:d,query:t});case 24:e.next=13;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(11),f.e(e.t0);case 31:return e.prev=31,f.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[11,28,31,34]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_getQueryEngineResultForStats",value:function(){var e=(0,a.Z)(o.mark((function e(){var t,r,n,i,a=this,s=arguments;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=s.length>1?s[1]:void 0,n=s.length>2?s[2]:void 0,t=(0,c.d9)(t),e.prev=4,e.next=7,this._schedule((function(){return(0,j.Up)(t,a.definitionExpression,a.spatialReference)}),n);case 7:return t=e.sent,e.next=10,this._reschedule((function(){return a._checkStatisticsSupport(t,r)}),n);case 10:return t=e.sent,e.next=13,this._reschedule((function(){return a._executeGeometryQuery(t,n)}),n);case 13:return i=e.sent,e.next=16,this._reschedule((function(){return i.executeAggregateIdsQuery(t)}),n);case 16:return i=e.sent,e.next=19,this._reschedule((function(){return i.executeObjectIdsQuery(t)}),n);case 19:return i=e.sent,e.next=22,this._reschedule((function(){return i.executeTimeQuery(t)}),n);case 22:return i=e.sent,e.next=25,this._reschedule((function(){return i.executeAttributesQuery(t)}),n);case 25:i=e.sent,e.next=33;break;case 28:if(e.prev=28,e.t0=e.catch(4),e.t0===j.vF){e.next=32;break}throw e.t0;case 32:i=new H([],null,this);case 33:return e.abrupt("return",i);case 34:case"end":return e.stop()}}),e,this,[[4,28]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),Ge=(0,p.Ue)(),Qe=(0,p.Ue)()},60480:function(e,t,r){r.d(t,{g:function(){return n}});var n={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},19995:function(e,t,r){r.d(t,{_W:function(){return g},iV:function(){return k},oj:function(){return S}});var n=r(15671),i=r(43144),a=r(15861),s=r(37762),u=r(70885),o=r(87757),l=r(92026),c=r(52587),f=r(40237),h=r(92975),d=r(81753),p=[0,0];function m(e,t){if(!t)return null;if("x"in t){var r,n,i={x:0,y:0};return r=e(t.x,t.y,p),n=(0,u.Z)(r,2),i.x=n[0],i.y=n[1],null!=t.z&&(i.z=t.z),null!=t.m&&(i.m=t.m),i}if("xmin"in t){var a,s,o,l,c={xmin:0,ymin:0,xmax:0,ymax:0};return a=e(t.xmin,t.ymin,p),s=(0,u.Z)(a,2),c.xmin=s[0],c.ymin=s[1],o=e(t.xmax,t.ymax,p),l=(0,u.Z)(o,2),c.xmax=l[0],c.ymax=l[1],t.hasZ&&(c.zmin=t.zmin,c.zmax=t.zmax,c.hasZ=!0),t.hasM&&(c.mmin=t.mmin,c.mmax=t.mmax,c.hasM=!0),c}return"rings"in t?{rings:v(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:v(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:y(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:void 0}function v(e,t){var r,n=[],i=(0,s.Z)(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;n.push(y(a,t))}}catch(u){i.e(u)}finally{i.f()}return n}function y(e,t){var r,n=[],i=(0,s.Z)(e);try{for(i.s();!(r=i.n()).done;){var a=r.value,u=t(a[0],a[1],[0,0]);n.push(u),a.length>2&&u.push(a[2]),a.length>3&&u.push(a[3])}}catch(o){i.e(o)}finally{i.f()}return n}function g(e,t){return x.apply(this,arguments)}function x(){return(x=(0,a.Z)(o.mark((function e(t,r){var n;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return n=Array.isArray(t)?t.map((function(e){return(0,l.pC)(e.geometry)&&e.geometry.spatialReference})):[t],e.next=5,(0,c.iQ)(n.map((function(e){return{source:e,dest:r}})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var _=m.bind(null,d.hG),b=m.bind(null,d.R6);function k(e,t,r){if(!e)return e;if(r||(r=t,t=e.spatialReference),!(0,h.JY)(t)||!(0,h.JY)(r)||(0,h.fS)(t,r))return e;if((0,d.Q8)(t,r)){var n=(0,h.sS)(r)?_(e):b(e);return n.spatialReference=r,n}return(0,c.oj)(f.N,[e],t,r,null)[0]}var I=function(){function e(){(0,n.Z)(this,e),this._jobs=[],this._timer=null,this._process=this._process.bind(this)}return(0,i.Z)(e,[{key:"push",value:function(){var e=(0,a.Z)(o.mark((function e(t,r,n){var i,a=this;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.length&&r&&n&&!(0,h.fS)(r,n)){e.next=2;break}return e.abrupt("return",t);case 2:return i={geometries:t,inSpatialReference:r,outSpatialReference:n,resolve:null},e.abrupt("return",(this._jobs.push(i),new Promise((function(e){i.resolve=e,null===a._timer&&(a._timer=setTimeout(a._process,10))}))));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_process",value:function(){this._timer=null;var e=this._jobs.shift();if(e){var t=e.geometries,r=e.inSpatialReference,n=e.outSpatialReference,i=e.resolve;(0,d.Q8)(r,n)?(0,h.sS)(n)?i(t.map(_)):i(t.map(b)):i((0,c.oj)(f.N,t,r,n,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}}}]),e}(),T=new I;function S(e,t,r){return T.push(e,t,r)}},77095:function(e,t,r){r.d(t,{hN:function(){return A},P0:function(){return F},cW:function(){return R}});var n=r(37762),i=r(15861),a=r(87757),s=r(10064),u=r(34066),o=r(66504);var l=r(77981),c=r(92975);function f(e,t){return e?t?4:3:t?3:2}function h(e,t,r,n,i,a){var s=f(i,a),u=n.coords,o=n.lengths;if(!o)return!1;for(var l=0,c=0;l<o.length;l++,c+=s)if(!d(e,t,r,u[c],u[c+1]))return!1;return!0}function d(e,t,r,i,a){if(!e)return!1;var s,u=f(t,r),o=e.coords,l=e.lengths,c=!1,h=0,d=(0,n.Z)(l);try{for(d.s();!(s=d.n()).done;){var m=s.value;c=p(c,o,u,h,m,i,a),h+=m*u}}catch(v){d.e(v)}finally{d.f()}return c}function p(e,t,r,n,i,a,s){for(var u=e,o=n,l=n,c=n+i*r;l<c;l+=r){(o=l+r)===c&&(o=n);var f=t[l],h=t[l+1],d=t[o],p=t[o+1];(h<s&&p>=s||p<s&&h>=s)&&f+(s-h)/(p-h)*(d-f)<a&&(u=!u)}return u}var m=r(83406),v=r(80457),y=r(19995),g=r(31904),x="feature-store:unsupported-query",_={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},b={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},k={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},I={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function T(e){return!0===b[e]}function S(e){return!0===k[(0,l.Ji)(e)]}function E(e){return!0===I[e]}function R(e,t,n,i,a){if((0,l.oU)(t)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){var s=(0,m.Uy)(new v.Z,t,!1,!1);return Promise.resolve((function(e){return function(e,t,r,n){return d(e,t,r,n.coords[0],n.coords[1])}(s,!1,!1,e)}))}if((0,l.oU)(t)&&"esriGeometryMultipoint"===n){var c=(0,m.Uy)(new v.Z,t,!1,!1);if("esriSpatialRelContains"===e)return Promise.resolve((function(e){return h(c,!1,!1,e,i,a)}))}if((0,l.YX)(t)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Promise.resolve((function(e){return(0,u.aV)(t,(0,g.Op)(n,i,a,e))}));if((0,l.YX)(t)&&"esriGeometryMultipoint"===n&&"esriSpatialRelContains"===e)return Promise.resolve((function(e){return(0,u.lQ)(t,(0,g.Op)(n,i,a,e))}));if((0,l.YX)(t)&&"esriSpatialRelIntersects"===e){var f=function(e){return"mesh"===e?o.h_:(0,o.IY)(e)}(n);return Promise.resolve((function(e){return f(t,(0,g.Op)(n,i,a,e))}))}return Promise.all([r.e(9058),r.e(309)]).then(r.bind(r,50309)).then((function(r){var s=r[_[e]].bind(null,t.spatialReference,t);return function(e){return s((0,g.Op)(n,i,a,e))}}))}function F(e,t,r){return w.apply(this,arguments)}function w(){return w=(0,i.Z)(a.mark((function e(t,r,n){var i,u;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.spatialRel,!(u=t.geometry)){e.next=11;break}if(T(i)){e.next=4;break}throw new s.Z(x,"Unsupported query spatial relationship",{query:t});case 4:if(!(0,c.JY)(u.spatialReference)||!(0,c.JY)(n)){e.next=11;break}if(S(u)){e.next=7;break}throw new s.Z(x,"Unsupported query geometry type",{query:t});case 7:if(E(r)){e.next=9;break}throw new s.Z(x,"Unsupported layer geometry type",{query:t});case 9:if(!t.outSR){e.next=11;break}return e.abrupt("return",(0,y._W)(t.geometry&&t.geometry.spatialReference,t.outSR));case 11:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}function A(e){if((0,l.YX)(e))return!0;if((0,l.oU)(e)){var t,r=(0,n.Z)(e.rings);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(5!==i.length)return!1;if(i[0][0]!==i[1][0]||i[0][0]!==i[4][0]||i[2][0]!==i[3][0]||i[0][1]!==i[3][1]||i[0][1]!==i[4][1]||i[1][1]!==i[2][1])return!1}}catch(a){r.e(a)}finally{r.f()}return!0}return!1}},20311:function(e,t,r){function n(e,t){if(!e)return null;var r=t.featureAdapter,n=e.startTimeField,i=e.endTimeField,a=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;if(n&&i)t.forEach((function(e){var t=r.getAttribute(e,n),u=r.getAttribute(e,i);null==t||isNaN(t)||(a=Math.min(a,t)),null==u||isNaN(u)||(s=Math.max(s,u))}));else{var u=n||i;t.forEach((function(e){var t=r.getAttribute(e,u);null==t||isNaN(t)||(a=Math.min(a,t),s=Math.max(s,t))}))}return{start:a,end:s}}function i(e,t,r){if(!t||!e)return null;var n=e.startTimeField,i=e.endTimeField;if(!n&&!i)return null;var a=t.start,s=t.end;return null===a&&null===s?null:void 0===a&&void 0===s?function(){return!1}:n&&i?function(e,t,r,n,i){return null!=n&&null!=i?function(a){var s=e.getAttribute(a,t),u=e.getAttribute(a,r);return(null==s||s<=i)&&(null==u||u>=n)}:null!=n?function(t){var i=e.getAttribute(t,r);return null==i||i>=n}:null!=i?function(r){var n=e.getAttribute(r,t);return null==n||n<=i}:void 0}(r,n,i,a,s):function(e,t,r,n){return null!=r&&null!=n&&r===n?function(n){return e.getAttribute(n,t)===r}:null!=r&&null!=n?function(i){var a=e.getAttribute(i,t);return a>=r&&a<=n}:null!=r?function(n){return e.getAttribute(n,t)>=r}:null!=n?function(r){return e.getAttribute(r,t)<=n}:void 0}(r,n||i,a,s)}r.d(t,{R:function(){return n},y:function(){return i}})},31904:function(e,t,r){r.d(t,{EG:function(){return b},Op:function(){return k},S2:function(){return Z},Up:function(){return I},j6:function(){return S},vF:function(){return v}});var n=r(15861),i=r(87757),a=r(43404),s=r(92026),u=r(68860),o=r(94446),l=r(77981),c=r(41862),f=r(92975),h=r(83406),d=r(80457),p=r(19995),m=new a.X({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),v=Object.freeze({}),y=new d.Z,g=new d.Z,x=new d.Z,_={esriGeometryPoint:h.fQ,esriGeometryPolyline:h.J6,esriGeometryPolygon:h.eG,esriGeometryMultipoint:h.Iv};function b(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.hasZ,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.hasM;if((0,s.Wi)(t))return null;var a=e.hasZ&&n,u=e.hasM&&i;if(r){var o=(0,h.Nh)(x,t,e.hasZ,e.hasM,"esriGeometryPoint",r,n,i);return(0,h.fQ)(o,a,u)}return(0,h.fQ)(t,a,u)}function k(e,t,r,n,i,a){var u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:r,l=t&&u,c=r&&o,f=(0,s.pC)(n)?"coords"in n?n:n.geometry:null;if((0,s.Wi)(f))return null;if(i){var d=(0,h.zj)(g,f,t,r,e,i,u,o);return a&&(d=(0,h.Nh)(x,d,l,c,e,a)),_[e](d,l,c)}if(a){var p=(0,h.Nh)(x,f,t,r,e,a,u,o);return _[e](p,l,c)}return(0,h.hY)(y,f,t,r,u,o),_[e](y,l,c)}function I(e,t,r){return T.apply(this,arguments)}function T(){return(T=(0,n.Z)(i.mark((function e(t,r,n){var a,s,u,o,l,c,f,h;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.outFields,s=t.orderByFields,u=t.groupByFieldsForStatistics,o=t.outStatistics,a)for(l=0;l<a.length;l++)a[l]=a[l].trim();if(s)for(c=0;c<s.length;c++)s[c]=s[c].trim();if(u)for(f=0;f<u.length;f++)u[f]=u[f].trim();if(o)for(h=0;h<o.length;h++)o[h].onStatisticField&&(o[h].onStatisticField=o[h].onStatisticField.trim());return e.abrupt("return",(t.geometry&&!t.outSR&&(t.outSR=t.geometry.spatialReference),S(t,r,n)));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t,r){return E.apply(this,arguments)}function E(){return(E=(0,n.Z)(i.mark((function e(t,r,n){var a,u,f,h,d,m;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if(a=t.where,t.where=a=a&&a.trim(),(!a||/^1 *= *1$/.test(a)||r&&r===a)&&(t.where=null),t.geometry){e.next=5;break}return e.abrupt("return",t);case 5:return e.next=7,R(t);case 7:return u=e.sent,t.distance=0,t.units=null,"esriSpatialRelEnvelopeIntersects"===t.spatialRel&&(f=t.geometry.spatialReference,(u=(0,o.aO)(u)).spatialReference=f),t.geometry=u,e.next=12,(0,p._W)(u.spatialReference,n);case 12:return e.next=14,(0,c.aX)((0,l.im)(u));case 14:if(h=e.sent[0],!(0,s.Wi)(h)){e.next=17;break}throw v;case 17:return d=h.toJSON(),e.next=20,(0,p.iV)(d,d.spatialReference,n);case 20:if(m=e.sent){e.next=23;break}throw v;case 23:return e.abrupt("return",(m.spatialReference=n,t.geometry=m,t));case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){return F.apply(this,arguments)}function F(){return(F=(0,n.Z)(i.mark((function e(t){var r,n,a,s,o,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.geometry,n=t.distance,a=t.units,null!=n&&!("vertexAttributes"in r)){e.next=3;break}return e.abrupt("return",r);case 3:if(s=r.spatialReference,o=a?m.fromJSON(a):(0,u.qE)(s),!s||!(0,f.sT)(s)&&!(0,f.sS)(s)){e.next=9;break}e.t0=r,e.next=12;break;case 9:return e.next=11,(0,p._W)(s,f.Zn).then((function(){return(0,p.iV)(r,f.Zn)}));case 11:e.t0=e.sent;case 12:return l=e.t0,e.next=15,w();case 15:return e.t1=e.sent,e.abrupt("return",(0,e.t1)(l.spatialReference,l,n,o));case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return A.apply(this,arguments)}function A(){return(A=(0,n.Z)(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9058),r.e(309)]).then(r.bind(r,50309));case 2:return e.abrupt("return",e.sent.geodesicBuffer);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){return e&&N in e?JSON.parse(JSON.stringify(e,V)):e}var N="_geVersion",V=function(e,t){return e!==N?t:void 0}},15903:function(e,t,r){r.d(t,{G2:function(){return F},oF:function(){return Z},XL:function(){return _},i5:function(){return x},H0:function(){return g},eT:function(){return S},Qm:function(){return E},Lq:function(){return b},fk:function(){return R},S5:function(){return y},F_:function(){return T},DL:function(){return A}});var n=r(37762),i=r(42982),a=r(76551);function s(e,t){return Number(e.toFixed(t))}function u(e){var t=e.normalizationTotal;return{classBreaks:o(e),normalizationTotal:t}}function o(e){var t=e.definition,r=t.classificationMethod,n=t.breakCount,i=t.normalizationType,a=t.definedInterval,u=[],o=e.values;if(0===o.length)return[];o=o.sort((function(e,t){return e-t}));var h=o[0],d=o[o.length-1];if("equal-interval"===r)if(o.length>=n){for(var p=(d-h)/n,m=h,v=1;v<n;v++){var y=s(h+v*p,6);u.push({minValue:m,maxValue:y,label:l(m,y,i)}),m=y}u.push({minValue:m,maxValue:d,label:l(m,d,i)})}else o.forEach((function(e){u.push({minValue:e,maxValue:e,label:l(e,e,i)})}));else if("natural-breaks"===r){for(var g=c(o),x=e.valueFrequency||g.valueFrequency,_=f(g.uniqueValues,x,n),b=h,k=1;k<n;k++)if(g.uniqueValues.length>k){var I=s(g.uniqueValues[_[k]],6);u.push({minValue:b,maxValue:I,label:l(b,I,i)}),b=I}u.push({minValue:b,maxValue:d,label:l(b,d,i)})}else if("quantile"===r)if(o.length>=n&&h!==d){for(var T=h,S=Math.ceil(o.length/n),E=0,R=1;R<n;R++){var F=S+E-1;F>o.length&&(F=o.length-1),F<0&&(F=0),u.push({minValue:T,maxValue:o[F],label:l(T,o[F],i)}),T=o[F],E+=S,S=Math.ceil((o.length-E)/(n-R))}u.push({minValue:T,maxValue:d,label:l(T,d,i)})}else for(var w=-1,A=0;A<o.length;A++){var Z=o[A];Z!==w&&(w=Z,u.push({minValue:w,maxValue:Z,label:l(w,Z,i)}),w=Z)}else if("standard-deviation"===r){var N=function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t/e.length}(o),V=function(e,t){for(var r=0,n=0;n<e.length;n++){var i=e[n];r+=(i-t)*(i-t)}return r/=e.length,Math.sqrt(r)}(o,N);if(0===V)u.push({minValue:o[0],maxValue:o[0],label:l(o[0],o[0],i)});else{for(var C=function(e,t,r,n,i){var a=Math.max(n-e,t-n)/i/r;return a>=1?1:a>=.5?.5:.25}(h,d,n,N,V)*V,P=0,M=h,O=n;O>=1;O--){var G=s(N-(O-.5)*C,6);u.push({minValue:M,maxValue:G,label:l(M,G,i)}),M=G,P++}var Q=s(N+.5*C,6);u.push({minValue:M,maxValue:Q,label:l(M,Q,i)}),M=Q,P++;for(var z=1;z<=n;z++)Q=P===2*n?d:s(N+(z+.5)*C,6),u.push({minValue:M,maxValue:Q,label:l(M,Q,i)}),M=Q,P++}}else if("defined-interval"===r){if(!a)return u;for(var D=o[0],L=o[o.length-1],U=Math.ceil((L-D)/a),q=D,j=1;j<U;j++){var B=s(D+j*a,6);u.push({minValue:q,maxValue:B,label:l(q,B,i)}),q=B}u.push({minValue:q,maxValue:L,label:l(q,L,i)})}return u}function l(e,t,r){return e===t?r&&"percent-of-total"===r?e+"%":e.toString():r&&"percent-of-total"===r?e+"% - "+t+"%":e+" - "+t}function c(e){for(var t=[],r=[],n=Number.MIN_VALUE,i=1,a=-1,s=0;s<e.length;s++){var u=e[s];u===n?(i++,r[a]=i):null!==u&&(t.push(u),n=u,i=1,r.push(i),a++)}return{uniqueValues:t,valueFrequency:r}}function f(e,t,r){var n=e.length,i=[];r>n&&(r=n);for(var a=0;a<r;a++)i.push(Math.round(a*n/r-1));i.push(n-1);var s=h(i,e,t,r);return function(e,t,r,n,i,a){for(var s=0,u=0,o=0,l=0,c=!0,f=0;f<2&&c;f++){0===f&&(c=!1);for(var h=0;h<a-1;h++)for(;r[h+1]+1!==r[h+2];){r[h+1]=r[h+1]+1;var p=d(h,r,n,i);o=p.sbMean,s=p.sbSdcm;var m=d(h+1,r,n,i);if(l=m.sbMean,!(s+(u=m.sbSdcm)<t[h]+t[h+1])){r[h+1]=r[h+1]-1;break}t[h]=s,t[h+1]=u,e[h]=o,e[h+1]=l,c=!0}for(var v=a-1;v>0;v--)for(;r[v]!==r[v-1]+1;){r[v]=r[v]-1;var y=d(v-1,r,n,i);o=y.sbMean,s=y.sbSdcm;var g=d(v,r,n,i);if(l=g.sbMean,!(s+(u=g.sbSdcm)<t[v-1]+t[v])){r[v]=r[v]+1;break}t[v-1]=s,t[v]=u,e[v-1]=o,e[v]=l,c=!0}}return c}(s.mean,s.sdcm,i,e,t,r)&&(s=h(i,e,t,r)),i}function h(e,t,r,n){for(var i=[],a=[],s=[],u=0,o=[],l=[],c=0;c<n;c++){var f=d(c,e,t,r);o.push(f.sbMean),l.push(f.sbSdcm),u+=l[c]}for(var h,p=u,m=!0;m||u<p;){m=!1,i=[];for(var v=0;v<n;v++)i.push(e[v]);for(var y=0;y<n;y++)for(var g=e[y]+1;g<=e[y+1];g++)if(h=t[g],y>0&&g!==e[y+1]&&Math.abs(h-o[y])>Math.abs(h-o[y-1]))e[y]=g;else if(y<n-1&&e[y]!==g-1&&Math.abs(h-o[y])>Math.abs(h-o[y+1])){e[y+1]=g-1;break}p=u,u=0,a=[],s=[];for(var x=0;x<n;x++){a.push(o[x]),s.push(l[x]);var _=d(x,e,t,r);o[x]=_.sbMean,l[x]=_.sbSdcm,u+=l[x]}}if(u>p){for(var b=0;b<n;b++)e[b]=i[b],o[b]=a[b],l[b]=s[b];u=p}return{mean:o,sdcm:l}}function d(e,t,r,n){for(var i=0,a=0,s=t[e]+1;s<=t[e+1];s++){var u=n[s];i+=r[s]*u,a+=u}a<=0&&console.log("Exception in Natural Breaks calculation");for(var o=i/a,l=0,c=t[e]+1;c<=t[e+1];c++)l+=n[c]*Math.pow(r[c]-o,2);return{sbMean:o,sbSdcm:l}}var p=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,m=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),v=["min","max","avg","stddev","count","sum","variance","nullcount","median"];function y(e){var t=null!=e.normalizationField||null!=e.normalizationType,r=null!=e.minValue||null!=e.maxValue,n=!!e.sqlExpression&&e.supportsSQLExpression;return!t&&!r&&!n}function g(e){var t=e.returnDistinct?(0,i.Z)(new Set(e.values)):e.values,r=t.filter((function(e){return null!=e})).length,n={count:r};return e.supportsNullCount&&(n.nullcount=t.length-r),e.percentileParams&&(n.median=_(t,e.percentileParams)),n}function x(e){var t,r=e.values,i=e.useSampleStdDev,a=e.supportsNullCount,s=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,o=null,l=null,c=null,f=null,h=0,d=null==e.minValue?-1/0:e.minValue,p=null==e.maxValue?1/0:e.maxValue,m=(0,n.Z)(r);try{for(m.s();!(t=m.n()).done;){var v=t.value;Number.isFinite(v)?v>=d&&v<=p&&(o+=v,s=Math.min(s,v),u=Math.max(u,v),h++):"string"==typeof v&&h++}}catch(I){m.e(I)}finally{m.f()}if(h&&null!=o){l=o/h;var y,g=0,x=(0,n.Z)(r);try{for(x.s();!(y=x.n()).done;){var b=y.value;Number.isFinite(b)&&b>=d&&b<=p&&(g+=Math.pow(b-l,2))}}catch(I){x.e(I)}finally{x.f()}f=i?h>1?g/(h-1):0:h>0?g/h:0,c=Math.sqrt(f)}else s=null,u=null;var k={avg:l,count:h,max:u,min:s,stddev:c,sum:o,variance:f};return a&&(k.nullcount=r.length-h),e.percentileParams&&(k.median=_(r,e.percentileParams)),k}function _(e,t){var r=t.fieldType,n=t.value,a=t.orderBy,s=t.isDiscrete,u=b(r,"desc"===a);if(0===(e=(0,i.Z)(e).filter((function(e){return null!=e})).sort((function(e,t){return u(e,t)}))).length)return null;if(n<=0)return e[0];if(n>=1)return e[e.length-1];var o=(e.length-1)*n,l=Math.floor(o),c=l+1,f=o%1,h=e[l],d=e[c];return c>=e.length||s||"string"==typeof h||"string"==typeof d?h:h*(1-f)+d*f}function b(e,t){var r=t?1:-1,n=function(e){return e?function(e,t){return t-e}:function(e,t){return e-t}}(t),a=k(t);if(!e||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID"].concat((0,i.Z)(m)).includes(e))return function(e,t){return"number"==typeof e&&"number"==typeof t?n(e,t):"string"==typeof e&&"string"==typeof t?a(e,t):r};if("esriFieldTypeDate"===e)return function(e,t){var i=new Date(e).getTime(),a=new Date(t).getTime();return isNaN(i)||isNaN(a)?r:n(i,a)};if(m.has(e))return function(e,t){return n(e,t)};if("esriFieldTypeString"===e)return function(e,t){return a(e,t)};if("esriFieldTypeGUID"===e||"esriFieldTypeGlobalID"===e){var s=k(t);return function(e,t){return s(I(e),I(t))}}return t?function(e,t){return 1}:function(e,t){return-1}}function k(e){return e?function(e,t){var r,n;return(e=null==(r=e)?void 0:r.toUpperCase())>(t=null==(n=t)?void 0:n.toUpperCase())?-1:e<t?1:0}:function(e,t){var r,n;return(e=null==(r=e)?void 0:r.toUpperCase())<(t=null==(n=t)?void 0:n.toUpperCase())?-1:e>t?1:0}}function I(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function T(e,t){var r;for(r in e)v.indexOf(r)>-1&&(Number.isFinite(e[r])||(e[r]=null));return t?(["avg","stddev","variance"].forEach((function(t){null!=e[t]&&(e[t]=Math.ceil(e[t]))})),e):e}function S(e){var t,r={},i=(0,n.Z)(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;(null==a||"string"==typeof a&&""===a.trim())&&(a=null),null==r[a]?r[a]={count:1,data:a}:r[a].count++}}catch(s){i.e(s)}finally{i.f()}return{count:r}}function E(e,t,r){var n=e.count,i=[];for(var a in r&&t&&"coded-value"===t.type&&t.codedValues.forEach((function(e){var t=e.code;n.hasOwnProperty(t)||(n[t]={data:t,count:0})})),n){var s=n[a];i.push({value:s.data,count:s.count,label:s.label})}return{uniqueValueInfos:i}}function R(e,t,r,n){var i=null;switch(t){case"log":0!==e&&(i=Math.log(e)*Math.LOG10E);break;case"percent-of-total":Number.isFinite(n)&&0!==n&&(i=e/n*100);break;case"field":Number.isFinite(r)&&0!==r&&(i=e/r);break;case"natural-log":e>0&&(i=Math.log(e));break;case"square-root":e>0&&(i=Math.pow(e,.5))}return i}function F(e,t){var r=w({field:t.field,normalizationType:t.normalizationType,normalizationField:t.normalizationField,classificationMethod:t.classificationMethod,standardDeviationInterval:t.standardDeviationInterval,breakCount:t.numClasses||5});return e=function(e,t,r){return t=null==t?-1/0:t,r=null==r?1/0:r,e.filter((function(e){return Number.isFinite(e)&&e>=t&&e<=r}))}(e,t.minValue,t.maxValue),u({definition:r,values:e,normalizationTotal:t.normalizationTotal})}function w(e){var t=e.field,r=e.classificationMethod||"equal-interval",n=e.normalizationType,i=e.normalizationField,s=new a.Z;return s.classificationField=t,s.breakCount=e.breakCount,s.classificationMethod=r,s.standardDeviationInterval="standard-deviation"===r?e.standardDeviationInterval||1:void 0,s.normalizationType=n,s.normalizationField="field"===n?i:void 0,s}function A(e,t){var r=e.classBreaks,n=r.length,i=r[0].minValue,a=r[n-1].maxValue,s="standard-deviation"===t,u=p;return r=r.map((function(e){var t=e.label,r={minValue:e.minValue,maxValue:e.maxValue,label:t};if(s&&t){var n=t.match(u).map((function(e){return+e.trim()}));2===n.length?(r.minStdDev=n[0],r.maxStdDev=n[1],n[0]<0&&n[1]>0&&(r.hasAvg=!0)):1===n.length&&(t.includes("<")?(r.minStdDev=null,r.maxStdDev=n[0]):t.includes(">")&&(r.minStdDev=n[0],r.maxStdDev=null))}return r})),{minValue:i,maxValue:a,classBreakInfos:r,normalizationTotal:e.normalizationTotal}}function Z(e,t){var r,i=function(e,t){var r=t.field,n=t.classificationMethod,i=t.standardDeviationInterval,a=t.normalizationType,s=t.normalizationField,u=t.normalizationTotal,o=t.minValue,l=t.maxValue,c=t.numBins||10,f=null,h=null,d=null;if(n&&"equal-interval"!==n||a){var p=F(e,{field:r,normalizationType:a,normalizationField:s,normalizationTotal:u,classificationMethod:n,standardDeviationInterval:i,minValue:o,maxValue:l,numClasses:c}).classBreaks;f=p[0].minValue,h=p[p.length-1].maxValue,d=p.map((function(e){return[e.minValue,e.maxValue]}))}else{if(null!=o&&null!=l)f=o,h=l;else{var m=x({values:e,minValue:o,maxValue:l,useSampleStdDev:!a,supportsNullCount:y({normalizationType:a,normalizationField:s,minValue:o,maxValue:l})});f=m.min,h=m.max}d=function(e,t,r){for(var n,i=(t-e)/r,a=[],s=e,u=1;u<=r;u++)n=s+i,n=Number(n.toFixed(16)),a.push([s,u===r?t:n]),s=n;return a}(f,h,c)}return{min:f,max:h,intervals:d}}(e,t),a=i.min,s=i.max,u=i.intervals,o=u.map((function(e,t){return{minValue:u[t][0],maxValue:u[t][1],count:0}})),l=(0,n.Z)(e);try{for(l.s();!(r=l.n()).done;){var c=r.value;if(null!=c&&c>=a&&c<=s){var f=N(u,c);f>-1&&o[f].count++}}}catch(h){l.e(h)}finally{l.f()}return{bins:o,minValue:a,maxValue:s,normalizationTotal:t.normalizationTotal}}function N(e,t){for(var r=-1,n=e.length-1;n>=0;n--)if(t>=e[n][0]){r=n;break}return r}}}]);
//# sourceMappingURL=6270.4e1a7b7a.chunk.js.map