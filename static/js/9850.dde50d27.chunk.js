"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[9850],{41862:function(e,t,r){r.d(t,{aX:function(){return E}});var n=r(15861),a=r(37762),u=r(87757),s=r(42265),i=r(10064),o=r(32718),c=r(92026),l=r(80885),p=r(29909),d=r(78952),f=r(77981),h={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new p.Z({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:d.Z.WebMercator}),minus180Line:new p.Z({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:d.Z.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new p.Z({paths:[[[180,-180],[180,180]]],spatialReference:d.Z.WGS84}),minus180Line:new p.Z({paths:[[[-180,-180],[-180,180]]],spatialReference:d.Z.WGS84})}};function y(e,t){return Math.ceil((e-t)/(2*t))}function v(e,t){var r,n=m(e),u=(0,a.Z)(n);try{for(u.s();!(r=u.n()).done;){var s,i=r.value,o=(0,a.Z)(i);try{for(o.s();!(s=o.n()).done;){s.value[0]+=t}}catch(c){o.e(c)}finally{o.f()}}}catch(c){u.e(c)}finally{u.f()}return e}function m(e){return(0,f.oU)(e)?e.rings:e.paths}var g=r(92975),Z=r(81753),b=r(1413),x=(r(59486),r(76200)),k=r(35995);function F(e,t,r,n){return R.apply(this,arguments)}function R(){return R=(0,n.Z)(u.mark((function e(t,r,n,a){var s,i,o,c,l,p,d,h;return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="string"==typeof t?(0,k.mN)(t):t,i=r[0].spatialReference,o=(0,b.Z)((0,b.Z)({},a),{},{query:(0,b.Z)((0,b.Z)({},s.query),{},{f:"json",sr:JSON.stringify(i),target:JSON.stringify({geometryType:(0,f.Ji)(r[0]),geometries:r}),cutter:JSON.stringify(n)})}),e.next=5,(0,x.default)(s.path+"/cut",o);case 5:return c=e.sent,l=c.data,p=l.cutIndexes,d=l.geometries,h=void 0===d?[]:d,e.abrupt("return",{cutIndexes:p,geometries:h.map((function(e){var t=(0,f.im)(e);return t.spatialReference=i,t}))});case 11:case"end":return e.stop()}}),e)}))),R.apply(this,arguments)}function S(e,t,r){return O.apply(this,arguments)}function O(){return O=(0,n.Z)(u.mark((function e(t,r,n){var a,s,i,o;return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="string"==typeof t?(0,k.mN)(t):t,s=r[0].spatialReference,i=(0,f.Ji)(r[0]),o=(0,b.Z)((0,b.Z)({},n),{},{query:(0,b.Z)((0,b.Z)({},a.query),{},{f:"json",sr:s.wkid?s.wkid:JSON.stringify(s),geometries:JSON.stringify(w(r))})}),e.t0=_,e.next=4,(0,x.default)(a.path+"/simplify",o);case 4:return e.t1=e.sent.data,e.t2=i,e.t3=s,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 8:case"end":return e.stop()}}),e)}))),O.apply(this,arguments)}function w(e){return{geometryType:(0,f.Ji)(e[0]),geometries:e.map((function(e){return e.toJSON()}))}}function _(e,t,r){var n=(0,f.q9)(t);return e.map((function(e){var t=n.fromJSON(e);return t.spatialReference=r,t}))}var q=o.Z.getLogger("esri.geometry.support.normalizeUtils");function I(e,t,r){if(t){var n=function(e,t){if(!(e instanceof p.Z||e instanceof l.Z)){var r="straightLineDensify: the input geometry is neither polyline nor polygon";throw q.error(r),new i.Z(r)}var n,u=m(e),s=[],o=(0,a.Z)(u);try{for(o.s();!(n=o.n()).done;){var c=n.value,d=[];s.push(d),d.push([c[0][0],c[0][1]]);for(var f=0;f<c.length-1;f++){var h=c[f][0],y=c[f][1],v=c[f+1][0],g=c[f+1][1],Z=Math.sqrt((v-h)*(v-h)+(g-y)*(g-y)),b=(g-y)/Z,x=(v-h)/Z,k=Z/t;if(k>1){for(var F=1;F<=k-1;F++){var R=F*t,S=x*R+h,O=b*R+y;d.push([S,O])}var w=(Z+Math.floor(k-1)*t)/2,_=x*w+h,I=b*w+y;d.push([_,I])}d.push([v,g])}}}catch(C){o.e(C)}finally{o.f()}return function(e){return"polygon"===e.type}(e)?new l.Z({rings:s,spatialReference:e.spatialReference}):new p.Z({paths:s,spatialReference:e.spatialReference})}(e,1e6);e=(0,Z.Sx)(n,!0)}return r&&(e=v(e,r)),e}function C(e,t,r){if(Array.isArray(e)){var n=e[0];if(n>t){var a=y(n,t);e[0]=n+a*(-2*t)}else if(n<r){var u=y(n,r);e[0]=n+u*(-2*r)}}else{var s=e.x;if(s>t){var i=y(s,t);e=e.clone().offset(i*(-2*t),0)}else if(s<r){var o=y(s,r);e=e.clone().offset(o*(-2*r),0)}}return e}function j(e,t){for(var r=-1,n=function(n){for(var u=t.cutIndexes[n],s=t.geometries[n],i=m(s),o=function(e){var t=i[e];t.some((function(r){if(r[0]<180)return!0;for(var n=0,a=0;a<t.length;a++){var u=t[a][0];n=u>n?u:n}for(var i=-360*y(n=Number(n.toFixed(9)),180),o=0;o<t.length;o++){var c=s.getPoint(e,o);s.setPoint(e,o,c.clone().offset(i,0))}return!0}))},c=0;c<i.length;c++)o(c);if(u===r){if(function(e){return"polygon"===e[0].type}(e)){var l,p=(0,a.Z)(m(s));try{for(p.s();!(l=p.n()).done;){var d=l.value;e[u]=e[u].addRing(d)}}catch(g){p.e(g)}finally{p.f()}}else if(function(e){return"polyline"===e[0].type}(e)){var f,h=(0,a.Z)(m(s));try{for(h.s();!(f=h.n()).done;){var v=f.value;e[u]=e[u].addPath(v)}}catch(g){h.e(g)}finally{h.f()}}}else r=u,e[u]=s},u=0;u<t.cutIndexes.length;u++)n(u);return e}function E(e,t,r){return T.apply(this,arguments)}function T(){return T=(0,n.Z)(u.mark((function e(t,r,n){var i,o,d,f,m,b,x,k,R,O,w,_,q,T,D,A,P,N,J,G,M,Q,U,B,z,L,V,W,X,$,H,Y,K,ee,te,re,ne,ae,ue,se,ie;return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)){e.next=2;break}return e.abrupt("return",E([t],r));case 2:o=null!=(i=null==r?void 0:r.url)?i:s.Z.geometryServiceUrl,w=0,_=[],q=[],T=(0,a.Z)(t);try{for(T.s();!(D=T.n()).done;)A=D.value,(0,c.Wi)(A)?q.push(A):(d||(d=A.spatialReference,f=(0,g.C5)(d),m=d.isWebMercator,b=h[k=m?102100:4326].maxX,x=h[k].minX,R=h[k].plus180Line,O=h[k].minus180Line),f?"mesh"===A.type?q.push(A):"point"===A.type?q.push(C(A.clone(),b,x)):"multipoint"===A.type?((P=A.clone()).points=P.points.map((function(e){return C(e,b,x)})),q.push(P)):"extent"===A.type?(N=A.clone()._normalize(!1,!1,f),q.push(N.rings?new l.Z(N):N)):A.extent?(J=A.extent,G=y(J.xmin,x)*(2*b),M=0===G?A.clone():v(A.clone(),G),J.offset(G,0),J.intersects(R)&&J.xmax!==b?(w=J.xmax>w?J.xmax:w,M=I(M,m),_.push(M),q.push("cut")):J.intersects(O)&&J.xmin!==x?(w=J.xmax*(2*b)>w?J.xmax*(2*b):w,M=I(M,m,360),_.push(M),q.push("cut")):q.push(M)):q.push(A.clone()):q.push(A))}catch(u){T.e(u)}finally{T.f()}for(Q=y(w,b),U=-90,B=Q,z=new p.Z;Q>0;)L=360*Q-180,z.addPath([[L,U],[L,-1*U]]),U*=-1,Q--;if(!(_.length>0&&B>0)){e.next=28;break}return e.t0=j,e.t1=_,e.next=15,F(o,_,z,n);case 15:for(e.t2=e.sent,V=(0,e.t0)(e.t1,e.t2),W=[],X=[],$=0;$<q.length;$++)"cut"!==(H=q[$])?X.push(H):(Y=V.shift(),K=t[$],(0,c.pC)(K)&&"polygon"===K.type&&K.rings&&K.rings.length>1&&Y.rings.length>=K.rings.length?(W.push(Y),X.push("simplify")):X.push(m?(0,Z.$)(Y):Y));if(W.length){e.next=22;break}return e.abrupt("return",X);case 22:return e.next=24,S(o,W,n);case 24:for(ee=e.sent,te=[],re=0;re<X.length;re++)"simplify"!==(ne=X[re])?te.push(ne):te.push(m?(0,Z.$)(ee.shift()):ee.shift());return e.abrupt("return",te);case 28:for(ae=[],ue=0;ue<q.length;ue++)"cut"!==(se=q[ue])?ae.push(se):(ie=_.shift(),ae.push(!0===m?(0,Z.$)(ie):ie));return e.abrupt("return",Promise.resolve(ae));case 31:case"end":return e.stop()}}),e)}))),T.apply(this,arguments)}},60480:function(e,t,r){r.d(t,{g:function(){return n}});var n={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},19850:function(e,t,r){r.r(t),r.d(t,{default:function(){return Ge}});var n=r(1413),a=r(37762),u=r(42982),s=r(15671),i=r(43144),o=r(60136),c=r(29388),l=r(15861),p=r(87757),d=r(27366),f=(r(59486),r(52639)),h=r(76200),y=r(62044),v=r(10064),m=r(93169),g=r(43404),Z=r(54472),b=r(92026),x=r(18202),k=r(75298),F=r(35995),R=r(49861),S=(r(63780),r(25243),r(69912)),O=r(53866),w=r(77981),_=r(63543),q=r(62204),I=r(19545),C=r(22585),j=r(11812);function E(e){var t=e.toJSON();return t.attachmentTypes&&(t.attachmentTypes=t.attachmentTypes.join(",")),t.keywords&&(t.keywords=t.keywords.join(",")),t.globalIds&&(t.globalIds=t.globalIds.join(",")),t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.size&&(t.size=t.size.join(",")),t}function T(e,t){var r,n={},u=(0,a.Z)(e);try{for(u.s();!(r=u.n()).done;){var s,i=r.value,o=i.parentObjectId,c=i.parentGlobalId,l=i.attachmentInfos,p=(0,a.Z)(l);try{for(p.s();!(s=p.n()).done;){var d=s.value,f=d.id,h=(0,F.qg)((0,I.Dp)("".concat(t,"/").concat(o,"/attachments/").concat(f))),y=j.Z.fromJSON(d);y.set({url:h,parentObjectId:o,parentGlobalId:c}),n[o]?n[o].push(y):n[o]=[y]}}catch(v){p.e(v)}finally{p.f()}}}catch(v){u.e(v)}finally{u.f()}return n}function D(e,t,r){var a={query:(0,C.A)((0,n.Z)((0,n.Z)({},e.query),{},{f:"json"},E(t)))};return r&&(a=(0,n.Z)((0,n.Z)((0,n.Z)({},r),a),{},{query:(0,n.Z)((0,n.Z)({},r.query),a.query)})),(0,h.default)(e.path+"/queryAttachments",a)}var A=r(64020),P=r(23084),N=r(99837);function J(){return J=(0,l.Z)(p.mark((function e(t,r,a){var u;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=(0,P.en)(t),e.abrupt("return",D(u,N.Z.from(r),(0,n.Z)({},a)).then((function(e){return T(e.data.attachmentGroups,u.path)})));case 2:case"end":return e.stop()}}),e)}))),J.apply(this,arguments)}var G=r(34211),M=r(5192),Q=r(21149);function U(){return U=(0,l.Z)(p.mark((function e(t,r,a){var u;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=(0,P.en)(t),e.abrupt("return",(0,M.executeQueryForExtent)(u,Q.Z.from(r),(0,n.Z)({},a)).then((function(e){return{count:e.data.count,extent:O.Z.fromJSON(e.data.extent)}})));case 2:case"end":return e.stop()}}),e)}))),U.apply(this,arguments)}var B=r(24246),z=r(77946),L=r(41644),V=r(93501),W=r(83406);function X(e,t){return t}function $(e,t,r,n){switch(r){case 0:return ee(e,t+n,0);case 1:return"lowerLeft"===e.originPosition?ee(e,t+n,1):function(e,t,r){var n=e.translate,a=e.scale;return n[r]-t*a[r]}(e,t+n,1)}}function H(e,t,r,n){return 2===r?ee(e,t,2):$(e,t,r,n)}function Y(e,t,r,n){return 2===r?ee(e,t,3):$(e,t,r,n)}function K(e,t,r,n){return 3===r?ee(e,t,3):H(e,t,r,n)}function ee(e,t,r){var n=e.translate,a=e.scale;return n[r]+t*a[r]}var te=function(){function e(t){(0,s.Z)(this,e),this.options=t,this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],this.previousCoordinate=[0,0],this.transform=null,this.applyTransform=X,this.lengths=[],this.currentLengthIndex=0,this.toAddInCurrentPath=0,this.vertexDimension=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,this._attributesConstructor=function(){}}return(0,i.Z)(e,[{key:"createFeatureResult",value:function(){return{fields:[],features:[]}}},{key:"finishFeatureResult",value:function(e){if(this.options.applyTransform&&(e.transform=null),this._attributesConstructor=function(){},this.coordinateBuffer=null,this.lengths.length=0,e.hasZ){var t=(0,V.k)(e.geometryType,this.options.sourceSpatialReference,e.spatialReference);if(!(0,b.Wi)(t)){var r,n=(0,a.Z)(e.features);try{for(n.s();!(r=n.n()).done;){t(r.value.geometry)}}catch(u){n.e(u)}finally{n.f()}}}}},{key:"createSpatialReference",value:function(){return{}}},{key:"addField",value:function(e,t){e.fields.push(t);var r=e.fields.map((function(e){return e.name}));this._attributesConstructor=function(){var e,t=(0,a.Z)(r);try{for(t.s();!(e=t.n()).done;){this[e.value]=null}}catch(n){t.e(n)}finally{t.f()}}}},{key:"addFeature",value:function(e,t){e.features.push(t)}},{key:"prepareFeatures",value:function(e){var t=this;switch(this.transform=e.transform,this.options.applyTransform&&e.transform&&(this.applyTransform=this._deriveApplyTransform(e)),this.vertexDimension=2,e.hasZ&&this.vertexDimension++,e.hasM&&this.vertexDimension++,e.geometryType){case"esriGeometryPoint":this.addCoordinate=function(e,r,n){return t.addCoordinatePoint(e,r,n)},this.createGeometry=function(e){return t.createPointGeometry(e)};break;case"esriGeometryPolygon":this.addCoordinate=function(e,r,n){return t._addCoordinatePolygon(e,r,n)},this.createGeometry=function(e){return t._createPolygonGeometry(e)};break;case"esriGeometryPolyline":this.addCoordinate=function(e,r,n){return t._addCoordinatePolyline(e,r,n)},this.createGeometry=function(e){return t._createPolylineGeometry(e)};break;case"esriGeometryMultipoint":this.addCoordinate=function(e,r,n){return t._addCoordinateMultipoint(e,r,n)},this.createGeometry=function(e){return t._createMultipointGeometry(e)};break;default:(0,L.Bg)(e.geometryType)}}},{key:"createFeature",value:function(){return this.lengths.length=0,this.currentLengthIndex=0,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,{attributes:new this._attributesConstructor}}},{key:"allocateCoordinates",value:function(){}},{key:"addLength",value:function(e,t,r){0===this.lengths.length&&(this.toAddInCurrentPath=t),this.lengths.push(t)}},{key:"addQueryGeometry",value:function(e,t){var r=t.queryGeometry,a=t.queryGeometryType,u=(0,W.$g)(r.clone(),r,!1,!1,this.transform),s=(0,W.di)(u,a,!1,!1);e.queryGeometryType=a,e.queryGeometry=(0,n.Z)({},s)}},{key:"createPointGeometry",value:function(e){var t={x:0,y:0,spatialReference:e.spatialReference};return e.hasZ&&(t.z=0),e.hasM&&(t.m=0),t}},{key:"addCoordinatePoint",value:function(e,t,r){switch(t=this.applyTransform(this.transform,t,r,0),r){case 0:e.x=t;break;case 1:e.y=t;break;case 2:"z"in e?e.z=t:e.m=t;break;case 3:e.m=t}}},{key:"_transformPathLikeValue",value:function(e,t){var r=0;return t<=1&&(r=this.previousCoordinate[t],this.previousCoordinate[t]+=e),this.applyTransform(this.transform,e,t,r)}},{key:"_addCoordinatePolyline",value:function(e,t,r){this._dehydratedAddPointsCoordinate(e.paths,t,r)}},{key:"_addCoordinatePolygon",value:function(e,t,r){this._dehydratedAddPointsCoordinate(e.rings,t,r)}},{key:"_addCoordinateMultipoint",value:function(e,t,r){0===r&&e.points.push([]);var n=this._transformPathLikeValue(t,r);e.points[e.points.length-1].push(n)}},{key:"_createPolygonGeometry",value:function(e){return{rings:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}},{key:"_createPolylineGeometry",value:function(e){return{paths:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}},{key:"_createMultipointGeometry",value:function(e){return{points:[],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}},{key:"_dehydratedAddPointsCoordinate",value:function(e,t,r){0===r&&0==this.toAddInCurrentPath--&&(e.push([]),this.toAddInCurrentPath=this.lengths[++this.currentLengthIndex]-1,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0);var n=this._transformPathLikeValue(t,r),a=e[e.length-1];0===r&&(this.coordinateBufferPtr=0,this.coordinateBuffer=new Array(this.vertexDimension),a.push(this.coordinateBuffer)),this.coordinateBuffer[this.coordinateBufferPtr++]=n}},{key:"_deriveApplyTransform",value:function(e){var t=e.hasZ,r=e.hasM;return t&&r?K:t?H:r?Y:$}}]),e}(),re=r(49818);function ne(e,t,r){return ae.apply(this,arguments)}function ae(){return ae=(0,l.Z)(p.mark((function e(t,r,a){var u,s,i,o,c,l;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=(0,P.en)(t),s=(0,n.Z)({},a),i=Q.Z.from(r),o=!i.quantizationParameters,e.next=6,(0,M.executeQueryPBF)(u,i,new te({sourceSpatialReference:i.sourceSpatialReference,applyTransform:o}),s);case 6:return c=e.sent,l=c.data,e.abrupt("return",l);case 9:case"end":return e.stop()}}),e)}))),ae.apply(this,arguments)}function ue(e,t){var r=e.toJSON();return r.objectIds&&(r.objectIds=r.objectIds.join(",")),r.orderByFields&&(r.orderByFields=r.orderByFields.join(",")),!r.outFields||null!=t&&t.returnCountOnly?delete r.outFields:-1!==r.outFields.indexOf("*")?r.outFields="*":r.outFields=r.outFields.join(","),r.outSpatialReference&&(r.outSR=r.outSR.wkid||JSON.stringify(r.outSR.toJSON()),delete r.outSpatialReference),r.dynamicDataSource&&(r.layer=JSON.stringify({source:r.dynamicDataSource}),delete r.dynamicDataSource),r}function se(e,t,r){return ie.apply(this,arguments)}function ie(){return ie=(0,l.Z)(p.mark((function e(t,r,u){var s,i,o,c,l,d,f,h,y,v;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le(t,r,u);case 2:s=e.sent,i=s.data,o=i.geometryType,c=i.spatialReference,l={},d=(0,a.Z)(i.relatedRecordGroups);try{for(d.s();!(f=d.n()).done;)if(h=f.value,y={fields:void 0,objectIdFieldName:void 0,geometryType:o,spatialReference:c,hasZ:!!i.hasZ,hasM:!!i.hasM,features:h.relatedRecords},null!=h.objectId)l[h.objectId]=y;else for(v in h)h.hasOwnProperty(v)&&"relatedRecords"!==v&&(l[h[v]]=y)}catch(p){d.e(p)}finally{d.f()}return e.abrupt("return",(0,n.Z)((0,n.Z)({},s),{},{data:l}));case 10:case"end":return e.stop()}}),e)}))),ie.apply(this,arguments)}function oe(e,t,r){return ce.apply(this,arguments)}function ce(){return ce=(0,l.Z)(p.mark((function e(t,r,u){var s,i,o,c,l,d;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le(t,r,u,{returnCountOnly:!0});case 2:s=e.sent,i=s.data,o={},c=(0,a.Z)(i.relatedRecordGroups);try{for(c.s();!(l=c.n()).done;)null!=(d=l.value).objectId&&(o[d.objectId]=d.count)}catch(p){c.e(p)}finally{c.f()}return e.abrupt("return",(0,n.Z)((0,n.Z)({},s),{},{data:o}));case 8:case"end":return e.stop()}}),e)}))),ce.apply(this,arguments)}function le(e,t){return pe.apply(this,arguments)}function pe(){return pe=(0,l.Z)(p.mark((function e(t,r){var a,u,s,i=arguments;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.length>2&&void 0!==i[2]?i[2]:{},u=i.length>3?i[3]:void 0,s=(0,C.A)((0,n.Z)((0,n.Z)((0,n.Z)({},t.query),{},{f:"json"},u),ue(r,u))),e.abrupt("return",(0,h.default)(t.path+"/queryRelatedRecords",(0,n.Z)((0,n.Z)({},a),{},{query:(0,n.Z)((0,n.Z)({},a.query),s)})));case 4:case"end":return e.stop()}}),e)}))),pe.apply(this,arguments)}var de=r(99086);function fe(){return fe=(0,l.Z)(p.mark((function e(t,r,n){var a;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=de.Z.from(r),a=(0,P.en)(t),e.abrupt("return",se(a,r,n).then((function(e){var t=e.data,r={};return Object.keys(t).forEach((function(e){return r[e]=re.default.fromJSON(t[e])})),r})));case 3:case"end":return e.stop()}}),e)}))),fe.apply(this,arguments)}function he(){return he=(0,l.Z)(p.mark((function e(t,r,a){var u;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=de.Z.from(r),u=(0,P.en)(t),e.abrupt("return",oe(u,r,(0,n.Z)({},a)).then((function(e){return e.data})));case 3:case"end":return e.stop()}}),e)}))),he.apply(this,arguments)}var ye=r(41862),ve=r(68620),me="Layer does not support extent calculation.";function ge(e,t){var r,n,a=e.geometry,u=e.toJSON(),s=u;if((0,b.pC)(a)&&(s.geometry=JSON.stringify(a),s.geometryType=(0,w.Ji)(a),s.inSR=a.spatialReference.wkid||JSON.stringify(a.spatialReference)),null!=(r=u.topFilter)&&r.groupByFields&&(s.topFilter.groupByFields=u.topFilter.groupByFields.join(",")),null!=(n=u.topFilter)&&n.orderByFields&&(s.topFilter.orderByFields=u.topFilter.orderByFields.join(",")),u.topFilter&&(s.topFilter=JSON.stringify(s.topFilter)),u.objectIds&&(s.objectIds=u.objectIds.join(",")),u.orderByFields&&(s.orderByFields=u.orderByFields.join(",")),u.outFields&&!(null!=t&&t.returnCountOnly||null!=t&&t.returnExtentOnly||null!=t&&t.returnIdsOnly)?-1!==u.outFields.indexOf("*")?s.outFields="*":s.outFields=u.outFields.join(","):delete s.outFields,u.outSR?s.outSR=u.outSR.wkid||JSON.stringify(u.outSR):a&&u.returnGeometry&&(s.outSR=s.inSR),u.returnGeometry&&delete u.returnGeometry,u.timeExtent){var i=u.timeExtent,o=i.start,c=i.end;null==o&&null==c||(s.time=o===c?o:"".concat(null==o?"null":o,",").concat(null==c?"null":c)),delete u.timeExtent}return s}function Ze(e,t,r,n){return be.apply(this,arguments)}function be(){return be=(0,l.Z)(p.mark((function e(t,r,n,a){var u;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Oe(t,r,"json",a);case 2:return u=e.sent,e.abrupt("return",((0,ve.p)(r,n,u.data),u));case 4:case"end":return e.stop()}}),e)}))),be.apply(this,arguments)}function xe(e,t,r){return ke.apply(this,arguments)}function ke(){return ke=(0,l.Z)(p.mark((function e(t,r,n){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.pC)(r.timeExtent)&&r.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):Oe(t,r,"json",n,{returnIdsOnly:!0}));case 1:case"end":return e.stop()}}),e)}))),ke.apply(this,arguments)}function Fe(e,t,r){return Re.apply(this,arguments)}function Re(){return Re=(0,l.Z)(p.mark((function e(t,r,n){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.pC)(r.timeExtent)&&r.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):Oe(t,r,"json",n,{returnExtentOnly:!0,returnCountOnly:!0}).then((function(e){var t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error(me);if(t.hasOwnProperty("count"))throw new Error(me);return e})));case 1:case"end":return e.stop()}}),e)}))),Re.apply(this,arguments)}function Se(e,t,r){return(0,b.pC)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):Oe(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})}function Oe(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s="string"==typeof e?(0,F.mN)(e):e,i=t.geometry?[t.geometry]:[];return a.responseType="pbf"===r?"array-buffer":"json",(0,ye.aX)(i,null,a).then((function(e){var i=e&&e[0];(0,b.pC)(i)&&((t=t.clone()).geometry=i);var o=(0,C.A)((0,n.Z)((0,n.Z)((0,n.Z)({},s.query),{},{f:r},u),ge(t,u)));return(0,h.default)((0,F.v_)(s.path,"queryTopFeatures"),(0,n.Z)((0,n.Z)({},a),{},{query:(0,n.Z)((0,n.Z)({},o),a.query)}))}))}var we=r(54307);function _e(){return _e=(0,l.Z)(p.mark((function e(t,r,a,u){var s,i,o,c;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=(0,P.en)(t),i=(0,n.Z)({},u),e.next=4,Ze(s,we.Z.from(r),a,i);case 4:return o=e.sent,c=o.data,e.abrupt("return",re.default.fromJSON(c));case 7:case"end":return e.stop()}}),e)}))),_e.apply(this,arguments)}function qe(){return qe=(0,l.Z)(p.mark((function e(t,r,a){var u;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=(0,P.en)(t),e.next=3,xe(u,we.Z.from(r),(0,n.Z)({},a));case 3:return e.abrupt("return",e.sent.data.objectIds);case 4:case"end":return e.stop()}}),e)}))),qe.apply(this,arguments)}function Ie(){return Ie=(0,l.Z)(p.mark((function e(t,r,a){var u,s;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=(0,P.en)(t),e.next=3,Fe(u,we.Z.from(r),(0,n.Z)({},a));case 3:return s=e.sent,e.abrupt("return",{count:s.data.count,extent:O.Z.fromJSON(s.data.extent)});case 5:case"end":return e.stop()}}),e)}))),Ie.apply(this,arguments)}function Ce(){return Ce=(0,l.Z)(p.mark((function e(t,r,a){var u;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=(0,P.en)(t),e.next=3,Se(u,we.Z.from(r),(0,n.Z)({},a));case 3:return e.abrupt("return",e.sent.data.count);case 4:case"end":return e.stop()}}),e)}))),Ce.apply(this,arguments)}var je=function(e){(0,o.Z)(u,e);var t=(0,c.Z)(u);function u(e){var r;return(0,s.Z)(this,u),(r=t.call(this,e)).dynamicDataSource=null,r.fieldsIndex=null,r.format="json",r.gdbVersion=null,r.infoFor3D=null,r.sourceSpatialReference=null,r}return(0,i.Z)(u,[{key:"execute",value:function(e,t){var r=this;return this.executeJSON(e,t).then((function(n){return r.featureSetFromJSON(e,n,t)}))}},{key:"executeJSON",value:function(){var e=(0,l.Z)(p.mark((function e(t,r){var a,u,s,i,o,c,l;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=(0,n.Z)((0,n.Z)({},this.requestOptions),r),s=this._normalizeQuery(t),i=null!=(null==(a=t.outStatistics)?void 0:a[0]),o=(0,m.Z)("featurelayer-pbf-statistics"),c=!i||o,"pbf"!==this.format||!c){e.next=13;break}return e.prev=2,e.next=5,ne(this.url,s,u);case 5:l=e.sent,e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(2),"query:parsing-pbf"===e.t0.name){e.next=12;break}throw e.t0;case 12:this.format="json";case 13:if(e.t1="json"!==this.format&&c,e.t1){e.next=18;break}return e.next=17,(0,z.F)(this.url,s,u);case 17:l=e.sent;case 18:return this._normalizeFields(l.fields),e.abrupt("return",l);case 20:case"end":return e.stop()}}),e,this,[[2,8]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"featureSetFromJSON",value:function(){var e=(0,l.Z)(p.mark((function e(t,n,a){var u,s;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._queryIs3DObjectFormat(t)&&(0,b.pC)(this.infoFor3D)&&n.features&&n.features.length){e.next=2;break}return e.abrupt("return",re.default.fromJSON(n));case 2:return e.next=4,(0,k.Hl)(Promise.all([r.e(2587),r.e(5158),r.e(3581),r.e(9667)]).then(r.bind(r,79667)),a);case 4:return u=e.sent,s=u.meshFeatureSetFromJSON,e.abrupt("return",s(t,this.infoFor3D,n));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"executeForCount",value:function(e,t){var r=(0,n.Z)((0,n.Z)({},this.requestOptions),t),a=this._normalizeQuery(e);return(0,G.P)(this.url,a,r)}},{key:"executeForExtent",value:function(e,t){var r=(0,n.Z)((0,n.Z)({},this.requestOptions),t),a=this._normalizeQuery(e);return function(e,t,r){return U.apply(this,arguments)}(this.url,a,r)}},{key:"executeForIds",value:function(e,t){var r=(0,n.Z)((0,n.Z)({},this.requestOptions),t),a=this._normalizeQuery(e);return(0,B.G)(this.url,a,r)}},{key:"executeRelationshipQuery",value:function(e,t){e=de.Z.from(e);var r=(0,n.Z)((0,n.Z)({},this.requestOptions),t);return(this.gdbVersion||this.dynamicDataSource)&&((e=e.clone()).gdbVersion=e.gdbVersion||this.gdbVersion,e.dynamicDataSource=e.dynamicDataSource||this.dynamicDataSource),function(e,t,r){return fe.apply(this,arguments)}(this.url,e,r)}},{key:"executeRelationshipQueryForCount",value:function(e,t){e=de.Z.from(e);var r=(0,n.Z)((0,n.Z)({},this.requestOptions),t);return(this.gdbVersion||this.dynamicDataSource)&&((e=e.clone()).gdbVersion=e.gdbVersion||this.gdbVersion,e.dynamicDataSource=e.dynamicDataSource||this.dynamicDataSource),function(e,t,r){return he.apply(this,arguments)}(this.url,e,r)}},{key:"executeAttachmentQuery",value:function(e,t){var r=(0,n.Z)((0,n.Z)({},this.requestOptions),t);return function(e,t,r){return J.apply(this,arguments)}(this.url,e,r)}},{key:"executeTopFeaturesQuery",value:function(e,t){var r=(0,n.Z)((0,n.Z)({},this.requestOptions),t);return function(e,t,r,n){return _e.apply(this,arguments)}(this.parsedUrl,e,this.sourceSpatialReference,r)}},{key:"executeForTopIds",value:function(e,t){var r=(0,n.Z)((0,n.Z)({},this.requestOptions),t);return function(e,t,r){return qe.apply(this,arguments)}(this.parsedUrl,e,r)}},{key:"executeForTopExtents",value:function(e,t){var r=(0,n.Z)((0,n.Z)({},this.requestOptions),t);return function(e,t,r){return Ie.apply(this,arguments)}(this.parsedUrl,e,r)}},{key:"executeForTopCount",value:function(e,t){var r=(0,n.Z)((0,n.Z)({},this.requestOptions),t);return function(e,t,r){return Ce.apply(this,arguments)}(this.parsedUrl,e,r)}},{key:"_normalizeQuery",value:function(e){var t=Q.Z.from(e);if(t.sourceSpatialReference=t.sourceSpatialReference||this.sourceSpatialReference,(this.gdbVersion||this.dynamicDataSource)&&((t=t===e?t.clone():t).gdbVersion=e.gdbVersion||this.gdbVersion,t.dynamicDataSource=e.dynamicDataSource?A.n.from(e.dynamicDataSource):this.dynamicDataSource),(0,b.pC)(this.infoFor3D)&&this._queryIs3DObjectFormat(e)){(t=t===e?t.clone():t).formatOf3DObjects=null;var r,n=(0,a.Z)(this.infoFor3D.queryFormats);try{for(n.s();!(r=n.n()).done;){var u=r.value;if("3D_glb"===u.id){t.formatOf3DObjects=u.id;break}"3D_gltf"!==u.id||t.formatOf3DObjects||(t.formatOf3DObjects=u.id)}}catch(k){n.e(k)}finally{n.f()}if(!t.formatOf3DObjects)throw new v.Z("query:unsupported-3d-query-formats","Could not find any supported 3D object query format. Only supported formats are 3D_glb and 3D_gltf");if((0,b.Wi)(t.outFields)||!t.outFields.includes("*")){t=t===e?t.clone():t,(0,b.Wi)(t.outFields)&&(t.outFields=[]);var s=this.infoFor3D.transformFieldRoles,i=s.originX,o=s.originY,c=s.originZ,l=s.translationX,p=s.translationY,d=s.translationZ,f=s.scaleX,h=s.scaleY,y=s.scaleZ,m=s.rotationX,g=s.rotationY,Z=s.rotationZ,x=s.rotationDeg;t.outFields.push(i,o,c,l,p,d,f,h,y,m,g,Z,x)}}return t}},{key:"_normalizeFields",value:function(e){if((0,b.pC)(this.fieldsIndex)&&(0,b.pC)(e)){var t,r=(0,a.Z)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value,u=this.fieldsIndex.get(n.name);u&&Object.assign(n,u.toJSON())}}catch(s){r.e(s)}finally{r.f()}}}},{key:"_queryIs3DObjectFormat",value:function(e){return(0,b.pC)(this.infoFor3D)&&e.returnGeometry&&"xyFootprint"!==e.multipatchOption&&!e.outStatistics}}]),u}(r(4338).Z);(0,d._)([(0,R.Cb)({type:A.n})],je.prototype,"dynamicDataSource",void 0),(0,d._)([(0,R.Cb)()],je.prototype,"fieldsIndex",void 0),(0,d._)([(0,R.Cb)()],je.prototype,"format",void 0),(0,d._)([(0,R.Cb)()],je.prototype,"gdbVersion",void 0),(0,d._)([(0,R.Cb)()],je.prototype,"infoFor3D",void 0),(0,d._)([(0,R.Cb)()],je.prototype,"sourceSpatialReference",void 0);var Ee=je=(0,d._)([(0,S.j)("esri.tasks.QueryTask")],je),Te=r(78952),De=new g.X({originalAndCurrentFeatures:"original-and-current-features",none:"none"});function Ae(e){return Pe.apply(this,arguments)}function Pe(){return Pe=(0,l.Z)(p.mark((function e(t){var r;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=3;break}return r=(0,F.sJ)(t),e.abrupt("return",r||{data:t});case 3:return e.abrupt("return",new Promise((function(e,r){var n=new FileReader;n.readAsDataURL(t),n.onload=function(){return e((0,F.sJ)(n.result))},n.onerror=function(e){return r(e)}})));case 4:case"end":return e.stop()}}),e)}))),Pe.apply(this,arguments)}var Ne=new Set(["Feature Layer","Table"]),Je=function(e){(0,o.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,s.Z)(this,r),(e=t.apply(this,arguments)).type="feature-layer",e.refresh=(0,k.Ds)((0,l.Z)(p.mark((function t(){var r,n,a,u;return p.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.load();case 2:if(null!=(a=null==(r=e.sourceJSON.editingInfo)?void 0:r.lastEditDate)){t.next=5;break}return t.abrupt("return",{dataChanged:!0,updates:{}});case 5:return t.prev=5,t.next=8,e._fetchService(null);case 8:t.next=13;break;case 10:return t.prev=10,t.t0=t.catch(5),t.abrupt("return",{dataChanged:!0,updates:{}});case 13:return u=a!==(null==(n=e.sourceJSON.editingInfo)?void 0:n.lastEditDate),t.abrupt("return",{dataChanged:u,updates:u?{editingInfo:e.sourceJSON.editingInfo,extent:e.sourceJSON.extent}:null});case 15:case"end":return t.stop()}}),t,null,[[5,10]])})))),e}return(0,i.Z)(r,[{key:"load",value:function(e){var t=(0,b.pC)(e)?e.signal:null;return this.addResolvingPromise(this._fetchService(this.layer.sourceJSON,t)),Promise.resolve(this)}},{key:"queryTask",get:function(){var e=this.layer,t=e.capabilities.query.supportsFormatPBF,r=e.parsedUrl,n=e.dynamicDataSource,a=e.infoFor3D,u=e.gdbVersion,s=e.spatialReference,i=e.fieldsIndex,o=(0,m.Z)("featurelayer-pbf")&&t&&(0,b.Wi)(a)?"pbf":"json";return new Ee({url:r.path,format:o,fieldsIndex:i,infoFor3D:a,dynamicDataSource:n,gdbVersion:u,sourceSpatialReference:s})}},{key:"addAttachment",value:function(){var e=(0,l.Z)(p.mark((function e(t,r){var n,a,u,s,i;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return n=t.attributes[this.layer.objectIdField],a=this.layer.parsedUrl.path+"/"+n+"/addAttachment",u=this._getLayerRequestOptions(),s=this._getFormDataForAttachment(r,u.query),e.prev=3,e.next=6,(0,h.default)(a,{body:s});case 6:return i=e.sent,e.abrupt("return",this._createFeatureEditResult(i.data.addAttachmentResult));case 10:throw e.prev=10,e.t0=e.catch(3),this._createAttachmentErrorResult(n,e.t0);case 13:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateAttachment",value:function(){var e=(0,l.Z)(p.mark((function e(t,r,n){var a,u,s,i,o;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return a=t.attributes[this.layer.objectIdField],u=this.layer.parsedUrl.path+"/"+a+"/updateAttachment",s=this._getLayerRequestOptions({query:{attachmentId:r}}),i=this._getFormDataForAttachment(n,s.query),e.prev=3,e.next=6,(0,h.default)(u,{body:i});case 6:return o=e.sent,e.abrupt("return",this._createFeatureEditResult(o.data.updateAttachmentResult));case 10:throw e.prev=10,e.t0=e.catch(3),this._createAttachmentErrorResult(a,e.t0);case 13:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"applyEdits",value:function(){var e=(0,l.Z)(p.mark((function e(t,r){var n,s,i,o,c,l,d,f,y,v,m,g,Z,b,x,k,F;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:n=t.addFeatures.map(this._serializeFeature,this),s=t.updateFeatures.map(this._serializeFeature,this),i=this._getFeatureIds(t.deleteFeatures,null==r?void 0:r.globalIdUsed),(0,q.P)(n,s,this.layer.spatialReference),o=[],c=[],l=(0,u.Z)(t.deleteAttachments),d=(0,a.Z)(t.addAttachments),e.prev=6,d.s();case 8:if((f=d.n()).done){e.next=17;break}return y=f.value,e.t0=o,e.next=13,this._serializeAttachment(y);case 13:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 15:e.next=8;break;case 17:e.next=22;break;case 19:e.prev=19,e.t2=e.catch(6),d.e(e.t2);case 22:return e.prev=22,d.f(),e.finish(22);case 25:v=(0,a.Z)(t.updateAttachments),e.prev=26,v.s();case 28:if((m=v.n()).done){e.next=37;break}return g=m.value,e.t3=c,e.next=33,this._serializeAttachment(g);case 33:e.t4=e.sent,e.t3.push.call(e.t3,e.t4);case 35:e.next=28;break;case 37:e.next=42;break;case 39:e.prev=39,e.t5=e.catch(26),v.e(e.t5);case 42:return e.prev=42,v.f(),e.finish(42);case 45:return Z=o.length||c.length||l.length?{adds:o,updates:c,deletes:l}:null,b={gdbVersion:(null==r?void 0:r.gdbVersion)||this.layer.gdbVersion,rollbackOnFailure:null==r?void 0:r.rollbackOnFailureEnabled,useGlobalIds:null==r?void 0:r.globalIdUsed,returnEditMoment:null==r?void 0:r.returnEditMoment,usePreviousEditMoment:null==r?void 0:r.usePreviousEditMoment,sessionId:null==r?void 0:r.sessionId},null!=r&&r.returnServiceEditsOption?(b.edits=JSON.stringify([{id:this.layer.layerId,adds:n,updates:s,deletes:i,attachments:Z}]),b.returnServiceEditsOption=De.toJSON(null==r?void 0:r.returnServiceEditsOption),b.returnServiceEditsInSourceSR=null==r?void 0:r.returnServiceEditsInSourceSR):(b.adds=n.length?JSON.stringify(n):null,b.updates=s.length?JSON.stringify(s):null,b.deletes=i.length?null!=r&&r.globalIdUsed?JSON.stringify(i):i.join(","):null,b.attachments=Z&&JSON.stringify(Z)),x=this._getLayerRequestOptions({method:"post",query:b}),k=null!=r&&r.returnServiceEditsOption?this.layer.url:this.layer.parsedUrl.path,e.next=51,(0,h.default)(k+"/applyEdits",x);case 51:return F=e.sent,e.abrupt("return",this._createEditsResult(F));case 53:case"end":return e.stop()}}),e,this,[[6,19,22,25],[26,39,42,45]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"deleteAttachments",value:function(){var e=(0,l.Z)(p.mark((function e(t,r){var n,a;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return n=t.attributes[this.layer.objectIdField],a=this.layer.parsedUrl.path+"/"+n+"/deleteAttachments",e.prev=3,e.next=6,(0,h.default)(a,this._getLayerRequestOptions({query:{attachmentIds:r.join(",")},method:"post"}));case 6:return e.abrupt("return",e.sent.data.deleteAttachmentResults.map(this._createFeatureEditResult));case 9:throw e.prev=9,e.t0=e.catch(3),this._createAttachmentErrorResult(n,e.t0);case 12:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"fetchRecomputedExtents",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.signal;return this.load({signal:r}).then((0,l.Z)(p.mark((function r(){var a,u,s,i,o,c,l,d,f,v,m;return p.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=e._getLayerRequestOptions((0,n.Z)((0,n.Z)({},t),{},{query:{returnUpdates:!0}})),u=e.layer,s=u.layerId,i=u.url,r.next=6,(0,h.default)("".concat(i,"/").concat(s),a);case 6:return o=r.sent,c=o.data,l=c.id,d=c.extent,f=c.fullExtent,v=c.timeExtent,m=d||f,r.abrupt("return",{id:l,fullExtent:m&&O.Z.fromJSON(m),timeExtent:v&&y.Z.fromJSON({start:v[0],end:v[1]})});case 14:case"end":return r.stop()}}),r)}))))}},{key:"queryAttachments",value:function(){var e=(0,l.Z)(p.mark((function e(t){var r,n,u,s,i,o,c,l,d,f,y=arguments;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=y.length>1&&void 0!==y[1]?y[1]:{},n=this.layer.parsedUrl,u=n.path,e.next=4,this.load();case 4:if(s=this._getLayerRequestOptions(r),this.layer.get("capabilities.operations.supportsQueryAttachments")){e.next=10;break}i=t.objectIds,o=[],c=(0,a.Z)(i);try{for(c.s();!(l=c.n()).done;)d=l.value,f=u+"/"+d+"/attachments",o.push((0,h.default)(f,s))}catch(p){c.e(p)}finally{c.f()}return e.abrupt("return",Promise.all(o).then((function(e){return i.map((function(t,r){return{parentObjectId:t,attachmentInfos:e[r].data.attachmentInfos}}))})).then((function(e){return T(e,u)})));case 10:return e.abrupt("return",this.queryTask.executeAttachmentQuery(t,s));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queryFeatures",value:function(){var e=(0,l.Z)(p.mark((function e(t,r){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.execute(t,(0,n.Z)((0,n.Z)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryFeaturesJSON",value:function(){var e=(0,l.Z)(p.mark((function e(t,r){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeJSON(t,(0,n.Z)((0,n.Z)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryObjectIds",value:function(){var e=(0,l.Z)(p.mark((function e(t,r){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeForIds(t,(0,n.Z)((0,n.Z)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryFeatureCount",value:function(){var e=(0,l.Z)(p.mark((function e(t,r){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeForCount(t,(0,n.Z)((0,n.Z)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryExtent",value:function(){var e=(0,l.Z)(p.mark((function e(t,r){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeForExtent(t,(0,n.Z)((0,n.Z)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryRelatedFeatures",value:function(){var e=(0,l.Z)(p.mark((function e(t,r){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeRelationshipQuery(t,(0,n.Z)((0,n.Z)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryRelatedFeaturesCount",value:function(){var e=(0,l.Z)(p.mark((function e(t,r){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeRelationshipQueryForCount(t,(0,n.Z)((0,n.Z)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryTopFeatures",value:function(){var e=(0,l.Z)(p.mark((function e(t,r){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeTopFeaturesQuery(t,(0,n.Z)((0,n.Z)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryTopObjectIds",value:function(){var e=(0,l.Z)(p.mark((function e(t,r){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeForTopIds(t,(0,n.Z)((0,n.Z)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryTopExtents",value:function(){var e=(0,l.Z)(p.mark((function e(t,r){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeForTopExtents(t,(0,n.Z)((0,n.Z)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryTopCount",value:function(){var e=(0,l.Z)(p.mark((function e(t,r){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeForTopCount(t,(0,n.Z)((0,n.Z)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_createRequestQueryOptions",value:function(e){var t=(0,n.Z)((0,n.Z)({},this.layer.customParameters),{},{token:this.layer.apiKey},null==e?void 0:e.query);return this.layer.datesInUnknownTimezone&&(t.timeReferenceUnknownClient=!0),t}},{key:"_fetchService",value:function(){var e=(0,l.Z)(p.mark((function e(t,r){var n,a,u;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=6;break}return e.next=3,(0,h.default)(this.layer.parsedUrl.path,this._getLayerRequestOptions({query:(0,m.Z)("featurelayer-advanced-symbols")?{returnAdvancedSymbols:!0}:{},signal:r}));case 3:n=e.sent,a=n.data,t=a;case 6:if(this.sourceJSON=this._patchServiceJSON(t),u=t.type,Ne.has(u)){e.next=10;break}throw new v.Z("feature-layer-source:unsupported-type",'Source type "'.concat(u,'" is not supported'));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_patchServiceJSON",value:function(e){var t;if("Table"!==e.type&&e.geometryType&&(null==e||null==(t=e.drawingInfo)||!t.renderer)&&!e.defaultSymbol){var r=(0,_.bU)(e.geometryType).renderer;(0,x.RB)("drawingInfo.renderer",r,e)}return"esriGeometryMultiPatch"===e.geometryType&&e.infoFor3D&&(e.geometryType="mesh"),e}},{key:"_serializeFeature",value:function(e){var t=e.geometry,r=e.attributes;return(0,b.Wi)(t)?{attributes:r}:"mesh"===t.type||"extent"===t.type?null:{geometry:t.toJSON(),attributes:r}}},{key:"_serializeAttachment",value:function(){var e=(0,l.Z)(p.mark((function e(t){var r,n,a,u,s,i,o,c,l;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.feature,n=t.attachment,a=n.globalId,u=n.name,s=n.contentType,i=n.data,o=n.uploadId,c={globalId:a,parentGlobalId:null,contentType:null,name:null,uploadId:null,data:null},r&&(c.parentGlobalId="attributes"in r?r.attributes&&r.attributes[this.layer.globalIdField]:r.globalId),!o){e.next=5;break}c.uploadId=o,e.next=10;break;case 5:if(!i){e.next=10;break}return e.next=8,Ae(i);case 8:l=e.sent,c.contentType=l.mediaType,c.data=l.data,i instanceof File&&(c.name=i.name);case 10:return e.abrupt("return",(u&&(c.name=u),s&&(c.contentType=s),c));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getFeatureIds",value:function(e,t){var r=e[0];return r?this._canUseGlobalIds(t,e)?this._getGlobalIdsFromFeatureIdentifier(e):"objectId"in r?this._getObjectIdsFromFeatureIdentifier(e):this._getIdsFromFeatures(e):[]}},{key:"_getIdsFromFeatures",value:function(e){var t=this.layer.objectIdField;return e.map((function(e){return e.attributes&&e.attributes[t]}))}},{key:"_canUseGlobalIds",value:function(e,t){return e&&"globalId"in t[0]}},{key:"_getObjectIdsFromFeatureIdentifier",value:function(e){return e.map((function(e){return e.objectId}))}},{key:"_getGlobalIdsFromFeatureIdentifier",value:function(e){return e.map((function(e){return e.globalId}))}},{key:"_createEditsResult",value:function(e){var t,r=this,n=e.data,u=this.layer.layerId,s=[],i=null;if(Array.isArray(n)){var o,c=(0,a.Z)(n);try{for(c.s();!(o=c.n()).done;){var l=o.value;s.push({id:l.id,editedFeatures:l.editedFeatures}),l.id===u&&(i={addResults:l.addResults,updateResults:l.updateResults,deleteResults:l.deleteResults,attachments:l.attachments,editMoment:l.editMoment})}}catch(v){c.e(v)}finally{c.f()}}else i=n;var p=null==(t=i)?void 0:t.attachments,d={addFeatureResults:i.addResults?i.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:i.updateResults?i.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:i.deleteResults?i.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:p&&p.addResults?p.addResults.map(this._createFeatureEditResult,this):[],updateAttachmentResults:p&&p.updateResults?p.updateResults.map(this._createFeatureEditResult,this):[],deleteAttachmentResults:p&&p.deleteResults?p.deleteResults.map(this._createFeatureEditResult,this):[]};if(i.editMoment&&(d.editMoment=i.editMoment),s.length>0){d.editedFeatureResults=[];var f,h=(0,a.Z)(s);try{var y=function(){var e=f.value,t=e.editedFeatures,n=t.adds,a=t.updates,u=t.deletes,s=t.spatialReference,i=s?new Te.Z(s):null;d.editedFeatureResults.push({layerId:e.id,editedFeatures:{adds:(null==n?void 0:n.map((function(e){return r._createEditedFeature(e,i)})))||[],updates:(null==a?void 0:a.map((function(e){return{original:r._createEditedFeature(e[0],i),current:r._createEditedFeature(e[1],i)}})))||[],deletes:(null==u?void 0:u.map((function(e){return r._createEditedFeature(e,i)})))||[],spatialReference:i}})};for(h.s();!(f=h.n()).done;)y()}catch(v){h.e(v)}finally{h.f()}}return d}},{key:"_createEditedFeature",value:function(e,t){return new f.Z({attributes:e.attributes,geometry:(0,w.im)((0,n.Z)((0,n.Z)({},e.geometry),{},{spatialReference:t}))})}},{key:"_createFeatureEditResult",value:function(e){var t=!0===e.success?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new v.Z("feature-layer-source:edit-failure",t.description,{code:t.code}):null}}},{key:"_createAttachmentErrorResult",value:function(e,t){var r=t.details.messages&&t.details.messages[0]||t.message,n=t.details.httpStatus||t.details.messageCode;return{objectId:e,globalId:null,error:new v.Z("feature-layer-source:attachment-failure",r,{code:n})}}},{key:"_getFormDataForAttachment",value:function(e,t){var r=e instanceof FormData?e:e&&e.elements?new FormData(e):null;if(r)for(var n in t){var a=t[n];null!=a&&(r.set?r.set(n,a):r.append(n,a))}return r}},{key:"_getLayerRequestOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.layer,r=t.parsedUrl,a=t.gdbVersion,u=t.dynamicDataSource;return(0,n.Z)((0,n.Z)({},e),{},{query:(0,n.Z)((0,n.Z)({gdbVersion:a,layer:u?JSON.stringify({source:u}):void 0},r.query),{},{f:"json"},this._createRequestQueryOptions(e)),responseType:"json"})}}]),r}(Z.Z);(0,d._)([(0,R.Cb)()],Je.prototype,"type",void 0),(0,d._)([(0,R.Cb)({constructOnly:!0})],Je.prototype,"layer",void 0),(0,d._)([(0,R.Cb)({readOnly:!0})],Je.prototype,"queryTask",null);var Ge=Je=(0,d._)([(0,S.j)("esri.layers.graphics.sources.FeatureLayerSource")],Je)},63543:function(e,t,r){r.d(t,{Dm:function(){return d},Hq:function(){return f},MS:function(){return h},bU:function(){return c}});var n=r(4942),a=r(1413),u=r(93169),s=r(84652),i=r(60480),o=r(76115);function c(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?o.I4:"esriGeometryPolyline"===e?o.ET:o.lF}}}var l=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/,p=1;function d(e,t){if((0,u.Z)("esri-csp-restrictions"))return function(){return(0,a.Z)((0,n.Z)({},t,null),e)};try{var r="this.".concat(t," = null;");for(var s in e)r+="this".concat(l.test(s)?".".concat(s):'["'.concat(s,'"]')," = ").concat(JSON.stringify(e[s]),";");var i=new Function("\n      return class AttributesClass$".concat(p++," {\n        constructor() {\n          ").concat(r,";\n        }\n      }\n    "))();return function(){return new i}}catch(o){return function(){return(0,a.Z)((0,n.Z)({},t,null),e)}}}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:(0,s.d9)(e)}}]}function h(e,t){return{attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0},query:i.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0},editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}}},4338:function(e,t,r){r.d(t,{Z:function(){return h}});var n=r(1413),a=r(15671),u=r(43144),s=r(60136),i=r(29388),o=r(27366),c=r(85015),l=r(35995),p=r(49861),d=(r(63780),r(93169),r(25243),r(69912)),f=function(e){(0,s.Z)(r,e);var t=(0,i.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,u=new Array(n),s=0;s<n;s++)u[s]=arguments[s];return(e=t.call.apply(t,[this].concat(u))).requestOptions=null,e.url=null,e}return(0,u.Z)(r,[{key:"normalizeCtorArgs",value:function(e,t){return"string"!=typeof e?e:(0,n.Z)({url:e},t)}},{key:"parsedUrl",get:function(){return this._parseUrl(this.url)}},{key:"_parseUrl",value:function(e){return e?(0,l.mN)(e):null}},{key:"_encode",value:function(e,t,r){var n={};for(var a in e)if("declaredClass"!==a){var u=e[a];if(null!=u&&"function"!=typeof u)if(Array.isArray(u)){n[a]=[];for(var s=0;s<u.length;s++)n[a][s]=this._encode(u[s])}else if("object"==typeof u)if(u.toJSON){var i=u.toJSON(r&&r[a]);n[a]=t?i:JSON.stringify(i)}else n[a]=t?u:JSON.stringify(u);else n[a]=u}return n}}]),r}(c.Z);(0,o._)([(0,p.Cb)({readOnly:!0})],f.prototype,"parsedUrl",null),(0,o._)([(0,p.Cb)()],f.prototype,"requestOptions",void 0),(0,o._)([(0,p.Cb)({type:String})],f.prototype,"url",void 0);var h=f=(0,o._)([(0,d.j)("esri.tasks.Task")],f)}}]);
//# sourceMappingURL=9850.dde50d27.chunk.js.map