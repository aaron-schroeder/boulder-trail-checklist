"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[9474],{77178:function(e,t,r){r.d(t,{Z:function(){return h}});var n=r(37762),i=r(15671),l=r(43144),o=r(60136),a=r(29388),s=r(27366),u=r(81608),y=r(41691),f=r(92026),c=(r(10064),r(32718),r(26077),r(27088)),p=r(49861),v=(r(63780),r(93169),r(25243),r(69912)),d=function(e){(0,o.Z)(r,e);var t=(0,a.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).getCollections=null,n}return(0,l.Z)(r,[{key:"initialize",value:function(){var e=this;this.handles.add((0,c.EH)((function(){return e._refresh()})))}},{key:"destroy",value:function(){this.getCollections=null}},{key:"_refresh",value:function(){var e=(0,f.pC)(this.getCollections)?this.getCollections():null;if((0,f.Wi)(e))this.removeAll();else{var t,r=0,i=(0,n.Z)(e);try{for(i.s();!(t=i.n()).done;){var l=t.value;(0,f.pC)(l)&&(r=this._processCollection(r,l))}}catch(o){i.e(o)}finally{i.f()}this.splice(r,this.length)}}},{key:"_createNewInstance",value:function(e){return new u.Z(e)}},{key:"_processCollection",value:function(e,t){if(!t)return e;var r,i=this.itemFilterFunction?this.itemFilterFunction:function(e){return!!e},l=(0,n.Z)(t);try{for(l.s();!(r=l.n()).done;){var o=r.value;if(o){if(i(o)){var a=this.indexOf(o,e);a>=0?a!==e&&this.reorder(o,e):this.add(o,e),++e}if(this.getChildrenFunction){var s=this.getChildrenFunction(o);if(Array.isArray(s)){var u,y=(0,n.Z)(s);try{for(y.s();!(u=y.n()).done;){var f=u.value;e=this._processCollection(e,f)}}catch(c){y.e(c)}finally{y.f()}}else e=this._processCollection(e,s)}}}}catch(c){l.e(c)}finally{l.f()}return e}}]),r}((0,y.p)(u.Z));(0,s._)([(0,p.Cb)()],d.prototype,"getCollections",void 0),(0,s._)([(0,p.Cb)()],d.prototype,"getChildrenFunction",void 0),(0,s._)([(0,p.Cb)()],d.prototype,"itemFilterFunction",void 0);var h=d=(0,s._)([(0,v.j)("esri.core.CollectionFlattener")],d)},99474:function(e,t,r){r.r(t),r.d(t,{default:function(){return ie}});var n=r(37762),i=r(15861),l=r(42982),o=r(1413),a=r(15671),s=r(43144),u=r(11752),y=r(61120),f=r(60136),c=r(29388),p=r(87757),v=r(27366),d=(r(59486),r(81608)),h=r(77178),b=r(92026),g=r(97642),m=r(75298),_=r(35995),C=r(49861),k=(r(63780),r(93169),r(25243)),S=r(38511),Z=r(69912),w=r(31201),E=r(78952),x=r(74184),F=r(6693),G=r(6061),I=r(29598),O=r(71684),P=r(56811),L=r(45948),M=r(91505),j=r(46784),T=r(54472),N=r(94172),R=r(643),A=r(89125),z=r(42265),H=r(19545),K=(r(46523),r(76200)),J=r(84652),W=r(41414),Y=r(376),U=(r(9014),r(49818),{esriGeometryPoint:"points",esriGeometryPolyline:"polylines",esriGeometryPolygon:"polygons"});function q(e){var t=e.folders||[],r=t.slice(),i=new Map,l=new Map,o=new Map,a=new Map,s=new Map,u={esriGeometryPoint:l,esriGeometryPolyline:o,esriGeometryPolygon:a};(e.featureCollection&&e.featureCollection.layers||[]).forEach((function(e){var t=(0,J.d9)(e);t.featureSet.features=[];var r=e.featureSet.geometryType;i.set(r,t);var n=e.layerDefinition.objectIdField;"esriGeometryPoint"===r?D(l,n,e.featureSet.features):"esriGeometryPolyline"===r?D(o,n,e.featureSet.features):"esriGeometryPolygon"===r&&D(a,n,e.featureSet.features)})),e.groundOverlays&&e.groundOverlays.forEach((function(e){s.set(e.id,e)})),t.forEach((function(t){t.networkLinkIds.forEach((function(n){var i=function(e,t,r){var n=function(e,t){var r;return t.some((function(t){return t.id===e&&(r=t,!0)})),r}(e,r);return n&&(n.parentFolderId=t,n.networkLink=n),n}(n,t.id,e.networkLinks);i&&r.push(i)}))})),r.forEach((function(e){if(e.featureInfos){e.points=(0,J.d9)(i.get("esriGeometryPoint")),e.polylines=(0,J.d9)(i.get("esriGeometryPolyline")),e.polygons=(0,J.d9)(i.get("esriGeometryPolygon")),e.mapImages=[];var t,r=(0,n.Z)(e.featureInfos);try{for(r.s();!(t=r.n()).done;){var l=t.value;switch(l.type){case"esriGeometryPoint":case"esriGeometryPolyline":case"esriGeometryPolygon":var o=u[l.type].get(l.id);o&&e[U[l.type]].featureSet.features.push(o);break;case"GroundOverlay":var a=s.get(l.id);a&&e.mapImages.push(a)}}}catch(y){r.e(y)}finally{r.f()}e.fullExtent=B([e])}}));var y=B(r);return{folders:t,sublayers:r,extent:y}}function Q(e,t,r,n){var i=H.id&&H.id.findCredential(e);e=(0,_.fl)(e,{token:i&&i.token});var l=z.Z.kmlServiceUrl;return(0,K.default)(l,{query:{url:e,model:"simple",folders:"",refresh:0!==r||void 0,outSR:JSON.stringify(t)},responseType:"json",signal:n})}function V(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=[],l={},o=t.sublayers,a=t.folders.map((function(e){return e.id}));return o.forEach((function(t){var o=new e;if(r?o.read(t,r):o.read(t),n.length&&a.indexOf(o.id)>-1&&(o.visible=-1!==n.indexOf(o.id)),l[t.id]=o,null!=t.parentFolderId&&-1!==t.parentFolderId){var s=l[t.parentFolderId];s.sublayers||(s.sublayers=[]),s.sublayers.unshift(o)}else i.unshift(o)})),i}function D(e,t,r){r.forEach((function(r){e.set(r.attributes[t],r)}))}function B(e){var t,r=(0,W.Ue)(W.Gv),i=(0,W.Ue)(W.Gv),l=(0,n.Z)(e);try{for(l.s();!(t=l.n()).done;){var o=t.value;if(o.polygons&&o.polygons.featureSet&&o.polygons.featureSet.features){var a,s=(0,n.Z)(o.polygons.featureSet.features);try{for(s.s();!(a=s.n()).done;){var u=a.value;(0,Y.Yg)(r,u.geometry),(0,W.TC)(i,r)}}catch(m){s.e(m)}finally{s.f()}}if(o.polylines&&o.polylines.featureSet&&o.polylines.featureSet.features){var y,f=(0,n.Z)(o.polylines.featureSet.features);try{for(f.s();!(y=f.n()).done;){var c=y.value;(0,Y.Yg)(r,c.geometry),(0,W.TC)(i,r)}}catch(m){f.e(m)}finally{f.f()}}if(o.points&&o.points.featureSet&&o.points.featureSet.features){var p,v=(0,n.Z)(o.points.featureSet.features);try{for(v.s();!(p=v.n()).done;){var d=p.value;(0,Y.Yg)(r,d.geometry),(0,W.TC)(i,r)}}catch(m){v.e(m)}finally{v.f()}}if(o.mapImages){var h,b=(0,n.Z)(o.mapImages);try{for(b.s();!(h=b.n()).done;){var g=h.value;(0,Y.Yg)(r,g.extent),(0,W.TC)(i,r)}}catch(m){b.e(m)}finally{b.f()}}}}catch(m){l.e(m)}finally{l.f()}return(0,W.fS)(i,W.Gv)?null:{xmin:i[0],ymin:i[1],zmin:i[2],xmax:i[3],ymax:i[4],zmax:i[5],spatialReference:E.Z.WGS84}}var X,$=r(53866),ee=X=function(e){(0,f.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.apply(this,arguments))._sublayersHandles=null,e.description=null,e.id=null,e.networkLink=null,e.title=null,e.sourceJSON=null,e.fullExtent=null,e}return(0,s.Z)(r,[{key:"initialize",value:function(){var e=this;(0,N.N1)((function(){return e.networkLink})).then((function(){return(0,N.N1)((function(){return!0===e.visible}))})).then((function(){return e.load()}))}},{key:"load",value:function(e){var t=this;if(this.networkLink&&!this.networkLink.viewFormat){var r=(0,b.pC)(e)?e.signal:null,n=this._fetchService(this._get("networkLink").href,r).then((function(e){var r=B(e.sublayers);t.fullExtent=$.Z.fromJSON(r),t.sourceJSON=e;var n=(0,k.se)(d.Z.ofType(X),V(X,e));t.sublayers?t.sublayers.addMany(n):t.sublayers=n,t.layer.emit("sublayer-update"),t.layer&&t.layer.notifyChange("visibleSublayers")}));return this.addResolvingPromise(n),Promise.resolve(this)}}},{key:"sublayers",set:function(e){var t=this,r=this._get("sublayers");r&&(r.forEach((function(e){e.parent=null,e.layer=null})),this._sublayersHandles.forEach((function(e){return e.remove()})),this._sublayersHandles=null),e&&(e.forEach((function(e){e.parent=t,e.layer=t.layer})),this._sublayersHandles=[e.on("after-add",(function(e){var r=e.item;r.parent=t,r.layer=t.layer})),e.on("after-remove",(function(e){var t=e.item;t.parent=null,t.layer=null}))]),this._set("sublayers",e)}},{key:"castSublayers",value:function(e){return(0,k.se)(d.Z.ofType(X),e)}},{key:"visible",get:function(){return this._get("visible")},set:function(e){this._get("visible")!==e&&(this._set("visible",e),this.layer&&this.layer.notifyChange("visibleSublayers"))}},{key:"readVisible",value:function(e,t){return!!t.visibility}},{key:"layer",set:function(e){this._set("layer",e),this.sublayers&&this.sublayers.forEach((function(t){return t.layer=e}))}},{key:"_fetchService",value:function(e,t){return Q(e,this.layer.outSpatialReference,this.layer.refreshInterval,t).then((function(e){return q(e.data)}))}}]),r}(M.Z.EventedMixin((0,j.eC)(T.Z)));(0,v._)([(0,C.Cb)()],ee.prototype,"description",void 0),(0,v._)([(0,C.Cb)()],ee.prototype,"id",void 0),(0,v._)([(0,C.Cb)({readOnly:!0,value:null})],ee.prototype,"networkLink",void 0),(0,v._)([(0,C.Cb)({json:{write:{allowNull:!0}}})],ee.prototype,"parent",void 0),(0,v._)([(0,C.Cb)({value:null,json:{write:{allowNull:!0}}})],ee.prototype,"sublayers",null),(0,v._)([(0,A.p)("sublayers")],ee.prototype,"castSublayers",null),(0,v._)([(0,C.Cb)({value:null,json:{read:{source:"name",reader:function(e){return(0,R.Cb)(e)}}}})],ee.prototype,"title",void 0),(0,v._)([(0,C.Cb)({value:!0})],ee.prototype,"visible",null),(0,v._)([(0,S.r)("visible",["visibility"])],ee.prototype,"readVisible",null),(0,v._)([(0,C.Cb)()],ee.prototype,"sourceJSON",void 0),(0,v._)([(0,C.Cb)({value:null})],ee.prototype,"layer",null),(0,v._)([(0,C.Cb)({type:$.Z})],ee.prototype,"fullExtent",void 0);var te=ee=X=(0,v._)([(0,Z.j)("esri.layers.support.KMLSublayer")],ee),re=["kml","xml"],ne=function(e){(0,f.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return(e=t.call.apply(t,[this].concat(i)))._visibleFolders=[],e.allSublayers=new h.Z({getCollections:function(){return[e.sublayers]},getChildrenFunction:function(e){return e.sublayers}}),e.outSpatialReference=E.Z.WGS84,e.path=null,e.legendEnabled=!1,e.operationalLayerType="KML",e.sublayers=null,e.type="kml",e.url=null,e}return(0,s.Z)(r,[{key:"initialize",value:function(){var e=this;this.watch("sublayers",(function(t,r){r&&r.forEach((function(e){e.parent=null,e.layer=null})),t&&t.forEach((function(t){t.parent=e,t.layer=e}))}),!0),this.on("sublayer-update",(function(){return e.notifyChange("fullExtent")}))}},{key:"normalizeCtorArgs",value:function(e,t){return"string"==typeof e?(0,o.Z)({url:e},t):e}},{key:"readSublayersFromItemOrWebMap",value:function(e,t){this._visibleFolders=t.visibleFolders}},{key:"readSublayers",value:function(e,t,r){return V(te,t,r,this._visibleFolders)}},{key:"writeSublayers",value:function(e,t){for(var r=[],n=e.toArray();n.length;){var i=n[0];i.networkLink||(i.visible&&r.push(i.id),i.sublayers&&n.push.apply(n,(0,l.Z)(i.sublayers.toArray()))),n.shift()}t.visibleFolders=r}},{key:"title",get:function(){var e=this._get("title");return e&&"defaults"!==this.originOf("title")?e:this.url?(0,_.vt)(this.url,re)||"KML":e||""},set:function(e){this._set("title",e)}},{key:"visibleSublayers",get:function(){var e=this.sublayers,t=[];return e&&e.forEach((function e(r){r.visible&&(t.push(r),r.sublayers&&r.sublayers.forEach(e))})),t}},{key:"fullExtent",get:function(){return this._recomputeFullExtent()}},{key:"load",value:function(e){var t=this,r=(0,b.pC)(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["KML"]},e).catch(m.r9).then((function(){return t._fetchService(r)}))),Promise.resolve(this)}},{key:"destroy",value:function(){(0,u.Z)((0,y.Z)(r.prototype),"destroy",this).call(this),this.allSublayers.destroy()}},{key:"_fetchService",value:function(){var e=(0,i.Z)(p.mark((function e(t){var r,n,i=this;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then((function(){return i.resourceInfo?{ssl:!1,data:i.resourceInfo}:Q(i.url,i.outSpatialReference,i.refreshInterval,t)}));case 2:r=e.sent,(n=q(r.data))&&this.read(n,{origin:"service"});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_recomputeFullExtent",value:function(){var e=null;(0,b.pC)(this.extent)&&(e=this.extent.clone());return function t(r){if(r.sublayers){var i,l=(0,n.Z)(r.sublayers.items);try{for(l.s();!(i=l.n()).done;){var o=i.value;t(o),o.visible&&o.fullExtent&&((0,b.pC)(e)?e.union(o.fullExtent):e=o.fullExtent.clone())}}catch(a){l.e(a)}finally{l.f()}}}(this),e}}]),r}((0,F.h)((0,O.Q)((0,P.M)((0,G.q)((0,I.I)((0,g.R)(x.Z)))))));(0,v._)([(0,C.Cb)({readOnly:!0})],ne.prototype,"allSublayers",void 0),(0,v._)([(0,C.Cb)({type:E.Z})],ne.prototype,"outSpatialReference",void 0),(0,v._)([(0,C.Cb)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],ne.prototype,"path",void 0),(0,v._)([(0,C.Cb)({readOnly:!0,json:{read:!1,write:!1}})],ne.prototype,"legendEnabled",void 0),(0,v._)([(0,C.Cb)({type:["show","hide","hide-children"]})],ne.prototype,"listMode",void 0),(0,v._)([(0,C.Cb)({type:["KML"]})],ne.prototype,"operationalLayerType",void 0),(0,v._)([(0,C.Cb)({})],ne.prototype,"resourceInfo",void 0),(0,v._)([(0,C.Cb)({type:d.Z.ofType(te),json:{write:{ignoreOrigin:!0}}})],ne.prototype,"sublayers",void 0),(0,v._)([(0,S.r)(["web-map","portal-item"],"sublayers",["visibleFolders"])],ne.prototype,"readSublayersFromItemOrWebMap",null),(0,v._)([(0,S.r)("service","sublayers",["sublayers"])],ne.prototype,"readSublayers",null),(0,v._)([(0,w.c)("sublayers")],ne.prototype,"writeSublayers",null),(0,v._)([(0,C.Cb)({readOnly:!0,json:{read:!1}})],ne.prototype,"type",void 0),(0,v._)([(0,C.Cb)({json:{origins:{"web-map":{read:{source:"title"}}},write:{ignoreOrigin:!0}}})],ne.prototype,"title",null),(0,v._)([(0,C.Cb)(L.HQ)],ne.prototype,"url",void 0),(0,v._)([(0,C.Cb)({readOnly:!0})],ne.prototype,"visibleSublayers",null),(0,v._)([(0,C.Cb)({type:$.Z})],ne.prototype,"extent",void 0),(0,v._)([(0,C.Cb)()],ne.prototype,"fullExtent",null);var ie=ne=(0,v._)([(0,Z.j)("esri.layers.KMLLayer")],ne)}}]);
//# sourceMappingURL=9474.cdaf2df5.chunk.js.map